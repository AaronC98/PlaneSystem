<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>5. GNAT Utility Programs &#8212; GNAT User&#39;s Guide for Native Platforms 2019 documentation</title>
    
    <link rel="stylesheet" href="../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2019',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="6. GNAT and Program Execution" href="gnat_and_program_execution.html" />
    <link rel="prev" title="4. Building Executable Programs with GNAT" href="building_executable_programs_with_gnat.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="gnat_and_program_execution.html" title="6. GNAT and Program Execution"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="building_executable_programs_with_gnat.html" title="4. Building Executable Programs with GNAT"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../gnat_ugn.html">GNAT User&#39;s Guide for Native Platforms 2019 documentation</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../gnat_ugn.html">
              <img class="logo" src="../_static/adacore_transparent.png" alt="Logo"/>
            </a></p>
  <h3><a href="../gnat_ugn.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">5. GNAT Utility Programs</a><ul>
<li><a class="reference internal" href="#the-file-cleanup-utility-gnatclean">5.1. The File Cleanup Utility <code class="docutils literal"><span class="pre">gnatclean</span></code></a><ul>
<li><a class="reference internal" href="#running-gnatclean">5.1.1. Running <code class="docutils literal"><span class="pre">gnatclean</span></code></a></li>
<li><a class="reference internal" href="#switches-for-gnatclean">5.1.2. Switches for <code class="docutils literal"><span class="pre">gnatclean</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-gnat-library-browser-gnatls">5.2. The GNAT Library Browser <code class="docutils literal"><span class="pre">gnatls</span></code></a><ul>
<li><a class="reference internal" href="#running-gnatls">5.2.1. Running <code class="docutils literal"><span class="pre">gnatls</span></code></a></li>
<li><a class="reference internal" href="#switches-for-gnatls">5.2.2. Switches for <code class="docutils literal"><span class="pre">gnatls</span></code></a></li>
<li><a class="reference internal" href="#example-of-gnatls-usage">5.2.3. Example of <code class="docutils literal"><span class="pre">gnatls</span></code> Usage</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-cross-referencing-tools-gnatxref-and-gnatfind">5.3. The Cross-Referencing Tools <code class="docutils literal"><span class="pre">gnatxref</span></code> and <code class="docutils literal"><span class="pre">gnatfind</span></code></a><ul>
<li><a class="reference internal" href="#gnatxref-switches">5.3.1. <code class="docutils literal"><span class="pre">gnatxref</span></code> Switches</a></li>
<li><a class="reference internal" href="#gnatfind-switches">5.3.2. <code class="docutils literal"><span class="pre">gnatfind</span></code> Switches</a></li>
<li><a class="reference internal" href="#configuration-files-for-gnatxref-and-gnatfind">5.3.3. Configuration Files for <code class="docutils literal"><span class="pre">gnatxref</span></code> and <code class="docutils literal"><span class="pre">gnatfind</span></code></a></li>
<li><a class="reference internal" href="#regular-expressions-in-gnatfind-and-gnatxref">5.3.4. Regular Expressions in <code class="docutils literal"><span class="pre">gnatfind</span></code> and <code class="docutils literal"><span class="pre">gnatxref</span></code></a></li>
<li><a class="reference internal" href="#examples-of-gnatxref-usage">5.3.5. Examples of <code class="docutils literal"><span class="pre">gnatxref</span></code> Usage</a><ul>
<li><a class="reference internal" href="#general-usage">5.3.5.1. General Usage</a></li>
<li><a class="reference internal" href="#using-gnatxref-with-vi">5.3.5.2. Using <code class="docutils literal"><span class="pre">gnatxref</span></code> with <code class="docutils literal"><span class="pre">vi</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#examples-of-gnatfind-usage">5.3.6. Examples of <code class="docutils literal"><span class="pre">gnatfind</span></code> Usage</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-ada-to-html-converter-gnathtml">5.4. The Ada to HTML Converter <code class="docutils literal"><span class="pre">gnathtml</span></code></a><ul>
<li><a class="reference internal" href="#invoking-gnathtml">5.4.1. Invoking <code class="docutils literal"><span class="pre">gnathtml</span></code></a></li>
<li><a class="reference internal" href="#installing-gnathtml">5.4.2. Installing <code class="docutils literal"><span class="pre">gnathtml</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-ada-to-xml-converter-gnat2xml">5.5. The Ada-to-XML converter <code class="docutils literal"><span class="pre">gnat2xml</span></code></a><ul>
<li><a class="reference internal" href="#switches-for-gnat2xml">5.5.1. Switches for <code class="docutils literal"><span class="pre">gnat2xml</span></code></a></li>
<li><a class="reference internal" href="#other-programs">5.5.2. Other Programs</a></li>
<li><a class="reference internal" href="#structure-of-the-xml">5.5.3. Structure of the XML</a></li>
<li><a class="reference internal" href="#generating-representation-clauses">5.5.4. Generating Representation Clauses</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-coding-standard-verifier-gnatcheck">5.6. The Coding Standard Verifier <code class="docutils literal"><span class="pre">gnatcheck</span></code></a></li>
<li><a class="reference internal" href="#the-gnat-metrics-tool-gnatmetric">5.7. The GNAT Metrics Tool <code class="docutils literal"><span class="pre">gnatmetric</span></code></a><ul>
<li><a class="reference internal" href="#output-file-control">5.7.1. Output File Control</a></li>
<li><a class="reference internal" href="#disable-metrics-for-local-units">5.7.2. Disable Metrics For Local Units</a></li>
<li><a class="reference internal" href="#specifying-a-set-of-metrics-to-compute">5.7.3. Specifying a set of metrics to compute</a><ul>
<li><a class="reference internal" href="#line-metrics-control">5.7.3.1. Line Metrics Control</a></li>
<li><a class="reference internal" href="#syntax-metrics-control">5.7.3.2. Syntax Metrics Control</a></li>
<li><a class="reference internal" href="#complexity-metrics-control">5.7.3.3. Complexity Metrics Control</a></li>
<li><a class="reference internal" href="#coupling-metrics-control">5.7.3.4. Coupling Metrics Control</a></li>
</ul>
</li>
<li><a class="reference internal" href="#other-gnatmetric-switches">5.7.4. Other <code class="docutils literal"><span class="pre">gnatmetric</span></code> Switches</a><ul>
<li><a class="reference internal" href="#legacy-switches">5.7.4.1. Legacy Switches</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#the-gnat-pretty-printer-gnatpp">5.8. The GNAT Pretty Printer <code class="docutils literal"><span class="pre">gnatpp</span></code></a><ul>
<li><a class="reference internal" href="#switches-for-gnatpp">5.8.1. Switches for <code class="docutils literal"><span class="pre">gnatpp</span></code></a><ul>
<li><a class="reference internal" href="#alignment-control">5.8.1.1. Alignment Control</a></li>
<li><a class="reference internal" href="#casing-control">5.8.1.2. Casing Control</a></li>
<li><a class="reference internal" href="#general-text-layout-control">5.8.1.3. General Text Layout Control</a></li>
<li><a class="reference internal" href="#other-formatting-options">5.8.1.4. Other Formatting Options</a></li>
<li><a class="reference internal" href="#setting-the-source-search-path">5.8.1.5. Setting the Source Search Path</a></li>
<li><a class="reference internal" href="#output-file-control-gnatpp">5.8.1.6. Output File Control</a></li>
<li><a class="reference internal" href="#other-gnatpp-switches">5.8.1.7. Other <code class="docutils literal"><span class="pre">gnatpp</span></code> Switches</a></li>
</ul>
</li>
<li><a class="reference internal" href="#formatting-rules">5.8.2. Formatting Rules</a><ul>
<li><a class="reference internal" href="#disabling-pretty-printing">5.8.2.1. Disabling Pretty Printing</a></li>
<li><a class="reference internal" href="#white-space-and-empty-lines">5.8.2.2. White Space and Empty Lines</a></li>
<li><a class="reference internal" href="#formatting-comments">5.8.2.3. Formatting Comments</a></li>
<li><a class="reference internal" href="#name-casing">5.8.2.4. Name Casing</a></li>
<li><a class="reference internal" href="#preprocessor-directives">5.8.2.5. Preprocessor Directives</a></li>
<li><a class="reference internal" href="#id48">5.8.2.6. Legacy Switches</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#the-body-stub-generator-gnatstub">5.9. The Body Stub Generator <em>gnatstub</em></a><ul>
<li><a class="reference internal" href="#running-gnatstub">5.9.1. Running <code class="docutils literal"><span class="pre">gnatstub</span></code></a></li>
<li><a class="reference internal" href="#switches-for-gnatstub">5.9.2. Switches for <code class="docutils literal"><span class="pre">gnatstub</span></code></a><ul>
<li><a class="reference internal" href="#id52">5.9.2.1. Legacy Switches</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#the-unit-test-generator-gnattest">5.10. The Unit Test Generator <code class="docutils literal"><span class="pre">gnattest</span></code></a><ul>
<li><a class="reference internal" href="#running-gnattest">5.10.1. Running <code class="docutils literal"><span class="pre">gnattest</span></code></a><ul>
<li><a class="reference internal" href="#framework-generation-mode">5.10.1.1. Framework Generation Mode</a></li>
<li><a class="reference internal" href="#test-execution-mode">5.10.1.2. Test Execution Mode</a></li>
</ul>
</li>
<li><a class="reference internal" href="#switches-for-gnattest-in-framework-generation-mode">5.10.2. Switches for <code class="docutils literal"><span class="pre">gnattest</span></code> in framework generation mode</a></li>
<li><a class="reference internal" href="#switches-for-gnattest-in-test-execution-mode">5.10.3. Switches for <code class="docutils literal"><span class="pre">gnattest</span></code> in test execution mode</a></li>
<li><a class="reference internal" href="#project-attributes-for-gnattest">5.10.4. Project Attributes for <code class="docutils literal"><span class="pre">gnattest</span></code></a></li>
<li><a class="reference internal" href="#simple-example">5.10.5. Simple Example</a></li>
<li><a class="reference internal" href="#setting-up-and-tearing-down-the-testing-environment">5.10.6. Setting Up and Tearing Down the Testing Environment</a></li>
<li><a class="reference internal" href="#regenerating-tests">5.10.7. Regenerating Tests</a></li>
<li><a class="reference internal" href="#default-test-behavior">5.10.8. Default Test Behavior</a></li>
<li><a class="reference internal" href="#testing-primitive-operations-of-tagged-types">5.10.9. Testing Primitive Operations of Tagged Types</a></li>
<li><a class="reference internal" href="#testing-inheritance">5.10.10. Testing Inheritance</a></li>
<li><a class="reference internal" href="#tagged-type-substitutability-testing">5.10.11. Tagged Type Substitutability Testing</a></li>
<li><a class="reference internal" href="#testing-with-contracts">5.10.12. Testing with Contracts</a></li>
<li><a class="reference internal" href="#additional-tests">5.10.13. Additional Tests</a></li>
<li><a class="reference internal" href="#individual-test-drivers">5.10.14. Individual Test Drivers</a></li>
<li><a class="reference internal" href="#stubbing">5.10.15. Stubbing</a></li>
<li><a class="reference internal" href="#integration-with-gnatcoverage">5.10.16. Integration with GNATcoverage</a></li>
<li><a class="reference internal" href="#putting-tests-under-version-control">5.10.17. Putting Tests under Version Control</a></li>
<li><a class="reference internal" href="#current-limitations">5.10.18. Current Limitations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#translating-code-addresses-into-source-locations-with-gnatsymbolize">5.11. Translating Code Addresses into Source Locations with <code class="docutils literal"><span class="pre">gnatsymbolize</span></code></a><ul>
<li><a class="reference internal" href="#running-gnatsymbolize">5.11.1. Running <code class="docutils literal"><span class="pre">gnatsymbolize</span></code></a></li>
<li><a class="reference internal" href="#switches-for-gnatsymbolize">5.11.2. Switches for <code class="docutils literal"><span class="pre">gnatsymbolize</span></code></a></li>
<li><a class="reference internal" href="#requirements-for-correct-operation">5.11.3. Requirements for Correct Operation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#using-project-files-with-gnat-tools">5.12. Using Project Files with GNAT Tools</a><ul>
<li><a class="reference internal" href="#switches-related-to-project-files">5.12.1. Switches Related to Project Files</a></li>
<li><a class="reference internal" href="#tool-specific-packages-in-project-files">5.12.2. Tool-specific packages in project files</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="building_executable_programs_with_gnat.html"
                        title="previous chapter">4. Building Executable Programs with GNAT</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="gnat_and_program_execution.html"
                        title="next chapter">6. GNAT and Program Execution</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/gnat_ugn/gnat_utility_programs.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="gnat-utility-programs">
<span id="id1"></span><h1>5. GNAT Utility Programs<a class="headerlink" href="#gnat-utility-programs" title="Permalink to this headline">¶</a></h1>
<p>This chapter describes a number of utility programs:</p>
<ul class="simple">
<li><a class="reference internal" href="#the-file-cleanup-utility-gnatclean"><span class="std std-ref">The File Cleanup Utility gnatclean</span></a></li>
<li><a class="reference internal" href="#the-gnat-library-browser-gnatls"><span class="std std-ref">The GNAT Library Browser gnatls</span></a></li>
<li><a class="reference internal" href="#the-cross-referencing-tools-gnatxref-and-gnatfind"><span class="std std-ref">The Cross-Referencing Tools gnatxref and gnatfind</span></a></li>
<li><a class="reference internal" href="#the-ada-to-html-converter-gnathtml"><span class="std std-ref">The Ada to HTML Converter gnathtml</span></a></li>
<li><a class="reference internal" href="#the-ada-to-xml-converter-gnat2xml"><span class="std std-ref">The Ada-to-XML converter gnat2xml</span></a></li>
<li><a class="reference internal" href="#the-coding-standard-verifier-gnatcheck"><span class="std std-ref">The Coding Standard Verifier gnatcheck</span></a></li>
<li><a class="reference internal" href="#the-gnat-metrics-tool-gnatmetric"><span class="std std-ref">The GNAT Metrics Tool gnatmetric</span></a></li>
<li><a class="reference internal" href="#the-gnat-pretty-printer-gnatpp"><span class="std std-ref">The GNAT Pretty Printer gnatpp</span></a></li>
<li><a class="reference internal" href="#the-body-stub-generator-gnatstub"><span class="std std-ref">The Body Stub Generator gnatstub</span></a></li>
<li><a class="reference internal" href="#the-unit-test-generator-gnattest"><span class="std std-ref">The Unit Test Generator gnattest</span></a></li>
<li><a class="reference internal" href="#the-backtrace-symbolizer-gnatsymbolize"><span class="std std-ref">Translating Code Addresses into Source Locations with gnatsymbolize</span></a></li>
</ul>
<p>It also describes how several of these tools can be used in conjunction
with project files: <a class="reference internal" href="#using-project-files-with-gnat-tools"><span class="std std-ref">Using Project Files with GNAT Tools</span></a></p>
<p>Other GNAT utilities are described elsewhere in this manual:</p>
<ul class="simple">
<li><a class="reference internal" href="the_gnat_compilation_model.html#handling-arbitrary-file-naming-conventions-with-gnatname"><span class="std std-ref">Handling Arbitrary File Naming Conventions with gnatname</span></a></li>
<li><a class="reference internal" href="the_gnat_compilation_model.html#file-name-krunching-with-gnatkr"><span class="std std-ref">File Name Krunching with gnatkr</span></a></li>
<li><a class="reference internal" href="the_gnat_compilation_model.html#renaming-files-with-gnatchop"><span class="std std-ref">Renaming Files with gnatchop</span></a></li>
<li><a class="reference internal" href="the_gnat_compilation_model.html#preprocessing-with-gnatprep"><span class="std std-ref">Preprocessing with gnatprep</span></a></li>
</ul>
<div class="section" id="the-file-cleanup-utility-gnatclean">
<span id="id2"></span><h2>5.1. The File Cleanup Utility <code class="docutils literal"><span class="pre">gnatclean</span></code><a class="headerlink" href="#the-file-cleanup-utility-gnatclean" title="Permalink to this headline">¶</a></h2>
<span class="target" id="index-0"></span><p id="index-1"><code class="docutils literal"><span class="pre">gnatclean</span></code> is a tool that allows the deletion of files produced by the
compiler, binder and linker, including ALI files, object files, tree files,
expanded source files, library files, interface copy source files, binder
generated files and executable files.</p>
<div class="section" id="running-gnatclean">
<span id="id3"></span><h3>5.1.1. Running <code class="docutils literal"><span class="pre">gnatclean</span></code><a class="headerlink" href="#running-gnatclean" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">gnatclean</span></code> command has the form:</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span>$ gnatclean switches names
</pre></div>
</div>
</div></blockquote>
<p>where <code class="docutils literal"><span class="pre">names</span></code> is a list of source file names. Suffixes <code class="file docutils literal"><span class="pre">.ads</span></code> and
<code class="file docutils literal"><span class="pre">adb</span></code> may be omitted. If a project file is specified using switch
<code class="switch docutils literal"><span class="pre">-P</span></code>, then <code class="docutils literal"><span class="pre">names</span></code> may be completely omitted.</p>
<p>In normal mode, <code class="docutils literal"><span class="pre">gnatclean</span></code> delete the files produced by the compiler and,
if switch <code class="switch docutils literal"><span class="pre">-c</span></code> is not specified, by the binder and
the linker. In informative-only mode, specified by switch
<code class="switch docutils literal"><span class="pre">-n</span></code>, the list of files that would have been deleted in
normal mode is listed, but no file is actually deleted.</p>
</div>
<div class="section" id="switches-for-gnatclean">
<span id="id4"></span><h3>5.1.2. Switches for <code class="docutils literal"><span class="pre">gnatclean</span></code><a class="headerlink" href="#switches-for-gnatclean" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal"><span class="pre">gnatclean</span></code> recognizes the following switches:</p>
<dl class="docutils" id="index-2">
<dt><code class="switch docutils literal"><span class="pre">--version</span></code></dt>
<dd>Display copyright and version, then exit disregarding all other options.</dd>
</dl>
<dl class="docutils" id="index-3">
<dt><code class="switch docutils literal"><span class="pre">--help</span></code></dt>
<dd>If <code class="switch docutils literal"><span class="pre">--version</span></code> was not used, display usage, then exit disregarding
all other options.</dd>
<dt><code class="switch docutils literal"><span class="pre">--subdirs=</span><em><span class="pre">subdir</span></em></code></dt>
<dd>Actual object directory of each project file is the subdirectory subdir of the
object directory specified or defaulted in the project file.</dd>
<dt><code class="switch docutils literal"><span class="pre">--unchecked-shared-lib-imports</span></code></dt>
<dd>By default, shared library projects are not allowed to import static library
projects. When this switch is used on the command line, this restriction is
relaxed.</dd>
</dl>
<dl class="docutils" id="index-4">
<dt><code class="switch docutils literal"><span class="pre">-c</span></code></dt>
<dd>Only attempt to delete the files produced by the compiler, not those produced
by the binder or the linker. The files that are not to be deleted are library
files, interface copy files, binder generated files and executable files.</dd>
</dl>
<dl class="docutils" id="index-5">
<dt><code class="switch docutils literal"><span class="pre">-D</span> <em><span class="pre">dir</span></em></code></dt>
<dd>Indicate that ALI and object files should normally be found in directory <code class="docutils literal"><span class="pre">dir</span></code>.</dd>
</dl>
<dl class="docutils" id="index-6">
<dt><code class="switch docutils literal"><span class="pre">-F</span></code></dt>
<dd>When using project files, if some errors or warnings are detected during
parsing and verbose mode is not in effect (no use of switch
-v), then error lines start with the full path name of the project
file, rather than its simple file name.</dd>
</dl>
<dl class="docutils" id="index-7">
<dt><code class="switch docutils literal"><span class="pre">-h</span></code></dt>
<dd>Output a message explaining the usage of <code class="docutils literal"><span class="pre">gnatclean</span></code>.</dd>
</dl>
<dl class="docutils" id="index-8">
<dt><code class="switch docutils literal"><span class="pre">-n</span></code></dt>
<dd>Informative-only mode. Do not delete any files. Output the list of the files
that would have been deleted if this switch was not specified.</dd>
</dl>
<dl class="docutils" id="index-9">
<dt><code class="switch docutils literal"><span class="pre">-P</span><em><span class="pre">project</span></em></code></dt>
<dd>Use project file <code class="docutils literal"><span class="pre">project</span></code>. Only one such switch can be used.
When cleaning a project file, the files produced by the compilation of the
immediate sources or inherited sources of the project files are to be
deleted. This is not depending on the presence or not of executable names
on the command line.</dd>
</dl>
<dl class="docutils" id="index-10">
<dt><code class="switch docutils literal"><span class="pre">-q</span></code></dt>
<dd>Quiet output. If there are no errors, do not output anything, except in
verbose mode (switch -v) or in informative-only mode
(switch -n).</dd>
</dl>
<dl class="docutils" id="index-11">
<dt><code class="switch docutils literal"><span class="pre">-r</span></code></dt>
<dd>When a project file is specified (using switch -P),
clean all imported and extended project files, recursively. If this switch
is not specified, only the files related to the main project file are to be
deleted. This switch has no effect if no project file is specified.</dd>
</dl>
<dl class="docutils" id="index-12">
<dt><code class="switch docutils literal"><span class="pre">-v</span></code></dt>
<dd>Verbose mode.</dd>
</dl>
<dl class="docutils" id="index-13">
<dt><code class="switch docutils literal"><span class="pre">-vP</span><em><span class="pre">x</span></em></code></dt>
<dd>Indicates the verbosity of the parsing of GNAT project files.
<a class="reference internal" href="#switches-related-to-project-files"><span class="std std-ref">Switches Related to Project Files</span></a>.</dd>
</dl>
<dl class="docutils" id="index-14">
<dt><code class="switch docutils literal"><span class="pre">-X</span><em><span class="pre">name</span></em><span class="pre">=</span><em><span class="pre">value</span></em></code></dt>
<dd>Indicates that external variable <code class="docutils literal"><span class="pre">name</span></code> has the value <code class="docutils literal"><span class="pre">value</span></code>.
The Project Manager will use this value for occurrences of
<code class="docutils literal"><span class="pre">external(name)</span></code> when parsing the project file.
See <a class="reference internal" href="#switches-related-to-project-files"><span class="std std-ref">Switches Related to Project Files</span></a>.</dd>
</dl>
<dl class="docutils" id="index-15">
<dt><code class="switch docutils literal"><span class="pre">-aO</span><em><span class="pre">dir</span></em></code></dt>
<dd>When searching for ALI and object files, look in directory <code class="docutils literal"><span class="pre">dir</span></code>.</dd>
</dl>
<dl class="docutils" id="index-16">
<dt><code class="switch docutils literal"><span class="pre">-I</span><em><span class="pre">dir</span></em></code></dt>
<dd>Equivalent to <code class="switch docutils literal"><span class="pre">-aO</span><em><span class="pre">dir</span></em></code>.</dd>
</dl>
<span class="target" id="index-17"></span><dl class="docutils" id="index-18">
<dt><code class="switch docutils literal"><span class="pre">-I-</span></code></dt>
<dd>Do not look for ALI or object files in the directory
where <code class="docutils literal"><span class="pre">gnatclean</span></code> was invoked.</dd>
</dl>
</div>
</div>
<div class="section" id="the-gnat-library-browser-gnatls">
<span id="id5"></span><h2>5.2. The GNAT Library Browser <code class="docutils literal"><span class="pre">gnatls</span></code><a class="headerlink" href="#the-gnat-library-browser-gnatls" title="Permalink to this headline">¶</a></h2>
<span class="target" id="index-19"></span><p id="index-20"><code class="docutils literal"><span class="pre">gnatls</span></code> is a tool that outputs information about compiled
units. It gives the relationship between objects, unit names and source
files. It can also be used to check the source dependencies of a unit
as well as various characteristics.</p>
<div class="section" id="running-gnatls">
<span id="id6"></span><h3>5.2.1. Running <code class="docutils literal"><span class="pre">gnatls</span></code><a class="headerlink" href="#running-gnatls" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">gnatls</span></code> command has the form</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span>$ gnatls switches object_or_ali_file
</pre></div>
</div>
</div></blockquote>
<p>The main argument is the list of object or <code class="file docutils literal"><span class="pre">ali</span></code> files
(see <a class="reference internal" href="the_gnat_compilation_model.html#the-ada-library-information-files"><span class="std std-ref">The Ada Library Information Files</span></a>)
for which information is requested.</p>
<p>In normal mode, without additional option, <code class="docutils literal"><span class="pre">gnatls</span></code> produces a
four-column listing. Each line represents information for a specific
object. The first column gives the full path of the object, the second
column gives the name of the principal unit in this object, the third
column gives the status of the source and the fourth column gives the
full path of the source representing this unit.
Here is a simple example of use:</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span>$ gnatls *.o
./demo1.o            demo1            DIF demo1.adb
./demo2.o            demo2             OK demo2.adb
./hello.o            h1                OK hello.adb
./instr-child.o      instr.child      MOK instr-child.adb
./instr.o            instr             OK instr.adb
./tef.o              tef              DIF tef.adb
./text_io_example.o  text_io_example   OK text_io_example.adb
./tgef.o             tgef             DIF tgef.adb
</pre></div>
</div>
</div></blockquote>
<p>The first line can be interpreted as follows: the main unit which is
contained in
object file <code class="file docutils literal"><span class="pre">demo1.o</span></code> is demo1, whose main source is in
<code class="file docutils literal"><span class="pre">demo1.adb</span></code>. Furthermore, the version of the source used for the
compilation of demo1 has been modified (DIF). Each source file has a status
qualifier which can be:</p>
<dl class="docutils">
<dt><em>OK (unchanged)</em></dt>
<dd>The version of the source file used for the compilation of the
specified unit corresponds exactly to the actual source file.</dd>
<dt><em>MOK (slightly modified)</em></dt>
<dd>The version of the source file used for the compilation of the
specified unit differs from the actual source file but not enough to
require recompilation. If you use gnatmake with the option
<code class="switch docutils literal"><span class="pre">-m</span></code> (minimal recompilation), a file marked
MOK will not be recompiled.</dd>
<dt><em>DIF (modified)</em></dt>
<dd>No version of the source found on the path corresponds to the source
used to build this object.</dd>
<dt><em>??? (file not found)</em></dt>
<dd>No source file was found for this unit.</dd>
<dt><em>HID (hidden,  unchanged version not first on PATH)</em></dt>
<dd>The version of the source that corresponds exactly to the source used
for compilation has been found on the path but it is hidden by another
version of the same source that has been modified.</dd>
</dl>
</div>
<div class="section" id="switches-for-gnatls">
<span id="id7"></span><h3>5.2.2. Switches for <code class="docutils literal"><span class="pre">gnatls</span></code><a class="headerlink" href="#switches-for-gnatls" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal"><span class="pre">gnatls</span></code> recognizes the following switches:</p>
<dl class="docutils" id="index-21">
<dt><code class="switch docutils literal"><span class="pre">--version</span></code></dt>
<dd>Display copyright and version, then exit disregarding all other options.</dd>
</dl>
<dl class="docutils" id="index-22">
<dt><code class="switch docutils literal"><span class="pre">--help</span></code></dt>
<dd>If <code class="switch docutils literal"><span class="pre">--version</span></code> was not used, display usage, then exit disregarding
all other options.</dd>
</dl>
<dl class="docutils" id="index-23">
<dt><code class="switch docutils literal"><span class="pre">-a</span></code></dt>
<dd>Consider all units, including those of the predefined Ada library.
Especially useful with <code class="switch docutils literal"><span class="pre">-d</span></code>.</dd>
</dl>
<dl class="docutils" id="index-24">
<dt><code class="switch docutils literal"><span class="pre">-d</span></code></dt>
<dd>List sources from which specified units depend on.</dd>
</dl>
<dl class="docutils" id="index-25">
<dt><code class="switch docutils literal"><span class="pre">-h</span></code></dt>
<dd>Output the list of options.</dd>
</dl>
<dl class="docutils" id="index-26">
<dt><code class="switch docutils literal"><span class="pre">-o</span></code></dt>
<dd>Only output information about object files.</dd>
</dl>
<dl class="docutils" id="index-27">
<dt><code class="switch docutils literal"><span class="pre">-s</span></code></dt>
<dd>Only output information about source files.</dd>
</dl>
<dl class="docutils" id="index-28">
<dt><code class="switch docutils literal"><span class="pre">-u</span></code></dt>
<dd>Only output information about compilation units.</dd>
</dl>
<dl class="docutils" id="index-29">
<dt><code class="switch docutils literal"><span class="pre">-files=</span><em><span class="pre">file</span></em></code></dt>
<dd>Take as arguments the files listed in text file <code class="docutils literal"><span class="pre">file</span></code>.
Text file <code class="docutils literal"><span class="pre">file</span></code> may contain empty lines that are ignored.
Each nonempty line should contain the name of an existing file.
Several such switches may be specified simultaneously.</dd>
</dl>
<span class="target" id="index-30"></span><span class="target" id="index-31"></span><span class="target" id="index-32"></span><dl class="docutils" id="index-33">
<dt><code class="switch docutils literal"><span class="pre">-aO</span><em><span class="pre">dir</span></em></code>, <code class="switch docutils literal"><span class="pre">-aI</span><em><span class="pre">dir</span></em></code>, <code class="switch docutils literal"><span class="pre">-I</span><em><span class="pre">dir</span></em></code>, <code class="switch docutils literal"><span class="pre">-I-</span></code>, <code class="switch docutils literal"><span class="pre">-nostdinc</span></code></dt>
<dd>Source path manipulation. Same meaning as the equivalent <code class="docutils literal"><span class="pre">gnatmake</span></code>
flags (<a class="reference internal" href="building_executable_programs_with_gnat.html#switches-for-gnatmake"><span class="std std-ref">Switches for gnatmake</span></a>).</dd>
</dl>
<dl class="docutils" id="index-34">
<dt><code class="switch docutils literal"><span class="pre">-aP</span><em><span class="pre">dir</span></em></code></dt>
<dd>Add <code class="docutils literal"><span class="pre">dir</span></code> at the beginning of the project search dir.</dd>
</dl>
<dl class="docutils" id="index-35">
<dt><code class="switch docutils literal"><span class="pre">--RTS=</span><em><span class="pre">rts-path</span></em></code></dt>
<dd>Specifies the default location of the runtime library. Same meaning as the
equivalent <code class="docutils literal"><span class="pre">gnatmake</span></code> flag (<a class="reference internal" href="building_executable_programs_with_gnat.html#switches-for-gnatmake"><span class="std std-ref">Switches for gnatmake</span></a>).</dd>
</dl>
<dl class="docutils" id="index-36">
<dt><code class="switch docutils literal"><span class="pre">-v</span></code></dt>
<dd><p class="first">Verbose mode. Output the complete source, object and project paths. Do not use
the default column layout but instead use long format giving as much as
information possible on each requested units, including special
characteristics such as:</p>
<ul class="last simple">
<li><em>Preelaborable</em>: The unit is preelaborable in the Ada sense.</li>
<li><em>No_Elab_Code</em>:  No elaboration code has been produced by the compiler for this unit.</li>
<li><em>Pure</em>: The unit is pure in the Ada sense.</li>
<li><em>Elaborate_Body</em>: The unit contains a pragma Elaborate_Body.</li>
<li><em>Remote_Types</em>: The unit contains a pragma Remote_Types.</li>
<li><em>Shared_Passive</em>: The unit contains a pragma Shared_Passive.</li>
<li><em>Predefined</em>: This unit is part of the predefined environment and cannot be modified
by the user.</li>
<li><em>Remote_Call_Interface</em>: The unit contains a pragma Remote_Call_Interface.</li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="example-of-gnatls-usage">
<span id="id8"></span><h3>5.2.3. Example of <code class="docutils literal"><span class="pre">gnatls</span></code> Usage<a class="headerlink" href="#example-of-gnatls-usage" title="Permalink to this headline">¶</a></h3>
<p>Example of using the verbose switch. Note how the source and
object paths are affected by the -I switch.</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span>$ gnatls -v -I.. demo1.o

GNATLS 5.03w (20041123-34)
Copyright 1997-2004 Free Software Foundation, Inc.

Source Search Path:
   &lt;Current_Directory&gt;
   ../
   /home/comar/local/adainclude/

Object Search Path:
   &lt;Current_Directory&gt;
   ../
   /home/comar/local/lib/gcc-lib/x86-linux/3.4.3/adalib/

Project Search Path:
   &lt;Current_Directory&gt;
   /home/comar/local/lib/gnat/

./demo1.o
   Unit =&gt;
     Name   =&gt; demo1
     Kind   =&gt; subprogram body
     Flags  =&gt; No_Elab_Code
     Source =&gt; demo1.adb    modified
</pre></div>
</div>
</div></blockquote>
<p>The following is an example of use of the dependency list.
Note the use of the -s switch
which gives a straight list of source files. This can be useful for
building specialized scripts.</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span>$ gnatls -d demo2.o
./demo2.o   demo2        OK demo2.adb
                         OK gen_list.ads
                         OK gen_list.adb
                         OK instr.ads
                         OK instr-child.ads

$ gnatls -d -s -a demo1.o
demo1.adb
/home/comar/local/adainclude/ada.ads
/home/comar/local/adainclude/a-finali.ads
/home/comar/local/adainclude/a-filico.ads
/home/comar/local/adainclude/a-stream.ads
/home/comar/local/adainclude/a-tags.ads
gen_list.ads
gen_list.adb
/home/comar/local/adainclude/gnat.ads
/home/comar/local/adainclude/g-io.ads
instr.ads
/home/comar/local/adainclude/system.ads
/home/comar/local/adainclude/s-exctab.ads
/home/comar/local/adainclude/s-finimp.ads
/home/comar/local/adainclude/s-finroo.ads
/home/comar/local/adainclude/s-secsta.ads
/home/comar/local/adainclude/s-stalib.ads
/home/comar/local/adainclude/s-stoele.ads
/home/comar/local/adainclude/s-stratt.ads
/home/comar/local/adainclude/s-tasoli.ads
/home/comar/local/adainclude/s-unstyp.ads
/home/comar/local/adainclude/unchconv.ads
</pre></div>
</div>
</div></blockquote>
</div>
</div>
<div class="section" id="the-cross-referencing-tools-gnatxref-and-gnatfind">
<span id="id9"></span><h2>5.3. The Cross-Referencing Tools <code class="docutils literal"><span class="pre">gnatxref</span></code> and <code class="docutils literal"><span class="pre">gnatfind</span></code><a class="headerlink" href="#the-cross-referencing-tools-gnatxref-and-gnatfind" title="Permalink to this headline">¶</a></h2>
<span class="target" id="index-37"></span><p id="index-38">The compiler generates cross-referencing information (unless
you set the <code class="switch docutils literal"><span class="pre">-gnatx</span></code> switch), which are saved in the <code class="file docutils literal"><span class="pre">.ali</span></code> files.
This information indicates where in the source each entity is declared and
referenced. Note that entities in package Standard are not included, but
entities in all other predefined units are included in the output.</p>
<p>Before using any of these two tools, you need to compile successfully your
application, so that GNAT gets a chance to generate the cross-referencing
information.</p>
<p>The two tools <code class="docutils literal"><span class="pre">gnatxref</span></code> and <code class="docutils literal"><span class="pre">gnatfind</span></code> take advantage of this
information to provide the user with the capability to easily locate the
declaration and references to an entity. These tools are quite similar,
the difference being that <code class="docutils literal"><span class="pre">gnatfind</span></code> is intended for locating
definitions and/or references to a specified entity or entities, whereas
<code class="docutils literal"><span class="pre">gnatxref</span></code> is oriented to generating a full report of all
cross-references.</p>
<p>To use these tools, you must not compile your application using the
<code class="switch docutils literal"><span class="pre">-gnatx</span></code> switch on the <code class="docutils literal"><span class="pre">gnatmake</span></code> command line
(see <a class="reference internal" href="building_executable_programs_with_gnat.html#the-gnat-make-program-gnatmake"><span class="std std-ref">Building with gnatmake</span></a>). Otherwise, cross-referencing
information will not be generated.</p>
<div class="section" id="gnatxref-switches">
<span id="id10"></span><h3>5.3.1. <code class="docutils literal"><span class="pre">gnatxref</span></code> Switches<a class="headerlink" href="#gnatxref-switches" title="Permalink to this headline">¶</a></h3>
<p>The command invocation for <code class="docutils literal"><span class="pre">gnatxref</span></code> is:</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span>$ gnatxref [ switches ] sourcefile1 [ sourcefile2 ... ]
</pre></div>
</div>
</div></blockquote>
<p>where</p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">sourcefile1</span></code> [, <code class="docutils literal"><span class="pre">sourcefile2</span></code> ...]</dt>
<dd><p class="first">identify the source files for which a report is to be generated. The
<code class="docutils literal"><span class="pre">with</span></code>ed units will be processed too. You must provide at least one file.</p>
<p>These file names are considered to be regular expressions, so for instance
specifying <code class="file docutils literal"><span class="pre">source*.adb</span></code> is the same as giving every file in the current
directory whose name starts with <code class="file docutils literal"><span class="pre">source</span></code> and whose extension is
<code class="file docutils literal"><span class="pre">adb</span></code>.</p>
<p class="last">You shouldn&#8217;t specify any directory name, just base names. <code class="docutils literal"><span class="pre">gnatxref</span></code>
and <code class="docutils literal"><span class="pre">gnatfind</span></code> will be able to locate these files by themselves using
the source path. If you specify directories, no result is produced.</p>
</dd>
</dl>
<p>The following switches are available for <code class="docutils literal"><span class="pre">gnatxref</span></code>:</p>
<dl class="docutils" id="index-39">
<dt><code class="switch docutils literal"><span class="pre">--version</span></code></dt>
<dd>Display copyright and version, then exit disregarding all other options.</dd>
</dl>
<dl class="docutils" id="index-40">
<dt><code class="switch docutils literal"><span class="pre">--help</span></code></dt>
<dd>If <code class="switch docutils literal"><span class="pre">--version</span></code> was not used, display usage, then exit disregarding
all other options.</dd>
</dl>
<dl class="docutils" id="index-41">
<dt><code class="switch docutils literal"><span class="pre">-a</span></code></dt>
<dd>If this switch is present, <code class="docutils literal"><span class="pre">gnatfind</span></code> and <code class="docutils literal"><span class="pre">gnatxref</span></code> will parse
the read-only files found in the library search path. Otherwise, these files
will be ignored. This option can be used to protect Gnat sources or your own
libraries from being parsed, thus making <code class="docutils literal"><span class="pre">gnatfind</span></code> and <code class="docutils literal"><span class="pre">gnatxref</span></code>
much faster, and their output much smaller. Read-only here refers to access
or permissions status in the file system for the current user.</dd>
</dl>
<dl class="docutils" id="index-42">
<dt><code class="switch docutils literal"><span class="pre">-aI</span><em><span class="pre">DIR</span></em></code></dt>
<dd>When looking for source files also look in directory DIR. The order in which
source file search is undertaken is the same as for <code class="docutils literal"><span class="pre">gnatmake</span></code>.</dd>
</dl>
<dl class="docutils" id="index-43">
<dt><code class="switch docutils literal"><span class="pre">aO</span><em><span class="pre">DIR</span></em></code></dt>
<dd>When -searching for library and object files, look in directory
DIR. The order in which library files are searched is the same as for
<code class="docutils literal"><span class="pre">gnatmake</span></code>.</dd>
</dl>
<dl class="docutils" id="index-44">
<dt><code class="switch docutils literal"><span class="pre">-nostdinc</span></code></dt>
<dd>Do not look for sources in the system default directory.</dd>
</dl>
<dl class="docutils" id="index-45">
<dt><code class="switch docutils literal"><span class="pre">-nostdlib</span></code></dt>
<dd>Do not look for library files in the system default directory.</dd>
</dl>
<dl class="docutils" id="index-46">
<dt><code class="switch docutils literal"><span class="pre">--ext=</span><em><span class="pre">extension</span></em></code></dt>
<dd>Specify an alternate ali file extension. The default is <code class="docutils literal"><span class="pre">ali</span></code> and other
extensions (e.g. <code class="docutils literal"><span class="pre">gli</span></code> for C/C++ sources) may be specified via this switch.
Note that if this switch overrides the default, only the new extension will
be considered.</dd>
</dl>
<dl class="docutils" id="index-47">
<dt><code class="switch docutils literal"><span class="pre">--RTS=</span><em><span class="pre">rts-path</span></em></code></dt>
<dd>Specifies the default location of the runtime library. Same meaning as the
equivalent <code class="docutils literal"><span class="pre">gnatmake</span></code> flag (<a class="reference internal" href="building_executable_programs_with_gnat.html#switches-for-gnatmake"><span class="std std-ref">Switches for gnatmake</span></a>).</dd>
</dl>
<dl class="docutils" id="index-48">
<dt><code class="switch docutils literal"><span class="pre">-d</span></code></dt>
<dd>If this switch is set <code class="docutils literal"><span class="pre">gnatxref</span></code> will output the parent type
reference for each matching derived types.</dd>
</dl>
<dl class="docutils" id="index-49">
<dt><code class="switch docutils literal"><span class="pre">-f</span></code></dt>
<dd>If this switch is set, the output file names will be preceded by their
directory (if the file was found in the search path). If this switch is
not set, the directory will not be printed.</dd>
</dl>
<dl class="docutils" id="index-50">
<dt><code class="switch docutils literal"><span class="pre">-g</span></code></dt>
<dd>If this switch is set, information is output only for library-level
entities, ignoring local entities. The use of this switch may accelerate
<code class="docutils literal"><span class="pre">gnatfind</span></code> and <code class="docutils literal"><span class="pre">gnatxref</span></code>.</dd>
</dl>
<dl class="docutils" id="index-51">
<dt><code class="switch docutils literal"><span class="pre">-I</span><em><span class="pre">DIR</span></em></code></dt>
<dd>Equivalent to <code class="switch docutils literal"><span class="pre">-aODIR</span> <span class="pre">-aIDIR</span></code>.</dd>
</dl>
<dl class="docutils" id="index-52">
<dt><code class="switch docutils literal"><span class="pre">-p</span><em><span class="pre">FILE</span></em></code></dt>
<dd><p class="first">Specify a configuration file to use to list the source and object directories.</p>
<p>If a file is specified, then the content of the source directory and object
directory lines are added as if they had been specified respectively
by <code class="switch docutils literal"><span class="pre">-aI</span></code> and <code class="switch docutils literal"><span class="pre">-aO</span></code>.</p>
<p class="last">See <a class="reference internal" href="#configuration-files-for-gnatxref-and-gnatfind"><span class="std std-ref">Configuration Files for gnatxref and gnatfind</span></a> for the syntax
of this configuration file.</p>
</dd>
<dt><code class="switch docutils literal"><span class="pre">-u</span></code></dt>
<dd>Output only unused symbols. This may be really useful if you give your
main compilation unit on the command line, as <code class="docutils literal"><span class="pre">gnatxref</span></code> will then
display every unused entity and &#8216;with&#8217;ed package.</dd>
<dt><code class="switch docutils literal"><span class="pre">-v</span></code></dt>
<dd>Instead of producing the default output, <code class="docutils literal"><span class="pre">gnatxref</span></code> will generate a
<code class="file docutils literal"><span class="pre">tags</span></code> file that can be used by vi. For examples how to use this
feature, see <a class="reference internal" href="#examples-of-gnatxref-usage"><span class="std std-ref">Examples of gnatxref Usage</span></a>. The tags file is output
to the standard output, thus you will have to redirect it to a file.</dd>
</dl>
<p>All these switches may be in any order on the command line, and may even
appear after the file names. They need not be separated by spaces, thus
you can say <code class="docutils literal"><span class="pre">gnatxref</span> <span class="pre">-ag</span></code> instead of <code class="docutils literal"><span class="pre">gnatxref</span> <span class="pre">-a</span> <span class="pre">-g</span></code>.</p>
</div>
<div class="section" id="gnatfind-switches">
<span id="id11"></span><h3>5.3.2. <code class="docutils literal"><span class="pre">gnatfind</span></code> Switches<a class="headerlink" href="#gnatfind-switches" title="Permalink to this headline">¶</a></h3>
<p>The command invocation for <code class="docutils literal"><span class="pre">gnatfind</span></code> is:</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span>$ gnatfind [ switches ]  pattern[:sourcefile[:line[:column]]]
      [file1 file2 ...]
</pre></div>
</div>
</div></blockquote>
<p>with the following iterpretation of the command arguments:</p>
<dl class="docutils">
<dt><em>pattern</em></dt>
<dd><p class="first">An entity will be output only if it matches the regular expression found
in <em>pattern</em>, see <a class="reference internal" href="#regular-expressions-in-gnatfind-and-gnatxref"><span class="std std-ref">Regular Expressions in gnatfind and gnatxref</span></a>.</p>
<p>Omitting the pattern is equivalent to specifying <code class="docutils literal"><span class="pre">*</span></code>, which
will match any entity. Note that if you do not provide a pattern, you
have to provide both a sourcefile and a line.</p>
<p class="last">Entity names are given in Latin-1, with uppercase/lowercase equivalence
for matching purposes. At the current time there is no support for
8-bit codes other than Latin-1, or for wide characters in identifiers.</p>
</dd>
<dt><em>sourcefile</em></dt>
<dd><code class="docutils literal"><span class="pre">gnatfind</span></code> will look for references, bodies or declarations
of symbols referenced in <code class="file docutils literal"><span class="pre">sourcefile</span></code>, at line <code class="docutils literal"><span class="pre">line</span></code>
and column <code class="docutils literal"><span class="pre">column</span></code>. See <a class="reference internal" href="#examples-of-gnatfind-usage"><span class="std std-ref">Examples of gnatfind Usage</span></a>
for syntax examples.</dd>
<dt><em>line</em></dt>
<dd>A decimal integer identifying the line number containing
the reference to the entity (or entities) to be located.</dd>
<dt><em>column</em></dt>
<dd>A decimal integer identifying the exact location on the
line of the first character of the identifier for the
entity reference. Columns are numbered from 1.</dd>
<dt><em>file1 file2 ...</em></dt>
<dd><p class="first">The search will be restricted to these source files. If none are given, then
the search will be conducted for every library file in the search path.
These files must appear only after the pattern or sourcefile.</p>
<p>These file names are considered to be regular expressions, so for instance
specifying <code class="file docutils literal"><span class="pre">source*.adb</span></code> is the same as giving every file in the current
directory whose name starts with <code class="file docutils literal"><span class="pre">source</span></code> and whose extension is
<code class="file docutils literal"><span class="pre">adb</span></code>.</p>
<p>The location of the spec of the entity will always be displayed, even if it
isn&#8217;t in one of <code class="file docutils literal"><span class="pre">file1</span></code>, <code class="file docutils literal"><span class="pre">file2</span></code>, ... The
occurrences of the entity in the separate units of the ones given on the
command line will also be displayed.</p>
<p class="last">Note that if you specify at least one file in this part, <code class="docutils literal"><span class="pre">gnatfind</span></code> may
sometimes not be able to find the body of the subprograms.</p>
</dd>
</dl>
<p>At least one of &#8216;sourcefile&#8217; or &#8216;pattern&#8217; has to be present on
the command line.</p>
<p>The following switches are available:</p>
<dl class="docutils" id="index-53">
<dt><code class="switch docutils literal"><span class="pre">--version</span></code></dt>
<dd>Display copyright and version, then exit disregarding all other options.</dd>
</dl>
<dl class="docutils" id="index-54">
<dt><code class="switch docutils literal"><span class="pre">--help</span></code></dt>
<dd>If <code class="switch docutils literal"><span class="pre">--version</span></code> was not used, display usage, then exit disregarding
all other options.</dd>
</dl>
<dl class="docutils" id="index-55">
<dt><code class="switch docutils literal"><span class="pre">-a</span></code></dt>
<dd>If this switch is present, <code class="docutils literal"><span class="pre">gnatfind</span></code> and <code class="docutils literal"><span class="pre">gnatxref</span></code> will parse
the read-only files found in the library search path. Otherwise, these files
will be ignored. This option can be used to protect Gnat sources or your own
libraries from being parsed, thus making <code class="docutils literal"><span class="pre">gnatfind</span></code> and <code class="docutils literal"><span class="pre">gnatxref</span></code>
much faster, and their output much smaller. Read-only here refers to access
or permission status in the file system for the current user.</dd>
</dl>
<dl class="docutils" id="index-56">
<dt><code class="switch docutils literal"><span class="pre">-aI</span><em><span class="pre">DIR</span></em></code></dt>
<dd>When looking for source files also look in directory DIR. The order in which
source file search is undertaken is the same as for <code class="docutils literal"><span class="pre">gnatmake</span></code>.</dd>
</dl>
<dl class="docutils" id="index-57">
<dt><code class="switch docutils literal"><span class="pre">-aO</span><em><span class="pre">DIR</span></em></code></dt>
<dd>When searching for library and object files, look in directory
DIR. The order in which library files are searched is the same as for
<code class="docutils literal"><span class="pre">gnatmake</span></code>.</dd>
</dl>
<dl class="docutils" id="index-58">
<dt><code class="switch docutils literal"><span class="pre">-nostdinc</span></code></dt>
<dd>Do not look for sources in the system default directory.</dd>
</dl>
<dl class="docutils" id="index-59">
<dt><code class="switch docutils literal"><span class="pre">-nostdlib</span></code></dt>
<dd>Do not look for library files in the system default directory.</dd>
</dl>
<dl class="docutils" id="index-60">
<dt><code class="switch docutils literal"><span class="pre">--ext=</span><em><span class="pre">extension</span></em></code></dt>
<dd>Specify an alternate ali file extension. The default is <code class="docutils literal"><span class="pre">ali</span></code> and other
extensions may be specified via this switch. Note that if this switch
overrides the default, only the new extension will be considered.</dd>
</dl>
<dl class="docutils" id="index-61">
<dt><code class="switch docutils literal"><span class="pre">--RTS=</span><em><span class="pre">rts-path</span></em></code></dt>
<dd>Specifies the default location of the runtime library. Same meaning as the
equivalent <code class="docutils literal"><span class="pre">gnatmake</span></code> flag (<a class="reference internal" href="building_executable_programs_with_gnat.html#switches-for-gnatmake"><span class="std std-ref">Switches for gnatmake</span></a>).</dd>
</dl>
<dl class="docutils" id="index-62">
<dt><code class="switch docutils literal"><span class="pre">-d</span></code></dt>
<dd>If this switch is set, then <code class="docutils literal"><span class="pre">gnatfind</span></code> will output the parent type
reference for each matching derived types.</dd>
</dl>
<dl class="docutils" id="index-63">
<dt><code class="switch docutils literal"><span class="pre">-e</span></code></dt>
<dd>By default, <code class="docutils literal"><span class="pre">gnatfind</span></code> accept the simple regular expression set for
<code class="docutils literal"><span class="pre">pattern</span></code>. If this switch is set, then the pattern will be
considered as full Unix-style regular expression.</dd>
</dl>
<dl class="docutils" id="index-64">
<dt><code class="switch docutils literal"><span class="pre">-f</span></code></dt>
<dd>If this switch is set, the output file names will be preceded by their
directory (if the file was found in the search path). If this switch is
not set, the directory will not be printed.</dd>
</dl>
<dl class="docutils" id="index-65">
<dt><code class="switch docutils literal"><span class="pre">-g</span></code></dt>
<dd>If this switch is set, information is output only for library-level
entities, ignoring local entities. The use of this switch may accelerate
<code class="docutils literal"><span class="pre">gnatfind</span></code> and <code class="docutils literal"><span class="pre">gnatxref</span></code>.</dd>
</dl>
<dl class="docutils" id="index-66">
<dt><code class="switch docutils literal"><span class="pre">-I</span><em><span class="pre">DIR</span></em></code></dt>
<dd>Equivalent to <code class="switch docutils literal"><span class="pre">-aODIR</span> <span class="pre">-aIDIR</span></code>.</dd>
</dl>
<dl class="docutils" id="index-67">
<dt><code class="switch docutils literal"><span class="pre">-p</span><em><span class="pre">FILE</span></em></code></dt>
<dd><p class="first">Specify a configuration file to use to list the source and object directories.</p>
<p>If a file is specified, then the content of the source directory and object
directory lines are added as if they had been specified respectively
by <code class="switch docutils literal"><span class="pre">-aI</span></code> and <code class="switch docutils literal"><span class="pre">-aO</span></code>.</p>
<p class="last">See <a class="reference internal" href="#configuration-files-for-gnatxref-and-gnatfind"><span class="std std-ref">Configuration Files for gnatxref and gnatfind</span></a> for the syntax
of this configuration file.</p>
</dd>
</dl>
<dl class="docutils" id="index-68">
<dt><code class="switch docutils literal"><span class="pre">-r</span></code></dt>
<dd>By default, <code class="docutils literal"><span class="pre">gnatfind</span></code> will output only the information about the
declaration, body or type completion of the entities. If this switch is
set, the <code class="docutils literal"><span class="pre">gnatfind</span></code> will locate every reference to the entities in
the files specified on the command line (or in every file in the search
path if no file is given on the command line).</dd>
</dl>
<dl class="docutils" id="index-69">
<dt><code class="switch docutils literal"><span class="pre">-s</span></code></dt>
<dd>If this switch is set, then <code class="docutils literal"><span class="pre">gnatfind</span></code> will output the content
of the Ada source file lines were the entity was found.</dd>
</dl>
<dl class="docutils" id="index-70">
<dt><code class="switch docutils literal"><span class="pre">-t</span></code></dt>
<dd>If this switch is set, then <code class="docutils literal"><span class="pre">gnatfind</span></code> will output the type hierarchy for
the specified type. It act like -d option but recursively from parent
type to parent type. When this switch is set it is not possible to
specify more than one file.</dd>
</dl>
<p>All these switches may be in any order on the command line, and may even
appear after the file names. They need not be separated by spaces, thus
you can say <code class="docutils literal"><span class="pre">gnatxref</span> <span class="pre">-ag</span></code> instead of
<code class="docutils literal"><span class="pre">gnatxref</span> <span class="pre">-a</span> <span class="pre">-g</span></code>.</p>
<p>As stated previously, <code class="docutils literal"><span class="pre">gnatfind</span></code> will search in every directory in the
search path. You can force it to look only in the current directory if
you specify <code class="docutils literal"><span class="pre">*</span></code> at the end of the command line.</p>
</div>
<div class="section" id="configuration-files-for-gnatxref-and-gnatfind">
<span id="id12"></span><h3>5.3.3. Configuration Files for <code class="docutils literal"><span class="pre">gnatxref</span></code> and <code class="docutils literal"><span class="pre">gnatfind</span></code><a class="headerlink" href="#configuration-files-for-gnatxref-and-gnatfind" title="Permalink to this headline">¶</a></h3>
<p>Configuration files are used by <code class="docutils literal"><span class="pre">gnatxref</span></code> and <code class="docutils literal"><span class="pre">gnatfind</span></code> to specify
the list of source and object directories to consider. They can be
specified via the <code class="switch docutils literal"><span class="pre">-p</span></code> switch.</p>
<p>The following lines can be included, in any order in the file:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt><em>src_dir=DIR</em></dt>
<dd>[default: <code class="docutils literal"><span class="pre">&quot;./&quot;</span></code>].
Specifies a directory where to look for source files. Multiple <code class="docutils literal"><span class="pre">src_dir</span></code>
lines can be specified and they will be searched in the order they
are specified.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><em>obj_dir=DIR</em></dt>
<dd>[default: <code class="docutils literal"><span class="pre">&quot;./&quot;</span></code>].
Specifies a directory where to look for object and library files. Multiple
<code class="docutils literal"><span class="pre">obj_dir</span></code> lines can be specified, and they will be searched in the order
they are specified</dd>
</dl>
</li>
</ul>
<p>Any other line will be silently ignored.</p>
</div>
<div class="section" id="regular-expressions-in-gnatfind-and-gnatxref">
<span id="id13"></span><h3>5.3.4. Regular Expressions in <code class="docutils literal"><span class="pre">gnatfind</span></code> and <code class="docutils literal"><span class="pre">gnatxref</span></code><a class="headerlink" href="#regular-expressions-in-gnatfind-and-gnatxref" title="Permalink to this headline">¶</a></h3>
<p>As specified in the section about <code class="docutils literal"><span class="pre">gnatfind</span></code>, the pattern can be a
regular expression. Two kinds of regular expressions
are recognized:</p>
<ul>
<li><dl class="first docutils">
<dt><em>Globbing pattern</em></dt>
<dd><p class="first">These are the most common regular expression. They are the same as are
generally used in a Unix shell command line, or in a DOS session.</p>
<p>Here is a more formal grammar:</p>
<div class="last highlight-default"><div class="highlight"><pre><span></span>regexp ::= term
term   ::= elmt            -- matches elmt
term   ::= elmt elmt       -- concatenation (elmt then elmt)
term   ::= *               -- any string of 0 or more characters
term   ::= ?               -- matches any character
term   ::= [char {char}]   -- matches any character listed
term   ::= [char - char]   -- matches any character in range
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><em>Full regular expression</em></dt>
<dd><p class="first">The second set of regular expressions is much more powerful. This is the
type of regular expressions recognized by utilities such as <code class="docutils literal"><span class="pre">grep</span></code>.</p>
<p>The following is the form of a regular expression, expressed in same BNF
style as is found in the Ada Reference Manual:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>regexp ::= term {| term}   -- alternation (term or term ...)

term ::= item {item}       -- concatenation (item then item)

item ::= elmt              -- match elmt
item ::= elmt *            -- zero or more elmt&#39;s
item ::= elmt +            -- one or more elmt&#39;s
item ::= elmt ?            -- matches elmt or nothing

elmt ::= nschar            -- matches given character
elmt ::= [nschar {nschar}]   -- matches any character listed
elmt ::= [^ nschar {nschar}] -- matches any character not listed
elmt ::= [char - char]     -- matches chars in given range
elmt ::= \\ char            -- matches given character
elmt ::= .                 -- matches any single character
elmt ::= ( regexp )        -- parens used for grouping

char ::= any character, including special characters
nschar ::= any character except ()[].*+?^
</pre></div>
</div>
<p>Here are a few examples:</p>
<blockquote class="last">
<div><dl class="docutils">
<dt><code class="docutils literal"><span class="pre">abcde|fghi</span></code></dt>
<dd><p class="first last">will match any of the two strings <code class="docutils literal"><span class="pre">abcde</span></code> and <code class="docutils literal"><span class="pre">fghi</span></code>,</p>
</dd>
<dt><code class="docutils literal"><span class="pre">abc*d</span></code></dt>
<dd><p class="first last">will match any string like <code class="docutils literal"><span class="pre">abd</span></code>, <code class="docutils literal"><span class="pre">abcd</span></code>, <code class="docutils literal"><span class="pre">abccd</span></code>,
<code class="docutils literal"><span class="pre">abcccd</span></code>, and so on,</p>
</dd>
<dt><code class="docutils literal"><span class="pre">[a-z]+</span></code></dt>
<dd><p class="first last">will match any string which has only lowercase characters in it (and at
least one character.</p>
</dd>
</dl>
</div></blockquote>
</dd>
</dl>
</li>
</ul>
</div>
<div class="section" id="examples-of-gnatxref-usage">
<span id="id14"></span><h3>5.3.5. Examples of <code class="docutils literal"><span class="pre">gnatxref</span></code> Usage<a class="headerlink" href="#examples-of-gnatxref-usage" title="Permalink to this headline">¶</a></h3>
<div class="section" id="general-usage">
<h4>5.3.5.1. General Usage<a class="headerlink" href="#general-usage" title="Permalink to this headline">¶</a></h4>
<p>For the following examples, we will consider the following units:</p>
<blockquote>
<div><div class="highlight-ada"><div class="highlight"><pre><span></span><span class="n">main.ads</span><span class="o">:</span>
<span class="mi">1</span><span class="o">:</span> <span class="kr">with</span><span class="p"> </span><span class="n">Bar</span><span class="p">;</span>
<span class="mi">2</span><span class="o">:</span> <span class="k">package </span><span class="nf">Main</span> <span class="kr">is</span><span class="p"></span>
<span class="mi">3</span><span class="o">:</span>     <span class="k">procedure </span><span class="nf">Foo</span> <span class="o">(</span><span class="n">B</span> <span class="o">:</span> <span class="kr">in</span><span class="p"> </span><span class="n">Integer</span><span class="o">)</span><span class="p">;</span>
<span class="mi">4</span><span class="o">:</span>     <span class="n">C</span> <span class="o">:</span> <span class="n">Integer</span><span class="p">;</span>
<span class="mi">5</span><span class="o">:</span> <span class="kr">private</span><span class="p"></span>
<span class="mi">6</span><span class="o">:</span>     <span class="n">D</span> <span class="o">:</span> <span class="n">Integer</span><span class="p">;</span>
<span class="mi">7</span><span class="o">:</span> <span class="k">end </span><span class="nf">Main</span><span class="p">;</span>

<span class="n">main.adb</span><span class="o">:</span>
<span class="mi">1</span><span class="o">:</span> <span class="k">package body </span><span class="nf">Main</span> <span class="kr">is</span><span class="p"></span>
<span class="mi">2</span><span class="o">:</span>     <span class="k">procedure </span><span class="nf">Foo</span> <span class="o">(</span><span class="n">B</span> <span class="o">:</span> <span class="kr">in</span><span class="p"> </span><span class="n">Integer</span><span class="o">)</span> <span class="kr">is</span><span class="p"></span>
<span class="mi">3</span><span class="o">:</span>     <span class="kr">begin</span><span class="p"></span>
<span class="mi">4</span><span class="o">:</span>        <span class="n">C</span> <span class="o">:=</span> <span class="n">B</span><span class="p">;</span>
<span class="mi">5</span><span class="o">:</span>        <span class="n">D</span> <span class="o">:=</span> <span class="n">B</span><span class="p">;</span>
<span class="mi">6</span><span class="o">:</span>        <span class="n">Bar.Print</span> <span class="o">(</span><span class="n">B</span><span class="o">)</span><span class="p">;</span>
<span class="mi">7</span><span class="o">:</span>        <span class="n">Bar.Print</span> <span class="o">(</span><span class="n">C</span><span class="o">)</span><span class="p">;</span>
<span class="mi">8</span><span class="o">:</span>     <span class="k">end </span><span class="nf">Foo</span><span class="p">;</span>
<span class="mi">9</span><span class="o">:</span> <span class="k">end </span><span class="nf">Main</span><span class="p">;</span>

<span class="n">bar.ads</span><span class="o">:</span>
<span class="mi">1</span><span class="o">:</span> <span class="k">package </span><span class="nf">Bar</span> <span class="kr">is</span><span class="p"></span>
<span class="mi">2</span><span class="o">:</span>     <span class="k">procedure </span><span class="nf">Print</span> <span class="o">(</span><span class="n">B</span> <span class="o">:</span> <span class="n">Integer</span><span class="o">)</span><span class="p">;</span>
<span class="mi">3</span><span class="o">:</span> <span class="k">end </span><span class="nf">bar</span><span class="p">;</span>
</pre></div>
</div>
</div></blockquote>
<p>The first thing to do is to recompile your application (for instance, in
that case just by doing a <code class="docutils literal"><span class="pre">gnatmake</span> <span class="pre">main</span></code>, so that GNAT generates
the cross-referencing information.
You can then issue any of the following commands:</p>
<blockquote>
<div><ul>
<li><p class="first"><code class="docutils literal"><span class="pre">gnatxref</span> <span class="pre">main.adb</span></code>
<code class="docutils literal"><span class="pre">gnatxref</span></code> generates cross-reference information for main.adb
and every unit &#8216;with&#8217;ed by main.adb.</p>
<p>The output would be:</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">B</span>                                                      <span class="n">Type</span><span class="p">:</span> <span class="n">Integer</span>
  <span class="n">Decl</span><span class="p">:</span> <span class="n">bar</span><span class="o">.</span><span class="n">ads</span>           <span class="mi">2</span><span class="p">:</span><span class="mi">22</span>
<span class="n">B</span>                                                      <span class="n">Type</span><span class="p">:</span> <span class="n">Integer</span>
  <span class="n">Decl</span><span class="p">:</span> <span class="n">main</span><span class="o">.</span><span class="n">ads</span>          <span class="mi">3</span><span class="p">:</span><span class="mi">20</span>
  <span class="n">Body</span><span class="p">:</span> <span class="n">main</span><span class="o">.</span><span class="n">adb</span>          <span class="mi">2</span><span class="p">:</span><span class="mi">20</span>
  <span class="n">Ref</span><span class="p">:</span>  <span class="n">main</span><span class="o">.</span><span class="n">adb</span>          <span class="mi">4</span><span class="p">:</span><span class="mi">13</span>     <span class="mi">5</span><span class="p">:</span><span class="mi">13</span>     <span class="mi">6</span><span class="p">:</span><span class="mi">19</span>
<span class="n">Bar</span>                                                    <span class="n">Type</span><span class="p">:</span> <span class="n">Unit</span>
  <span class="n">Decl</span><span class="p">:</span> <span class="n">bar</span><span class="o">.</span><span class="n">ads</span>           <span class="mi">1</span><span class="p">:</span><span class="mi">9</span>
  <span class="n">Ref</span><span class="p">:</span>  <span class="n">main</span><span class="o">.</span><span class="n">adb</span>          <span class="mi">6</span><span class="p">:</span><span class="mi">8</span>      <span class="mi">7</span><span class="p">:</span><span class="mi">8</span>
       <span class="n">main</span><span class="o">.</span><span class="n">ads</span>           <span class="mi">1</span><span class="p">:</span><span class="mi">6</span>
<span class="n">C</span>                                                      <span class="n">Type</span><span class="p">:</span> <span class="n">Integer</span>
  <span class="n">Decl</span><span class="p">:</span> <span class="n">main</span><span class="o">.</span><span class="n">ads</span>          <span class="mi">4</span><span class="p">:</span><span class="mi">5</span>
  <span class="n">Modi</span><span class="p">:</span> <span class="n">main</span><span class="o">.</span><span class="n">adb</span>          <span class="mi">4</span><span class="p">:</span><span class="mi">8</span>
  <span class="n">Ref</span><span class="p">:</span>  <span class="n">main</span><span class="o">.</span><span class="n">adb</span>          <span class="mi">7</span><span class="p">:</span><span class="mi">19</span>
<span class="n">D</span>                                                      <span class="n">Type</span><span class="p">:</span> <span class="n">Integer</span>
  <span class="n">Decl</span><span class="p">:</span> <span class="n">main</span><span class="o">.</span><span class="n">ads</span>          <span class="mi">6</span><span class="p">:</span><span class="mi">5</span>
  <span class="n">Modi</span><span class="p">:</span> <span class="n">main</span><span class="o">.</span><span class="n">adb</span>          <span class="mi">5</span><span class="p">:</span><span class="mi">8</span>
<span class="n">Foo</span>                                                    <span class="n">Type</span><span class="p">:</span> <span class="n">Unit</span>
  <span class="n">Decl</span><span class="p">:</span> <span class="n">main</span><span class="o">.</span><span class="n">ads</span>          <span class="mi">3</span><span class="p">:</span><span class="mi">15</span>
  <span class="n">Body</span><span class="p">:</span> <span class="n">main</span><span class="o">.</span><span class="n">adb</span>          <span class="mi">2</span><span class="p">:</span><span class="mi">15</span>
<span class="n">Main</span>                                                    <span class="n">Type</span><span class="p">:</span> <span class="n">Unit</span>
  <span class="n">Decl</span><span class="p">:</span> <span class="n">main</span><span class="o">.</span><span class="n">ads</span>          <span class="mi">2</span><span class="p">:</span><span class="mi">9</span>
  <span class="n">Body</span><span class="p">:</span> <span class="n">main</span><span class="o">.</span><span class="n">adb</span>          <span class="mi">1</span><span class="p">:</span><span class="mi">14</span>
<span class="n">Print</span>                                                   <span class="n">Type</span><span class="p">:</span> <span class="n">Unit</span>
  <span class="n">Decl</span><span class="p">:</span> <span class="n">bar</span><span class="o">.</span><span class="n">ads</span>           <span class="mi">2</span><span class="p">:</span><span class="mi">15</span>
  <span class="n">Ref</span><span class="p">:</span>  <span class="n">main</span><span class="o">.</span><span class="n">adb</span>          <span class="mi">6</span><span class="p">:</span><span class="mi">12</span>     <span class="mi">7</span><span class="p">:</span><span class="mi">12</span>
</pre></div>
</div>
</div></blockquote>
<p>This shows that the entity <code class="docutils literal"><span class="pre">Main</span></code> is declared in main.ads, line 2, column 9,
its body is in main.adb, line 1, column 14 and is not referenced any where.</p>
<p>The entity <code class="docutils literal"><span class="pre">Print</span></code> is declared in <code class="file docutils literal"><span class="pre">bar.ads</span></code>, line 2, column 15 and it
is referenced in <code class="file docutils literal"><span class="pre">main.adb</span></code>, line 6 column 12 and line 7 column 12.</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">gnatxref</span> <span class="pre">package1.adb</span> <span class="pre">package2.ads</span></code>
<code class="docutils literal"><span class="pre">gnatxref</span></code> will generates cross-reference information for
<code class="file docutils literal"><span class="pre">package1.adb</span></code>, <code class="file docutils literal"><span class="pre">package2.ads</span></code> and any other package <code class="docutils literal"><span class="pre">with</span></code>ed by any
of these.</p>
</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="using-gnatxref-with-vi">
<h4>5.3.5.2. Using <code class="docutils literal"><span class="pre">gnatxref</span></code> with <code class="docutils literal"><span class="pre">vi</span></code><a class="headerlink" href="#using-gnatxref-with-vi" title="Permalink to this headline">¶</a></h4>
<p><code class="docutils literal"><span class="pre">gnatxref</span></code> can generate a tags file output, which can be used
directly from <code class="docutils literal"><span class="pre">vi</span></code>. Note that the standard version of <code class="docutils literal"><span class="pre">vi</span></code>
will not work properly with overloaded symbols. Consider using another
free implementation of <code class="docutils literal"><span class="pre">vi</span></code>, such as <code class="docutils literal"><span class="pre">vim</span></code>.</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span>$ gnatxref -v gnatfind.adb &gt; tags
</pre></div>
</div>
</div></blockquote>
<p>The following command will generate the tags file for <code class="docutils literal"><span class="pre">gnatfind</span></code> itself
(if the sources are in the search path!):</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span>$ gnatxref -v gnatfind.adb &gt; tags
</pre></div>
</div>
</div></blockquote>
<p>From <code class="docutils literal"><span class="pre">vi</span></code>, you can then use the command <code class="samp docutils literal"><span class="pre">:tag</span> <em><span class="pre">entity</span></em></code>
(replacing <code class="docutils literal"><span class="pre">entity</span></code> by whatever you are looking for), and vi will
display a new file with the corresponding declaration of entity.</p>
</div>
</div>
<div class="section" id="examples-of-gnatfind-usage">
<span id="id15"></span><h3>5.3.6. Examples of <code class="docutils literal"><span class="pre">gnatfind</span></code> Usage<a class="headerlink" href="#examples-of-gnatfind-usage" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first"><code class="docutils literal"><span class="pre">gnatfind</span> <span class="pre">-f</span> <span class="pre">xyz:main.adb</span></code>
Find declarations for all entities xyz referenced at least once in
main.adb. The references are search in every library file in the search
path.</p>
<p>The directories will be printed as well (as the <code class="docutils literal"><span class="pre">-f</span></code>
switch is set)</p>
<p>The output will look like:</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">directory</span><span class="o">/</span><span class="n">main</span><span class="o">.</span><span class="n">ads</span><span class="p">:</span><span class="mi">106</span><span class="p">:</span><span class="mi">14</span><span class="p">:</span> <span class="n">xyz</span> <span class="o">&lt;=</span> <span class="n">declaration</span>
<span class="n">directory</span><span class="o">/</span><span class="n">main</span><span class="o">.</span><span class="n">adb</span><span class="p">:</span><span class="mi">24</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span> <span class="n">xyz</span> <span class="o">&lt;=</span> <span class="n">body</span>
<span class="n">directory</span><span class="o">/</span><span class="n">foo</span><span class="o">.</span><span class="n">ads</span><span class="p">:</span><span class="mi">45</span><span class="p">:</span><span class="mi">23</span><span class="p">:</span> <span class="n">xyz</span> <span class="o">&lt;=</span> <span class="n">declaration</span>
</pre></div>
</div>
</div></blockquote>
<p>I.e., one of the entities xyz found in main.adb is declared at
line 12 of main.ads (and its body is in main.adb), and another one is
declared at line 45 of foo.ads</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">gnatfind</span> <span class="pre">-fs</span> <span class="pre">xyz:main.adb</span></code>
This is the same command as the previous one, but <code class="docutils literal"><span class="pre">gnatfind</span></code> will
display the content of the Ada source file lines.</p>
<p>The output will look like:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">directory</span><span class="o">/</span><span class="n">main</span><span class="o">.</span><span class="n">ads</span><span class="p">:</span><span class="mi">106</span><span class="p">:</span><span class="mi">14</span><span class="p">:</span> <span class="n">xyz</span> <span class="o">&lt;=</span> <span class="n">declaration</span>
   <span class="n">procedure</span> <span class="n">xyz</span><span class="p">;</span>
<span class="n">directory</span><span class="o">/</span><span class="n">main</span><span class="o">.</span><span class="n">adb</span><span class="p">:</span><span class="mi">24</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span> <span class="n">xyz</span> <span class="o">&lt;=</span> <span class="n">body</span>
   <span class="n">procedure</span> <span class="n">xyz</span> <span class="ow">is</span>
<span class="n">directory</span><span class="o">/</span><span class="n">foo</span><span class="o">.</span><span class="n">ads</span><span class="p">:</span><span class="mi">45</span><span class="p">:</span><span class="mi">23</span><span class="p">:</span> <span class="n">xyz</span> <span class="o">&lt;=</span> <span class="n">declaration</span>
   <span class="n">xyz</span> <span class="p">:</span> <span class="n">Integer</span><span class="p">;</span>
</pre></div>
</div>
<p>This can make it easier to find exactly the location your are looking
for.</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">gnatfind</span> <span class="pre">-r</span> <span class="pre">&quot;*x*&quot;:main.ads:123</span> <span class="pre">foo.adb</span></code>
Find references to all entities containing an x that are
referenced on line 123 of main.ads.
The references will be searched only in main.ads and foo.adb.</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">gnatfind</span> <span class="pre">main.ads:123</span></code>
Find declarations and bodies for all entities that are referenced on
line 123 of main.ads.</p>
<p>This is the same as <code class="docutils literal"><span class="pre">gnatfind</span> <span class="pre">&quot;*&quot;:main.adb:123`</span></code></p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">gnatfind</span> <span class="pre">mydir/main.adb:123:45</span></code>
Find the declaration for the entity referenced at column 45 in
line 123 of file main.adb in directory mydir. Note that it
is usual to omit the identifier name when the column is given,
since the column position identifies a unique reference.</p>
<p>The column has to be the beginning of the identifier, and should not
point to any character in the middle of the identifier.</p>
</li>
</ul>
</div>
</div>
<div class="section" id="the-ada-to-html-converter-gnathtml">
<span id="id16"></span><h2>5.4. The Ada to HTML Converter <code class="docutils literal"><span class="pre">gnathtml</span></code><a class="headerlink" href="#the-ada-to-html-converter-gnathtml" title="Permalink to this headline">¶</a></h2>
<p id="index-71"><code class="docutils literal"><span class="pre">gnathtml</span></code> is a Perl script that allows Ada source files to be browsed using
standard Web browsers. For installation information, see <a class="reference internal" href="#installing-gnathtml"><span class="std std-ref">Installing gnathtml</span></a>.</p>
<p>Ada reserved keywords are highlighted in a bold font and Ada comments in
a blue font. Unless your program was compiled with the gcc <code class="switch docutils literal"><span class="pre">-gnatx</span></code>
switch to suppress the generation of cross-referencing information, user
defined variables and types will appear in a different color; you will
be able to click on any identifier and go to its declaration.</p>
<div class="section" id="invoking-gnathtml">
<span id="id17"></span><h3>5.4.1. Invoking <code class="docutils literal"><span class="pre">gnathtml</span></code><a class="headerlink" href="#invoking-gnathtml" title="Permalink to this headline">¶</a></h3>
<p>The command line is as follows:</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span>$ perl gnathtml.pl [ switches ] ada-files
</pre></div>
</div>
</div></blockquote>
<p>You can specify as many Ada files as you want. <code class="docutils literal"><span class="pre">gnathtml</span></code> will generate
an html file for every ada file, and a global file called <code class="file docutils literal"><span class="pre">index.htm</span></code>.
This file is an index of every identifier defined in the files.</p>
<p>The following switches are available:</p>
<dl class="docutils" id="index-72">
<dt><code class="samp docutils literal"><span class="pre">83</span></code></dt>
<dd>Only the Ada 83 subset of keywords will be highlighted.</dd>
</dl>
<dl class="docutils" id="index-73">
<dt><code class="samp docutils literal"><span class="pre">cc</span> <em><span class="pre">color</span></em></code></dt>
<dd>This option allows you to change the color used for comments. The default
value is green. The color argument can be any name accepted by html.</dd>
</dl>
<dl class="docutils" id="index-74">
<dt><code class="samp docutils literal"><span class="pre">d</span></code></dt>
<dd>If the Ada files depend on some other files (for instance through
<code class="docutils literal"><span class="pre">with</span></code> clauses, the latter files will also be converted to html.
Only the files in the user project will be converted to html, not the files
in the run-time library itself.</dd>
</dl>
<dl class="docutils" id="index-75">
<dt><code class="samp docutils literal"><span class="pre">D</span></code></dt>
<dd>This command is the same as <code class="switch docutils literal"><span class="pre">-d</span></code> above, but <code class="docutils literal"><span class="pre">gnathtml</span></code> will
also look for files in the run-time library, and generate html files for them.</dd>
</dl>
<dl class="docutils" id="index-76">
<dt><code class="samp docutils literal"><span class="pre">ext</span> <em><span class="pre">extension</span></em></code></dt>
<dd>This option allows you to change the extension of the generated HTML files.
If you do not specify an extension, it will default to <code class="file docutils literal"><span class="pre">htm</span></code>.</dd>
</dl>
<dl class="docutils" id="index-77">
<dt><code class="samp docutils literal"><span class="pre">f</span></code></dt>
<dd>By default, gnathtml will generate html links only for global entities
(&#8216;with&#8217;ed units, global variables and types,...). If you specify
<code class="switch docutils literal"><span class="pre">-f</span></code> on the command line, then links will be generated for local
entities too.</dd>
</dl>
<dl class="docutils" id="index-78">
<dt><code class="samp docutils literal"><span class="pre">l</span> <em><span class="pre">number</span></em></code></dt>
<dd>If this switch is provided and <code class="docutils literal"><span class="pre">number</span></code> is not 0, then
<code class="docutils literal"><span class="pre">gnathtml</span></code> will number the html files every <code class="docutils literal"><span class="pre">number</span></code> line.</dd>
</dl>
<dl class="docutils" id="index-79">
<dt><code class="samp docutils literal"><span class="pre">I</span> <em><span class="pre">dir</span></em></code></dt>
<dd>Specify a directory to search for library files (<code class="file docutils literal"><span class="pre">.ALI</span></code> files) and
source files. You can provide several -I switches on the command line,
and the directories will be parsed in the order of the command line.</dd>
</dl>
<dl class="docutils" id="index-80">
<dt><code class="samp docutils literal"><span class="pre">o</span> <em><span class="pre">dir</span></em></code></dt>
<dd>Specify the output directory for html files. By default, gnathtml will
saved the generated html files in a subdirectory named <code class="file docutils literal"><span class="pre">html/</span></code>.</dd>
</dl>
<dl class="docutils" id="index-81">
<dt><code class="samp docutils literal"><span class="pre">p</span> <em><span class="pre">file</span></em></code></dt>
<dd><p class="first">If you are using Emacs and the most recent Emacs Ada mode, which provides
a full Integrated Development Environment for compiling, checking,
running and debugging applications, you may use <code class="file docutils literal"><span class="pre">.gpr</span></code> files
to give the directories where Emacs can find sources and object files.</p>
<p class="last">Using this switch, you can tell gnathtml to use these files.
This allows you to get an html version of your application, even if it
is spread over multiple directories.</p>
</dd>
</dl>
<dl class="docutils" id="index-82">
<dt><code class="samp docutils literal"><span class="pre">sc</span> <em><span class="pre">color</span></em></code></dt>
<dd>This switch allows you to change the color used for symbol
definitions.
The default value is red. The color argument can be any name accepted by html.</dd>
</dl>
<dl class="docutils" id="index-83">
<dt><code class="samp docutils literal"><span class="pre">t</span> <em><span class="pre">file</span></em></code></dt>
<dd>This switch provides the name of a file. This file contains a list of
file names to be converted, and the effect is exactly as though they had
appeared explicitly on the command line. This
is the recommended way to work around the command line length limit on some
systems.</dd>
</dl>
</div>
<div class="section" id="installing-gnathtml">
<span id="id18"></span><h3>5.4.2. Installing <code class="docutils literal"><span class="pre">gnathtml</span></code><a class="headerlink" href="#installing-gnathtml" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal"><span class="pre">Perl</span></code> needs to be installed on your machine to run this script.
<code class="docutils literal"><span class="pre">Perl</span></code> is freely available for almost every architecture and
operating system via the Internet.</p>
<p>On Unix systems, you  may want to modify  the  first line of  the script
<code class="docutils literal"><span class="pre">gnathtml</span></code>,  to explicitly  specify  where Perl
is located. The syntax of this line is:</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span><span class="ch">#!full_path_name_to_perl</span>
</pre></div>
</div>
</div></blockquote>
<p>Alternatively, you may run the script using the following command line:</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span>$ perl gnathtml.pl [ switches ] files
</pre></div>
</div>
</div></blockquote>
</div>
</div>
<div class="section" id="the-ada-to-xml-converter-gnat2xml">
<span id="id19"></span><h2>5.5. The Ada-to-XML converter <code class="docutils literal"><span class="pre">gnat2xml</span></code><a class="headerlink" href="#the-ada-to-xml-converter-gnat2xml" title="Permalink to this headline">¶</a></h2>
<span class="target" id="index-84"></span><p id="index-85">The <code class="docutils literal"><span class="pre">gnat2xml</span></code> tool is an ASIS-based utility that converts
Ada source code into XML.</p>
<p><code class="docutils literal"><span class="pre">gnat2xml</span></code> is a project-aware tool
(see <a class="reference internal" href="#using-project-files-with-gnat-tools"><span class="std std-ref">Using Project Files with GNAT Tools</span></a> for a description of
the project-related switches). The project file package that can specify
<code class="docutils literal"><span class="pre">gnat2xml</span></code> switches is named <code class="docutils literal"><span class="pre">gnat2xml</span></code>.</p>
<div class="section" id="switches-for-gnat2xml">
<span id="id20"></span><h3>5.5.1. Switches for <code class="docutils literal"><span class="pre">gnat2xml</span></code><a class="headerlink" href="#switches-for-gnat2xml" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal"><span class="pre">gnat2xml</span></code> takes Ada source code as input, and produces XML
that conforms to the schema.</p>
<p>Usage:</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span>$ gnat2xml [options] filenames [-files filename] [-cargs gcc_switches]
</pre></div>
</div>
</div></blockquote>
<p>Options:</p>
<blockquote>
<div><dl class="docutils">
<dt><code class="switch docutils literal"><span class="pre">--help</span></code></dt>
<dd>Generate usage information and quit, ignoring all other options</dd>
<dt><code class="switch docutils literal"><span class="pre">-h</span></code></dt>
<dd>Same as <code class="docutils literal"><span class="pre">--help</span></code></dd>
<dt><code class="switch docutils literal"><span class="pre">--version</span></code></dt>
<dd>Print version and quit, ignoring all other options</dd>
<dt><code class="switch docutils literal"><span class="pre">-P</span><em><span class="pre">file</span></em></code></dt>
<dd>indicates the name of the project file that describes
the set of sources to be processed. The exact set of argument
sources depends on other options specified, see below.</dd>
<dt><code class="switch docutils literal"><span class="pre">-U</span></code></dt>
<dd>If a project file is specified and no argument source is explicitly
specified, process all the units of the closure of the argument project.
Otherwise this option has no effect.</dd>
<dt><code class="switch docutils literal"><span class="pre">-U</span> <em><span class="pre">main_unit</span></em></code></dt>
<dd>If a project file is specified and no argument source
is explicitly specified (either directly or by means of <code class="switch docutils literal"><span class="pre">-files</span></code>
option), process the closure of units rooted at <code class="docutils literal"><span class="pre">main_unit</span></code>.
Otherwise this option has no effect.</dd>
<dt><code class="switch docutils literal"><span class="pre">-X</span><em><span class="pre">name</span></em><span class="pre">=</span><em><span class="pre">value</span></em></code></dt>
<dd>Indicates that external variable <code class="docutils literal"><span class="pre">name</span></code> in
the argument project has the value <code class="docutils literal"><span class="pre">value</span></code>. Has no effect if no
project is specified.</dd>
<dt><code class="switch docutils literal"><span class="pre">--RTS=</span><em><span class="pre">rts-path</span></em></code></dt>
<dd>Specifies the default location of the runtime
library. Same meaning as the equivalent <code class="docutils literal"><span class="pre">gnatmake</span></code> flag
(<a class="reference internal" href="building_executable_programs_with_gnat.html#switches-for-gnatmake"><span class="std std-ref">Switches for gnatmake</span></a>).</dd>
<dt><code class="switch docutils literal"><span class="pre">--incremental</span></code></dt>
<dd>Incremental processing on a per-file basis. Source files are
only processed if they have been modified, or if files they depend
on have been modified. This is similar to the way gnatmake/gprbuild
only compiles files that need to be recompiled. A project file
is required in this mode.</dd>
<dt><code class="switch docutils literal"><span class="pre">-j</span><em><span class="pre">n</span></em></code></dt>
<dd>In <code class="switch docutils literal"><span class="pre">--incremental</span></code> mode, use <code class="docutils literal"><span class="pre">n</span></code> <code class="docutils literal"><span class="pre">gnat2xml</span></code>
processes to perform XML generation in parallel. If <code class="docutils literal"><span class="pre">n</span></code> is 0, then
the maximum number of parallel tree creations is the number of core
processors on the platform.</dd>
<dt><code class="switch docutils literal"><span class="pre">--output-dir=</span><em><span class="pre">dir</span></em></code></dt>
<dd>Generate one .xml file for each Ada source file, in
directory <code class="file docutils literal"><span class="pre">dir</span></code>. (Default is to generate the XML to standard
output.)</dd>
<dt><code class="switch docutils literal"><span class="pre">-I</span><em><span class="pre">include-dir</span></em></code></dt>
<dd>Directories to search for dependencies.
You can also set the ADA_INCLUDE_PATH environment variable for this.</dd>
<dt><code class="switch docutils literal"><span class="pre">--compact</span></code></dt>
<dd>Debugging version, with interspersed source, and a more
compact representation of &#8220;sloc&#8221;. This version does not conform
to any schema.</dd>
<dt><code class="switch docutils literal"><span class="pre">--rep-clauses</span></code></dt>
<dd>generate representation clauses (see <a class="reference internal" href="#generating-representation-clauses"><span class="std std-ref">Generating Representation Clauses</span></a>).</dd>
<dt><code class="switch docutils literal"><span class="pre">-files=</span><em><span class="pre">filename</span></em></code></dt>
<dd>Take as arguments the files listed in text file <code class="docutils literal"><span class="pre">file</span></code>.
Text file <code class="docutils literal"><span class="pre">file</span></code> may contain empty lines that are ignored.
Each nonempty line should contain the name of an existing file.
Several such switches may be specified simultaneously.</dd>
<dt><code class="switch docutils literal"><span class="pre">--ignore=</span><em><span class="pre">filename</span></em></code></dt>
<dd>Do not process the sources listed in a specified file. This option cannot
be used in incremental mode.</dd>
<dt><code class="switch docutils literal"><span class="pre">-q</span></code></dt>
<dd>Quiet</dd>
<dt><code class="switch docutils literal"><span class="pre">-v</span></code></dt>
<dd>Verbose</dd>
<dt><code class="switch docutils literal"><span class="pre">-cargs</span></code> ...</dt>
<dd>Options to pass to gcc</dd>
</dl>
</div></blockquote>
<p>If a project file is specified and no argument source is explicitly
specified, and no <code class="switch docutils literal"><span class="pre">-U</span></code> is specified, then the set of processed
sources is all the immediate units of the argument project.</p>
<p>Example:</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span>$ gnat2xml -v -output-dir=xml-files *.ad[sb]
</pre></div>
</div>
</div></blockquote>
<p>The above will create *.xml files in the <code class="file docutils literal"><span class="pre">xml-files</span></code> subdirectory.
For example, if there is an Ada package Mumble.Dumble, whose spec and
body source code lives in mumble-dumble.ads and mumble-dumble.adb,
the above will produce xml-files/mumble-dumble.ads.xml and
xml-files/mumble-dumble.adb.xml.</p>
</div>
<div class="section" id="other-programs">
<span id="id21"></span><h3>5.5.2. Other Programs<a class="headerlink" href="#other-programs" title="Permalink to this headline">¶</a></h3>
<p>The distribution includes two other programs that are related to
<code class="docutils literal"><span class="pre">gnat2xml</span></code>:</p>
<p><code class="docutils literal"><span class="pre">gnat2xsd</span></code> is the schema generator, which generates the schema
to standard output, based on the structure of Ada as encoded by
ASIS. You don&#8217;t need to run <code class="docutils literal"><span class="pre">gnat2xsd</span></code> in order to use
<code class="docutils literal"><span class="pre">gnat2xml</span></code>. To generate the schema, type:</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span>$ gnat2xsd &gt; ada-schema.xsd
</pre></div>
</div>
</div></blockquote>
<p><code class="docutils literal"><span class="pre">gnat2xml</span></code> generates XML files that will validate against
<code class="file docutils literal"><span class="pre">ada-schema.xsd</span></code>.</p>
<p><code class="docutils literal"><span class="pre">xml2gnat</span></code> is a back-translator that translates the XML back into
Ada source code. This is primarily for the purpose of testing
<code class="docutils literal"><span class="pre">gnat2xml</span></code>, rather than for users. The Ada generated by <code class="docutils literal"><span class="pre">xml2gnat</span></code>
has identical semantics to the original Ada code passed to
<code class="docutils literal"><span class="pre">gnat2xml</span></code>. It is not textually identical, however &#8212; for example,
no attempt is made to preserve the original indentation.</p>
<p>The <code class="docutils literal"><span class="pre">xml2gnat</span></code> command line contains a list of the same Ada files
passed to gnat2xml (not the names of xml files). The xml files are
assumed to be in an &#8216;xml&#8217; subdirectory of the directory in which the
Ada source files are. So for example, if the Ada source file is
some/dir/mumble.adb, then the xml file is found in
some/dir/xml/mumble.adb.xml. You should use the <code class="switch docutils literal"><span class="pre">--output-dir</span></code>
switch of <code class="docutils literal"><span class="pre">gnat2xml</span></code> to tell it to generate the output in the xml
subdirectory, so <code class="docutils literal"><span class="pre">xml2gnat</span></code> can find it.</p>
<p>Output goes into subdirectories &#8220;generated_ada&#8221; and &#8220;self_rep&#8221; of the
output directory, which is the current directory by default, but can
be overridden with &#8211;output-dir=dir on the command line.</p>
</div>
<div class="section" id="structure-of-the-xml">
<span id="id22"></span><h3>5.5.3. Structure of the XML<a class="headerlink" href="#structure-of-the-xml" title="Permalink to this headline">¶</a></h3>
<p>The primary documentation for the structure of the XML generated by
<code class="docutils literal"><span class="pre">gnat2xml</span></code> is the schema (see <code class="docutils literal"><span class="pre">gnat2xsd</span></code> above). The
following documentation gives additional details needed to understand
the schema and therefore the XML.</p>
<p>The elements listed under Defining Occurrences, Usage Occurrences, and
Other Elements represent the syntactic structure of the Ada program.
Element names are given in lower case, with the corresponding element
type Capitalized_Like_This. The element and element type names are
derived directly from the ASIS enumeration type Flat_Element_Kinds,
declared in Asis.Extensions.Flat_Kinds, with the leading <code class="docutils literal"><span class="pre">An_</span></code> or <code class="docutils literal"><span class="pre">A_</span></code>
removed. For example, the ASIS enumeration literal
An_Assignment_Statement corresponds to the XML element
assignment_statement of XML type Assignment_Statement.</p>
<p>To understand the details of the schema and the corresponding XML, it is
necessary to understand the ASIS standard, as well as the GNAT-specific
extension to ASIS.</p>
<p>A defining occurrence is an identifier (or character literal or operator
symbol) declared by a declaration. A usage occurrence is an identifier
(or ...) that references such a declared entity. For example, in:</p>
<blockquote>
<div><div class="highlight-ada"><div class="highlight"><pre><span></span><span class="kr">type</span><span class="p"> </span><span class="n">T</span> <span class="kr">is</span><span class="p"> </span><span class="kr">range</span><span class="p"> </span><span class="mi">1</span><span class="o">..</span><span class="mi">10</span><span class="p">;</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">:</span> <span class="kr">constant</span><span class="p"> </span><span class="n">T</span> <span class="o">:=</span> <span class="mi">1</span><span class="p">;</span>
</pre></div>
</div>
</div></blockquote>
<p>The first &#8216;T&#8217; is the defining occurrence of a type. The &#8216;X&#8217; is the
defining occurrence of a constant, as is the &#8216;Y&#8217;, and the second &#8216;T&#8217; is
a usage occurrence referring to the defining occurrence of T.</p>
<p>Each element has a &#8216;sloc&#8217; (source location), and subelements for each
syntactic subtree, reflecting the Ada grammar as implemented by ASIS.
The types of subelements are as defined in the ASIS standard. For
example, for the right-hand side of an assignment_statement we have
the following comment in asis-statements.ads:</p>
<blockquote>
<div><div class="highlight-ada"><div class="highlight"><pre><span></span><span class="c">------------------------------------------------------------------------------</span>
<span class="c">--  18.3  function Assignment_Expression</span>
<span class="c">------------------------------------------------------------------------------</span>

   <span class="k">function </span><span class="nf">Assignment_Expression</span>
     <span class="o">(</span><span class="n">Statement</span> <span class="o">:</span> <span class="n">Asis.Statement</span><span class="o">)</span>
      <span class="kr">return</span><span class="p"> </span>     <span class="n">Asis.Expression</span><span class="p">;</span>

<span class="c">------------------------------------------------------------------------------</span>
<span class="o">...</span>
<span class="c">--  Returns the expression from the right hand side of the assignment.</span>
<span class="o">...</span>
<span class="c">--  Returns Element_Kinds:</span>
<span class="c">--       An_Expression</span>
</pre></div>
</div>
</div></blockquote>
<p>The corresponding sub-element of type Assignment_Statement is:</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">xsd</span><span class="p">:</span><span class="n">element</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;assignment_expression_q&quot;</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;Expression_Class&quot;</span><span class="o">/&gt;</span>
</pre></div>
</div>
</div></blockquote>
<p>where Expression_Class is defined by an xsd:choice of all the
various kinds of expression.</p>
<p>The &#8216;sloc&#8217; of each element indicates the starting and ending line and
column numbers. Column numbers are character counts; that is, a tab
counts as 1, not as however many spaces it might expand to.</p>
<p>Subelements of type Element have names ending in &#8216;_q&#8217; (for ASIS
&#8220;Query&#8221;), and those of type Element_List end in &#8216;_ql&#8217;
(&#8220;Query returning  List&#8221;).</p>
<p>Some subelements are &#8216;Boolean&#8217;. For example, Private_Type_Definition
has has_abstract_q and has_limited_q, to indicate whether those
keywords are present, as in <code class="docutils literal"><span class="pre">type</span> <span class="pre">T</span> <span class="pre">is</span> <span class="pre">abstract</span> <span class="pre">limited</span> <span class="pre">private;</span></code>.
False is represented by a Nil_Element. True is represented
by an element type specific to that query (for example, Abstract and
Limited).</p>
<p>The root of the tree is a Compilation_Unit, with attributes:</p>
<ul class="simple">
<li>unit_kind, unit_class, and unit_origin. These are strings that match the
enumeration literals of types Unit_Kinds, Unit_Classes, and Unit_Origins
in package Asis.</li>
<li>unit_full_name is the full expanded name of the unit, starting from a
root library unit. So for <code class="docutils literal"><span class="pre">package</span> <span class="pre">P.Q.R</span> <span class="pre">is</span> <span class="pre">...</span></code>,
<code class="docutils literal"><span class="pre">unit_full_name=&quot;P.Q.R&quot;</span></code>. Same for <code class="docutils literal"><span class="pre">separate</span> <span class="pre">(P.Q)</span> <span class="pre">package</span> <span class="pre">R</span> <span class="pre">is</span> <span class="pre">...</span></code>.</li>
<li>def_name is the same as unit_full_name for library units; for subunits,
it is just the simple name.</li>
<li>source_file is the name of the Ada source file. For example, for
the spec of <code class="docutils literal"><span class="pre">P.Q.R</span></code>, <code class="docutils literal"><span class="pre">source_file=&quot;p-q-r.ads&quot;</span></code>. This allows one to
interpret the source locations &#8212; the &#8216;sloc&#8217; of all elements
within this Compilation_Unit refers to line and column numbers
within the named file.</li>
</ul>
<p>Defining occurrences have these attributes:</p>
<ul>
<li><p class="first">def_name is the simple name of the declared entity, as written in the Ada
source code.</p>
</li>
<li><p class="first">def is a unique URI of the form:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">ada</span><span class="p">:</span><span class="o">//</span><span class="n">kind</span><span class="o">/</span><span class="n">fully</span><span class="o">/</span><span class="n">qualified</span><span class="o">/</span><span class="n">name</span>
</pre></div>
</div>
<p>where:</p>
<ul class="simple">
<li>kind indicates the kind of Ada entity being declared (see below), and</li>
<li>fully/qualified/name, is the fully qualified name of the Ada
entity, with each of &#8216;fully&#8217;, &#8216;qualified&#8217;, and &#8216;name&#8217; being
mangled for uniqueness. We do not document the mangling
algorithm, which is subject to change; we just guarantee that the
names are unique in the face of overloading.</li>
<li>type is the type of the declared object, or <code class="docutils literal"><span class="pre">null</span></code> for
declarations of things other than objects.</li>
</ul>
</li>
</ul>
<p>Usage occurrences have these attributes:</p>
<ul class="simple">
<li>ref_name is the same as the def_name of the corresponding defining
occurrence. This attribute is not of much use, because of
overloading; use ref for lookups, instead.</li>
<li>ref is the same as the def of the corresponding defining
occurrence.</li>
</ul>
<p>In summary, <code class="docutils literal"><span class="pre">def_name</span></code> and <code class="docutils literal"><span class="pre">ref_name</span></code> are as in the source
code of the declaration, possibly overloaded, whereas <code class="docutils literal"><span class="pre">def</span></code> and
<code class="docutils literal"><span class="pre">ref</span></code> are unique-ified.</p>
<p>Literal elements have this attribute:</p>
<ul class="simple">
<li>lit_val is the value of the literal as written in the source text,
appropriately escaped (e.g. <code class="docutils literal"><span class="pre">&quot;</span></code> → <code class="docutils literal"><span class="pre">&amp;quot;</span></code>). This applies
only to numeric and string literals. Enumeration literals in Ada are
not really &#8220;literals&#8221; in the usual sense; they are usage occurrences,
and have ref_name and ref as described above. Note also that string
literals used as operator symbols are treated as defining or usage
occurrences, not as literals.</li>
</ul>
<p>Elements that can syntactically represent names and expressions (which
includes usage occurrences, plus function calls and so forth) have this
attribute:</p>
<ul class="simple">
<li>type. If the element represents an expression or the name of an object,
&#8216;type&#8217; is the &#8216;def&#8217; for the defining occurrence of the type of that
expression or name. Names of other kinds of entities, such as package
names and type names, do not have a type in Ada; these have type=&#8221;null&#8221;
in the XML.</li>
</ul>
<p>Pragma elements have this attribute:</p>
<ul class="simple">
<li>pragma_name is the name of the pragma. For language-defined pragmas, the
pragma name is redundant with the element kind (for example, an
assert_pragma element necessarily has pragma_name=&#8221;Assert&#8221;). However, all
implementation-defined pragmas are lumped together in ASIS as a single
element kind (for example, the GNAT-specific pragma Unreferenced is
represented by an implementation_defined_pragma element with
pragma_name=&#8221;Unreferenced&#8221;).</li>
</ul>
<p>Defining occurrences of formal parameters and generic formal objects have this
attribute:</p>
<ul class="simple">
<li>mode indicates that the parameter is of mode &#8216;in&#8217;, &#8216;in out&#8217;, or &#8216;out&#8217;.</li>
</ul>
<p>All elements other than Not_An_Element have this attribute:</p>
<ul class="simple">
<li>checks is a comma-separated list of run-time checks that are needed
for that element. The possible checks are: do_accessibility_check,
do_discriminant_check,do_division_check,do_length_check,
do_overflow_check,do_range_check,do_storage_check,do_tag_check.</li>
</ul>
<p>The &#8220;kind&#8221; part of the &#8220;def&#8221; and &#8220;ref&#8221; attributes is taken from the ASIS
enumeration type Flat_Declaration_Kinds, declared in
Asis.Extensions.Flat_Kinds, with the leading <code class="docutils literal"><span class="pre">An_</span></code> or <code class="docutils literal"><span class="pre">A_</span></code> removed, and
any trailing <code class="docutils literal"><span class="pre">_Declaration</span></code> or <code class="docutils literal"><span class="pre">_Specification</span></code> removed. Thus, the
possible kinds are as follows:</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">ordinary_type</span>
<span class="n">task_type</span>
<span class="n">protected_type</span>
<span class="n">incomplete_type</span>
<span class="n">tagged_incomplete_type</span>
<span class="n">private_type</span>
<span class="n">private_extension</span>
<span class="n">subtype</span>
<span class="n">variable</span>
<span class="n">constant</span>
<span class="n">deferred_constant</span>
<span class="n">single_task</span>
<span class="n">single_protected</span>
<span class="n">integer_number</span>
<span class="n">real_number</span>
<span class="n">enumeration_literal</span>
<span class="n">discriminant</span>
<span class="n">component</span>
<span class="n">loop_parameter</span>
<span class="n">generalized_iterator</span>
<span class="n">element_iterator</span>
<span class="n">procedure</span>
<span class="n">function</span>
<span class="n">parameter</span>
<span class="n">procedure_body</span>
<span class="n">function_body</span>
<span class="n">return_variable</span>
<span class="n">return_constant</span>
<span class="n">null_procedure</span>
<span class="n">expression_function</span>
<span class="n">package</span>
<span class="n">package_body</span>
<span class="n">object_renaming</span>
<span class="n">exception_renaming</span>
<span class="n">package_renaming</span>
<span class="n">procedure_renaming</span>
<span class="n">function_renaming</span>
<span class="n">generic_package_renaming</span>
<span class="n">generic_procedure_renaming</span>
<span class="n">generic_function_renaming</span>
<span class="n">task_body</span>
<span class="n">protected_body</span>
<span class="n">entry</span>
<span class="n">entry_body</span>
<span class="n">entry_index</span>
<span class="n">procedure_body_stub</span>
<span class="n">function_body_stub</span>
<span class="n">package_body_stub</span>
<span class="n">task_body_stub</span>
<span class="n">protected_body_stub</span>
<span class="n">exception</span>
<span class="n">choice_parameter</span>
<span class="n">generic_procedure</span>
<span class="n">generic_function</span>
<span class="n">generic_package</span>
<span class="n">package_instantiation</span>
<span class="n">procedure_instantiation</span>
<span class="n">function_instantiation</span>
<span class="n">formal_object</span>
<span class="n">formal_type</span>
<span class="n">formal_incomplete_type</span>
<span class="n">formal_procedure</span>
<span class="n">formal_function</span>
<span class="n">formal_package</span>
<span class="n">formal_package_declaration_with_box</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="generating-representation-clauses">
<span id="id23"></span><h3>5.5.4. Generating Representation Clauses<a class="headerlink" href="#generating-representation-clauses" title="Permalink to this headline">¶</a></h3>
<p>If the <code class="switch docutils literal"><span class="pre">--rep-clauses</span></code> switch is given, <code class="docutils literal"><span class="pre">gnat2xml</span></code> will
generate representation clauses for certain types showing the
representation chosen by the compiler. The information is produced by
the ASIS &#8216;Data Decomposition&#8217; facility &#8212; see the
<code class="docutils literal"><span class="pre">Asis.Data_Decomposition</span></code> package for details.</p>
<p>Not all types are supported. For example, <code class="docutils literal"><span class="pre">Type_Model_Kind</span></code> must
be <code class="docutils literal"><span class="pre">A_Simple_Static_Model</span></code>. Types declared within generic units
have no representation. The clauses that are generated include
<code class="docutils literal"><span class="pre">attribute_definition_clauses</span></code> for <code class="docutils literal"><span class="pre">Size</span></code> and
<code class="docutils literal"><span class="pre">Component_Size</span></code>, as well as
<code class="docutils literal"><span class="pre">record_representation_clauses</span></code>.</p>
<p>There is no guarantee that the generated representation clauses could
have actually come from legal Ada code; Ada has some restrictions that
are not necessarily obeyed by the generated clauses.</p>
<p>The representation clauses are surrounded by comment elements to
indicate that they are automatically generated, something like this:</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">comment</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;--gen+&quot;</span><span class="o">&gt;</span>
<span class="o">...</span>
<span class="o">&lt;</span><span class="n">attribute_definition_clause</span><span class="o">&gt;</span>
<span class="o">...</span>
<span class="o">&lt;</span><span class="n">comment</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;--gen-&quot;</span><span class="o">&gt;</span>
<span class="o">...</span>
</pre></div>
</div>
</div></blockquote>
</div>
</div>
<div class="section" id="the-coding-standard-verifier-gnatcheck">
<span id="id24"></span><h2>5.6. The Coding Standard Verifier <code class="docutils literal"><span class="pre">gnatcheck</span></code><a class="headerlink" href="#the-coding-standard-verifier-gnatcheck" title="Permalink to this headline">¶</a></h2>
<span class="target" id="index-86"></span><p id="index-87">The <code class="docutils literal"><span class="pre">gnatcheck</span></code> tool is an ASIS-based utility that checks coding standard
compliance of Ada source files according to a given set of semantic rules.</p>
<p><code class="docutils literal"><span class="pre">gnatcheck</span></code> is a project-aware tool
(see <a class="reference internal" href="#using-project-files-with-gnat-tools"><span class="std std-ref">Using Project Files with GNAT Tools</span></a> for a description of
the project-related switches). The project file package that can specify
<code class="docutils literal"><span class="pre">gnatcheck</span></code> switches is named <code class="docutils literal"><span class="pre">Check</span></code>.</p>
<p>For full details, plese refer to <cite>GNATcheck Reference Manual</cite>.</p>
</div>
<div class="section" id="the-gnat-metrics-tool-gnatmetric">
<span id="id25"></span><h2>5.7. The GNAT Metrics Tool <code class="docutils literal"><span class="pre">gnatmetric</span></code><a class="headerlink" href="#the-gnat-metrics-tool-gnatmetric" title="Permalink to this headline">¶</a></h2>
<span class="target" id="index-88"></span><p id="index-89">This documentation is for the new libadalang-based version
of <code class="docutils literal"><span class="pre">gnatmetric</span></code>, which replaces the ASIS-based version.</p>
<p>The <code class="docutils literal"><span class="pre">gnatmetric</span></code> tool is a utility
for computing various program metrics.
It takes an Ada source file as input and generates a file containing the
metrics data as output. Various switches control which
metrics are reported.</p>
<p><code class="docutils literal"><span class="pre">gnatmetric</span></code> is a project-aware tool
(see <a class="reference internal" href="#using-project-files-with-gnat-tools"><span class="std std-ref">Using Project Files with GNAT Tools</span></a> for a description of
the project-related switches). The project file package that can specify
<code class="docutils literal"><span class="pre">gnatmetric</span></code> switches is named <code class="docutils literal"><span class="pre">Metrics</span></code>.</p>
<p>The <code class="docutils literal"><span class="pre">gnatmetric</span></code> command has the form</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span>$ gnatmetric [ switches ] { filename }
</pre></div>
</div>
</div></blockquote>
<p>where:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">switches</span></code> specify the metrics to compute and define the destination for
the output</li>
<li>Each <code class="docutils literal"><span class="pre">filename</span></code> is the name (including the extension) of a source
file to process. &#8216;Wildcards&#8217; are allowed, and
the file name may contain path information.
If no <code class="docutils literal"><span class="pre">filename</span></code> is supplied, then the <code class="docutils literal"><span class="pre">switches</span></code> list must contain
at least one
<code class="switch docutils literal"><span class="pre">--files</span></code> switch (see <a class="reference internal" href="#other-gnatmetric-switches"><span class="std std-ref">Other gnatmetric Switches</span></a>).
Including both a <code class="switch docutils literal"><span class="pre">--files</span></code> switch and one or more
<code class="docutils literal"><span class="pre">filename</span></code> arguments is permitted.</li>
</ul>
<p>The following subsections describe the various switches accepted by
<code class="docutils literal"><span class="pre">gnatmetric</span></code>, organized by category.</p>
<div class="section" id="output-file-control">
<span id="output-file-control-gnatmetric"></span><h3>5.7.1. Output File Control<a class="headerlink" href="#output-file-control" title="Permalink to this headline">¶</a></h3>
<p id="index-90"><code class="docutils literal"><span class="pre">gnatmetric</span></code> has two output formats. It can generate a
textual (human-readable) form, and also XML. By default only textual
output is generated.</p>
<p>When generating the output in textual form, <code class="docutils literal"><span class="pre">gnatmetric</span></code> creates
for each Ada source file a corresponding text file
containing the computed metrics, except for the case when the set of metrics
specified by gnatmetric parameters consists only of metrics that are computed
for the whole set of analyzed sources, but not for each Ada source.
By default, the name of the file containing metric information for a source
is obtained by appending the <code class="file docutils literal"><span class="pre">.metrix</span></code> suffix to the
name of the input source file. If not otherwise specified and no project file
is specified as <code class="docutils literal"><span class="pre">gnatmetric</span></code> option this file is placed in the same
directory as where the source file is located. If <code class="docutils literal"><span class="pre">gnatmetric</span></code> has a
project  file as its parameter, it places all the generated files in the
object directory of the project (or in the project source directory if the
project does not define an object directory). If <code class="switch docutils literal"><span class="pre">--subdirs</span></code> option
is specified, the files are placed in the subrirectory of this directory
specified by this option.</p>
<p>All the output information generated in XML format is placed in a single
file. By default the name of this file is <code class="file docutils literal"><span class="pre">metrix.xml</span></code>.
If not otherwise specified and if no project file is specified
as <code class="docutils literal"><span class="pre">gnatmetric</span></code> option this file is placed in the
current directory.</p>
<p>Some of the computed metrics are summed over the units passed to
<code class="docutils literal"><span class="pre">gnatmetric</span></code>; for example, the total number of lines of code.
By default this information is sent to <code class="file docutils literal"><span class="pre">stdout</span></code>, but a file
can be specified with the <code class="switch docutils literal"><span class="pre">--global-file-name</span></code> switch.</p>
<p>The following switches control the <code class="docutils literal"><span class="pre">gnatmetric</span></code> output:</p>
<dl class="docutils" id="index-91">
<dt><code class="switch docutils literal"><span class="pre">--generate-xml-output</span></code></dt>
<dd>Generate XML output.</dd>
</dl>
<dl class="docutils" id="index-92">
<dt><code class="switch docutils literal"><span class="pre">--generate-xml-schema</span></code></dt>
<dd>Generate XML output and an XML schema file that describes the structure
of the XML metric report. This schema is assigned to the XML file. The schema
file has the same name as the XML output file with <code class="file docutils literal"><span class="pre">.xml</span></code> suffix replaced
with <code class="file docutils literal"><span class="pre">.xsd</span></code>.</dd>
</dl>
<dl class="docutils" id="index-93">
<dt><code class="switch docutils literal"><span class="pre">--no-text-output</span></code></dt>
<dd>Do not generate the output in text form (implies <code class="switch docutils literal"><span class="pre">-x</span></code>).</dd>
</dl>
<dl class="docutils" id="index-94">
<dt><code class="switch docutils literal"><span class="pre">--output-dir=</span><em><span class="pre">output_dir</span></em></code></dt>
<dd>Put text files with detailed metrics into <code class="docutils literal"><span class="pre">output_dir</span></code>.</dd>
</dl>
<dl class="docutils" id="index-95">
<dt><code class="switch docutils literal"><span class="pre">--output-suffix=</span><em><span class="pre">file_suffix</span></em></code></dt>
<dd>Use <code class="docutils literal"><span class="pre">file_suffix</span></code>, instead of <code class="file docutils literal"><span class="pre">.metrix</span></code>
in the name of the output file.</dd>
</dl>
<dl class="docutils" id="index-96">
<dt><code class="switch docutils literal"><span class="pre">--global-file-name=</span><em><span class="pre">file_name</span></em></code></dt>
<dd>Put global metrics into <code class="docutils literal"><span class="pre">file_name</span></code>.</dd>
</dl>
<dl class="docutils" id="index-97">
<dt><code class="switch docutils literal"><span class="pre">--xml-file-name=</span><em><span class="pre">file_name</span></em></code></dt>
<dd>Put the XML output into <code class="docutils literal"><span class="pre">file_name</span></code>
(also implies <code class="switch docutils literal"><span class="pre">--generate-xml-output</span></code>).</dd>
</dl>
<dl class="docutils" id="index-98">
<dt><code class="switch docutils literal"><span class="pre">--short-file-names</span></code></dt>
<dd>Use &#8216;short&#8217; source file names in the output. (The <code class="docutils literal"><span class="pre">gnatmetric</span></code>
output includes the name(s) of the Ada source file(s) from which the
metrics are computed. By default each name includes the absolute
path. The <code class="switch docutils literal"><span class="pre">--short-file-names</span></code> switch causes <code class="docutils literal"><span class="pre">gnatmetric</span></code>
to exclude all directory information from the file names that are
output.)</dd>
</dl>
</div>
<div class="section" id="disable-metrics-for-local-units">
<span id="index-99"></span><span id="id26"></span><h3>5.7.2. Disable Metrics For Local Units<a class="headerlink" href="#disable-metrics-for-local-units" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal"><span class="pre">gnatmetric</span></code> relies on the GNAT compilation model &#8211;
one compilation
unit per one source file. It computes line metrics for the whole source
file, and it also computes syntax
and complexity metrics for the file&#8217;s outermost unit.</p>
<p>By default, <code class="docutils literal"><span class="pre">gnatmetric</span></code> will also compute all metrics for certain
kinds of locally declared program units:</p>
<ul class="simple">
<li>subprogram (and generic subprogram) bodies;</li>
<li>package (and generic package) specs and bodies;</li>
<li>task object and type specifications and bodies;</li>
<li>protected object and type specifications and bodies.</li>
</ul>
<p id="index-100">These kinds of entities will be referred to as
<em>eligible local program units</em>, or simply <em>eligible local units</em>,
in the discussion below.</p>
<p>Note that a subprogram declaration, generic instantiation,
or renaming declaration only receives metrics
computation when it appear as the outermost entity
in a source file.</p>
<p>Suppression of metrics computation for eligible local units can be
obtained via the following switch:</p>
<dl class="docutils" id="index-101">
<dt><code class="switch docutils literal"><span class="pre">--no-local-metrics</span></code></dt>
<dd>Do not compute detailed metrics for eligible local program units.</dd>
</dl>
</div>
<div class="section" id="specifying-a-set-of-metrics-to-compute">
<span id="id27"></span><h3>5.7.3. Specifying a set of metrics to compute<a class="headerlink" href="#specifying-a-set-of-metrics-to-compute" title="Permalink to this headline">¶</a></h3>
<p>By default all the metrics are reported. The switches described in this
subsection allow you to control, on an individual basis, whether metrics are
reported. If at least one positive metric switch is specified (that is, a
switch that defines that a given metric or set of metrics is to be computed),
then only explicitly specified metrics are reported.</p>
<div class="section" id="line-metrics-control">
<span id="id28"></span><h4>5.7.3.1. Line Metrics Control<a class="headerlink" href="#line-metrics-control" title="Permalink to this headline">¶</a></h4>
<p id="index-102">For each source file, and for each of its eligible local program
units, <code class="docutils literal"><span class="pre">gnatmetric</span></code> computes the following metrics:</p>
<ul class="simple">
<li>the total number of lines;</li>
<li>the total number of code lines (i.e., non-blank lines that are not
comments)</li>
<li>the number of comment lines</li>
<li>the number of code lines containing end-of-line comments;</li>
<li>the comment percentage: the ratio between the number of lines that
contain comments and the number of all non-blank lines, expressed as
a percentage</li>
<li>the number of empty lines and lines containing only space characters
and/or format effectors (blank lines)</li>
<li>the average number of code lines in subprogram bodies, task bodies,
entry bodies and statement sequences in package bodies (this metric
is only computed across the whole set of the analyzed units)</li>
</ul>
<p><code class="docutils literal"><span class="pre">gnatmetric</span></code> sums the values of the line metrics for all the files
being processed and then generates the cumulative results. The tool
also computes for all the files being processed the average number of
code lines in bodies.</p>
<p>You can use the following switches to select the specific line metrics
to be reported.</p>
<span class="target" id="index-103"></span><dl class="docutils" id="index-104">
<dt><code class="switch docutils literal"><span class="pre">--lines-all</span></code></dt>
<dd>Report all the line metrics</dd>
<dt><code class="switch docutils literal"><span class="pre">--no-lines-all</span></code></dt>
<dd>Do not report any of line metrics</dd>
<dt><code class="switch docutils literal"><span class="pre">--lines</span></code></dt>
<dd>Report the number of all lines</dd>
<dt><code class="switch docutils literal"><span class="pre">--no-lines</span></code></dt>
<dd>Do not report the number of all lines</dd>
<dt><code class="switch docutils literal"><span class="pre">--lines-code</span></code></dt>
<dd>Report the number of code lines</dd>
<dt><code class="switch docutils literal"><span class="pre">--no-lines-code</span></code></dt>
<dd>Do not report the number of code lines</dd>
<dt><code class="switch docutils literal"><span class="pre">--lines-comment</span></code></dt>
<dd>Report the number of comment lines</dd>
<dt><code class="switch docutils literal"><span class="pre">--no-lines-comment</span></code></dt>
<dd>Do not report the number of comment lines</dd>
<dt><code class="switch docutils literal"><span class="pre">--lines-eol-comment</span></code></dt>
<dd>Report the number of code lines containing
end-of-line comments</dd>
<dt><code class="switch docutils literal"><span class="pre">--no-lines-eol-comment</span></code></dt>
<dd>Do not report the number of code lines containing
end-of-line comments</dd>
<dt><code class="switch docutils literal"><span class="pre">--lines-ratio</span></code></dt>
<dd>Report the comment percentage in the program text</dd>
<dt><code class="switch docutils literal"><span class="pre">--no-lines-ratio</span></code></dt>
<dd>Do not report the comment percentage in the program text</dd>
<dt><code class="switch docutils literal"><span class="pre">--lines-blank</span></code></dt>
<dd>Report the number of blank lines</dd>
<dt><code class="switch docutils literal"><span class="pre">--no-lines-blank</span></code></dt>
<dd>Do not report the number of blank lines</dd>
<dt><code class="switch docutils literal"><span class="pre">--lines-average</span></code></dt>
<dd>Report the average number of code lines in subprogram bodies, task bodies,
entry bodies and statement sequences in package bodies. The metric is
reported for the whole set of processed Ada sources only.</dd>
<dt><code class="switch docutils literal"><span class="pre">--no-lines-average</span></code></dt>
<dd>Do not report the average number of code lines in subprogram bodies,
task bodies, entry bodies and statement sequences in package bodies.</dd>
</dl>
</div>
<div class="section" id="syntax-metrics-control">
<span id="id29"></span><h4>5.7.3.2. Syntax Metrics Control<a class="headerlink" href="#syntax-metrics-control" title="Permalink to this headline">¶</a></h4>
<p id="index-105"><code class="docutils literal"><span class="pre">gnatmetric</span></code> computes various syntactic metrics for the
outermost unit and for each eligible local unit:</p>
<ul>
<li><dl class="first docutils">
<dt><em>LSLOC (&#8216;Logical Source Lines Of Code&#8217;)</em></dt>
<dd><p class="first">The total number of declarations and the total number of
statements. Note that the definition of declarations is the one
given in the reference manual:</p>
<blockquote>
<div><p>&#8220;Each of the following is defined to be a declaration: any
basic_declaration; an enumeration_literal_specification; a
discriminant_specification; a component_declaration; a
loop_parameter_specification; a parameter_specification; a
subprogram_body; an entry_declaration; an
entry_index_specification; a choice_parameter_specification; a
generic_formal_parameter_declaration.&#8221;</p>
</div></blockquote>
<p class="last">This means for example that each enumeration literal adds one to
the count, as well as each subprogram parameter.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><em>Maximal static nesting level of inner program units</em></dt>
<dd><p class="first">According to <cite>Ada Reference Manual</cite>, 10.1(1):</p>
<blockquote class="last">
<div><p>&#8220;A program unit is either a package, a task unit, a protected
unit, a protected entry, a generic unit, or an explicitly
declared subprogram other than an enumeration literal.&#8221;</p>
</div></blockquote>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><em>Maximal nesting level of composite syntactic constructs</em></dt>
<dd><p class="first last">This corresponds to the notion of the maximum nesting level in the
GNAT built-in style checks (see <a class="reference internal" href="building_executable_programs_with_gnat.html#style-checking"><span class="std std-ref">Style Checking</span></a>).</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><em>Number of formal parameters</em></dt>
<dd><p class="first last">Number of formal parameters of a subprogram; if a subprogram does
have parameters, then numbers of &#8220;in&#8221;, &#8220;out&#8221; and &#8220;in out&#8221;
parameters are also reported. This metric is reported for
subprogram specifications and for subprogram instantiations. For
subprogram bodies, expression functions and null procedures this
metric is reported if the construct acts as a subprogram
declaration but is not a completion of previous declaration. This
metric is not reported for generic and formal subprograms.</p>
</dd>
</dl>
</li>
</ul>
<p>For the outermost unit in the file, <code class="docutils literal"><span class="pre">gnatmetric</span></code> additionally
computes the following metrics:</p>
<ul>
<li><dl class="first docutils">
<dt><em>Public subprograms</em></dt>
<dd><p class="first last">This metric is computed for package specs. It is the number of
subprograms and generic subprograms declared in the visible part
(including the visible part of nested packages, protected objects,
and protected types).</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><em>All subprograms</em></dt>
<dd><p class="first last">This metric is computed for bodies and subunits. The metric is
equal to a total number of subprogram bodies in the compilation
unit.
Neither generic instantiations nor renamings-as-a-body nor body
stubs are counted. Any subprogram body is counted, independently
of its nesting level and enclosing constructs. Generic bodies and
bodies of protected subprograms are counted in the same way as
&#8216;usual&#8217; subprogram bodies.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><em>Public types</em></dt>
<dd><p class="first">This metric is computed for package specs and generic package
declarations. It is the total number of types that can be
referenced from outside this compilation unit, plus the number of
types from all the visible parts of all the visible generic
packages. Generic formal types are not counted. Only types, not
subtypes, are included.</p>
<p>Along with the total number of public types, the following
types are counted and reported separately:</p>
<ul class="last simple">
<li><em>Abstract types</em></li>
<li><em>Root tagged types^ (abstract, non-abstract, private,
non-private). Type extensions are *not</em> counted</li>
<li><em>Private types</em> (including private extensions)</li>
<li><em>Task types</em></li>
<li><em>Protected types</em></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><em>All types</em></dt>
<dd><p class="first last">This metric is computed for any compilation unit. It is equal to
the total number of the declarations of different types given in
the compilation unit. The private and the corresponding full type
declaration are counted as one type declaration. Incomplete type
declarations and generic formal types are not counted.
No distinction is made among different kinds of types (abstract,
private etc.); the total number of types is reported.</p>
</dd>
</dl>
</li>
</ul>
<p>By default, all the syntax metrics are reported. You can use the following
switches to select specific syntax metrics.</p>
<span class="target" id="index-106"></span><dl class="docutils" id="index-107">
<dt><code class="switch docutils literal"><span class="pre">--syntax-all</span></code></dt>
<dd>Report all the syntax metrics</dd>
<dt><code class="switch docutils literal"><span class="pre">--no-syntax-all</span></code></dt>
<dd>Do not report any of syntax metrics</dd>
<dt><code class="switch docutils literal"><span class="pre">--declarations</span></code></dt>
<dd>Report the total number of declarations</dd>
<dt><code class="switch docutils literal"><span class="pre">--no-declarations</span></code></dt>
<dd>Do not report the total number of declarations</dd>
<dt><code class="switch docutils literal"><span class="pre">--statements</span></code></dt>
<dd>Report the total number of statements</dd>
<dt><code class="switch docutils literal"><span class="pre">--no-statements</span></code></dt>
<dd>Do not report the total number of statements</dd>
<dt><code class="switch docutils literal"><span class="pre">--public-subprograms</span></code></dt>
<dd>Report the number of public subprograms in a compilation unit</dd>
<dt><code class="switch docutils literal"><span class="pre">--no-public-subprograms</span></code></dt>
<dd>Do not report the number of public subprograms in a compilation unit</dd>
<dt><code class="switch docutils literal"><span class="pre">--all-subprograms</span></code></dt>
<dd>Report the number of all the subprograms in a compilation unit</dd>
<dt><code class="switch docutils literal"><span class="pre">--no-all-subprograms</span></code></dt>
<dd>Do not report the number of all the subprograms in a compilation unit</dd>
<dt><code class="switch docutils literal"><span class="pre">--public-types</span></code></dt>
<dd>Report the number of public types in a compilation unit</dd>
<dt><code class="switch docutils literal"><span class="pre">--no-public-types</span></code></dt>
<dd>Do not report the number of public types in a compilation unit</dd>
<dt><code class="switch docutils literal"><span class="pre">--all-types</span></code></dt>
<dd>Report the number of all the types in a compilation unit</dd>
<dt><code class="switch docutils literal"><span class="pre">--no-all-types</span></code></dt>
<dd>Do not report the number of all the types in a compilation unit</dd>
<dt><code class="switch docutils literal"><span class="pre">--unit-nesting</span></code></dt>
<dd>Report the maximal program unit nesting level</dd>
<dt><code class="switch docutils literal"><span class="pre">--no-unit-nesting</span></code></dt>
<dd>Do not report the maximal program unit nesting level</dd>
<dt><code class="switch docutils literal"><span class="pre">--construct-nesting</span></code></dt>
<dd>Report the maximal construct nesting level</dd>
<dt><code class="switch docutils literal"><span class="pre">--no-construct-nesting</span></code></dt>
<dd>Do not report the maximal construct nesting level</dd>
<dt><code class="switch docutils literal"><span class="pre">--param-number</span></code></dt>
<dd>Report the number of subprogram parameters</dd>
<dt><code class="switch docutils literal"><span class="pre">--no-param-number</span></code></dt>
<dd>Do not report the number of subprogram parameters</dd>
</dl>
</div>
<div class="section" id="complexity-metrics-control">
<span id="id30"></span><h4>5.7.3.3. Complexity Metrics Control<a class="headerlink" href="#complexity-metrics-control" title="Permalink to this headline">¶</a></h4>
<p id="index-108">For a program unit that is an executable body (a subprogram body
(including generic bodies), task body, entry body or a package body
containing its own statement sequence) <code class="docutils literal"><span class="pre">gnatmetric</span></code> computes the
following complexity metrics:</p>
<ul class="simple">
<li>McCabe cyclomatic complexity;</li>
<li>McCabe essential complexity;</li>
<li>maximal loop nesting level;</li>
<li>extra exit points (for subprograms);</li>
</ul>
<p>The McCabe cyclomatic complexity metric is defined
in <a class="reference external" href="http://www.mccabe.com/pdf/mccabe-nist235r.pdf">http://www.mccabe.com/pdf/mccabe-nist235r.pdf</a></p>
<p>According to McCabe, both control statements and short-circuit control
forms should be taken into account when computing cyclomatic
complexity. For Ada 2012 we have also take into account conditional
expressions and quantified expressions. For each body, we compute
three metric values:</p>
<ul class="simple">
<li>the complexity introduced by control
statements only, without taking into account short-circuit forms
(referred as <code class="docutils literal"><span class="pre">statement</span> <span class="pre">complexity</span></code> in <code class="docutils literal"><span class="pre">gnatmetric</span></code> output),</li>
<li>the complexity introduced by short-circuit control forms only
(referred as <code class="docutils literal"><span class="pre">expression</span> <span class="pre">complexity</span></code> in <code class="docutils literal"><span class="pre">gnatmetric</span></code> output),
and</li>
<li>the total
cyclomatic complexity, which is the sum of these two values
(referred as <code class="docutils literal"><span class="pre">cyclomatic</span> <span class="pre">complexity</span></code> in <code class="docutils literal"><span class="pre">gnatmetric</span></code> output).</li>
</ul>
<p>The cyclomatic complexity is also computed for Ada 2012 expression functions.
An expression function cannot have statements as its components, so only one
metric value is computed as a cyclomatic complexity of an expression function.</p>
<p>The origin of cyclomatic complexity metric is the need to estimate the number
of independent paths in the control flow graph that in turn gives the number
of tests needed to satisfy paths coverage testing completeness criterion.
Considered from the testing point of view, a static Ada <code class="docutils literal"><span class="pre">loop</span></code> (that is,
the <code class="docutils literal"><span class="pre">loop</span></code> statement having static subtype in loop parameter
specification) does not add to cyclomatic complexity. By providing
<code class="switch docutils literal"><span class="pre">--no-static-loop</span></code> option a user
may specify that such loops should not be counted when computing the
cyclomatic complexity metric</p>
<p>The Ada essential complexity metric is a McCabe cyclomatic complexity metric
counted for the code that is reduced by excluding all the pure structural Ada
control statements. An compound statement is considered as a non-structural
if it contains a <code class="docutils literal"><span class="pre">raise</span></code> or <code class="docutils literal"><span class="pre">return</span></code> statement as it subcomponent,
or if it contains a <code class="docutils literal"><span class="pre">goto</span></code> statement that transfers the control outside
the operator. A selective <code class="docutils literal"><span class="pre">accept</span></code> statement with a <code class="docutils literal"><span class="pre">terminate</span></code> alternative
is considered a non-structural statement. When computing this metric,
<code class="docutils literal"><span class="pre">exit</span></code> statements are treated in the same way as <code class="docutils literal"><span class="pre">goto</span></code>
statements unless the <code class="switch docutils literal"><span class="pre">-ne</span></code> option is specified.</p>
<p>The Ada essential complexity metric defined here is intended to quantify
the extent to which the software is unstructured. It is adapted from
the McCabe essential complexity metric defined in
<a class="reference external" href="http://www.mccabe.com/pdf/mccabe-nist235r.pdf">http://www.mccabe.com/pdf/mccabe-nist235r.pdf</a>
but is modified to be more
suitable for typical Ada usage. For example, short circuit forms
are not penalized as unstructured in the Ada essential complexity metric.</p>
<p>When computing cyclomatic and essential complexity, <code class="docutils literal"><span class="pre">gnatmetric</span></code> skips
the code in the exception handlers and in all the nested program units. The
code of assertions and predicates (that is, subprogram preconditions and
postconditions, subtype predicates and type invariants) is also skipped.</p>
<p>By default, all the complexity metrics are reported. For more fine-grained
control you can use the following switches:</p>
<span class="target" id="index-109"></span><dl class="docutils" id="index-110">
<dt><code class="switch docutils literal"><span class="pre">--complexity-all</span></code></dt>
<dd>Report all the complexity metrics</dd>
<dt><code class="switch docutils literal"><span class="pre">--no-complexity-all</span></code></dt>
<dd>Do not report any of complexity metrics</dd>
<dt><code class="switch docutils literal"><span class="pre">--complexity-cyclomatic</span></code></dt>
<dd>Report the McCabe Cyclomatic Complexity</dd>
<dt><code class="switch docutils literal"><span class="pre">--no-complexity-cyclomatic</span></code></dt>
<dd>Do not report the McCabe Cyclomatic Complexity</dd>
<dt><code class="switch docutils literal"><span class="pre">--complexity-essential</span></code></dt>
<dd>Report the Essential Complexity</dd>
<dt><code class="switch docutils literal"><span class="pre">--no-complexity-essential</span></code></dt>
<dd>Do not report the Essential Complexity</dd>
<dt><code class="switch docutils literal"><span class="pre">--loop-nesting</span></code></dt>
<dd>Report maximal loop nesting level</dd>
<dt><code class="switch docutils literal"><span class="pre">-no-loop-nesting</span></code></dt>
<dd>Do not report maximal loop nesting level</dd>
<dt><code class="switch docutils literal"><span class="pre">--complexity-average</span></code></dt>
<dd>Report the average McCabe Cyclomatic Complexity for all the subprogram bodies,
task bodies, entry bodies and statement sequences in package bodies.
The metric is reported for whole set of processed Ada sources only.</dd>
<dt><code class="switch docutils literal"><span class="pre">--no-complexity-average</span></code></dt>
<dd>Do not report the average McCabe Cyclomatic Complexity for all the subprogram
bodies, task bodies, entry bodies and statement sequences in package bodies</dd>
</dl>
<dl class="docutils" id="index-111">
<dt><code class="switch docutils literal"><span class="pre">--no-treat-exit-as-goto</span></code></dt>
<dd>Do not consider <code class="docutils literal"><span class="pre">exit</span></code> statements as <code class="docutils literal"><span class="pre">goto</span></code>s when
computing Essential Complexity</dd>
</dl>
<dl class="docutils" id="index-112">
<dt><code class="switch docutils literal"><span class="pre">--no-static-loop</span></code></dt>
<dd>Do not consider static loops when computing cyclomatic complexity</dd>
<dt><code class="switch docutils literal"><span class="pre">--extra-exit-points</span></code></dt>
<dd>Report the extra exit points for subprogram bodies. As an exit point, this
metric counts <code class="docutils literal"><span class="pre">return</span></code> statements and raise statements in case when the
raised exception is not handled in the same body. In case of a function this
metric subtracts 1 from the number of exit points, because a function body
must contain at least one <code class="docutils literal"><span class="pre">return</span></code> statement.</dd>
<dt><code class="switch docutils literal"><span class="pre">--no-extra-exit-points</span></code></dt>
<dd>Do not report the extra exit points for subprogram bodies</dd>
</dl>
</div>
<div class="section" id="coupling-metrics-control">
<span id="id31"></span><h4>5.7.3.4. Coupling Metrics Control<a class="headerlink" href="#coupling-metrics-control" title="Permalink to this headline">¶</a></h4>
<span class="target" id="index-113"></span><p id="index-114">Coupling metrics measure the dependencies between a given entity and other
entities in the program. This information is useful since high coupling
may signal potential issues with maintainability as the program evolves.</p>
<p><code class="docutils literal"><span class="pre">gnatmetric</span></code> computes the following coupling metrics:</p>
<ul class="simple">
<li><em>object-oriented coupling</em>, for classes in traditional object-oriented
sense;</li>
<li><em>unit coupling</em>, for all the program units making up a program;</li>
<li><em>control coupling</em>, reflecting dependencies between a unit and
other units that contain subprograms.</li>
</ul>
<span class="target" id="index-115"></span><p id="index-116">Two kinds of coupling metrics are computed:</p>
<ul class="simple">
<li>fan-out coupling (&#8216;efferent coupling&#8217;):
the number of entities the given entity depends upon. This metric
reflects how the given entity depends on the changes in the
&#8216;external world&#8217;.</li>
</ul>
<span class="target" id="index-117"></span><ul class="simple" id="index-118">
<li>fan-in coupling (&#8216;afferent&#8217; coupling):
the number of entities that depend on a given entity.
This metric reflects how the &#8216;external world&#8217; depends on the changes in a
given entity.</li>
</ul>
<p>Object-oriented coupling metrics measure the dependencies
between a given class (or a group of classes) and the other classes in the
program. In this subsection the term &#8216;class&#8217; is used in its traditional
object-oriented programming sense (an instantiable module that contains data
and/or method members). A <em>category</em> (of classes) is a group of closely
related classes that are reused and/or modified together.</p>
<p>A class <code class="docutils literal"><span class="pre">K</span></code>&#8216;s fan-out coupling is the number of classes
that <code class="docutils literal"><span class="pre">K</span></code> depends upon.
A category&#8217;s fan-out coupling is the number of classes outside the
category that the classes inside the category depend upon.</p>
<p>A class <code class="docutils literal"><span class="pre">K</span></code>&#8216;s fan-in coupling is the number of classes
that depend upon <code class="docutils literal"><span class="pre">K</span></code>.
A category&#8217;s fan-in coupling is the number of classes outside the
category that depend on classes belonging to the category.</p>
<p>Ada&#8217;s object-oriented paradigm separates the instantiable entity
(type) from the module (package), so the definition of the coupling
metrics for Ada maps the class and class category notions
onto Ada constructs.</p>
<p>For the coupling metrics, several kinds of modules that define a tagged type
or an interface type  &#8211; library packages, library generic packages, and
library generic package instantiations &#8211; are considered to be classes.
A category consists of a library package (or
a library generic package) that defines a tagged or an interface type,
together with all its descendant (generic) packages that define tagged
or interface types. Thus a
category is an Ada hierarchy of library-level program units. Class
coupling in Ada is referred to as &#8216;tagged coupling&#8217;, and category coupling
is referred to as &#8216;hierarchy coupling&#8217;.</p>
<p>For any package serving as a class, its body and subunits (if any) are
considered together with its spec when computing dependencies, and coupling
metrics are reported for spec units only. Dependencies between classes
mean Ada semantic dependencies. For object-oriented coupling
metrics, only dependencies on units treated as classes are
considered.</p>
<p>Similarly, for unit and control coupling an entity is considered to be the
conceptual construct consisting of the entity&#8217;s specification, body, and
any subunits (transitively).
<code class="docutils literal"><span class="pre">gnatmetric</span></code> computes
the dependencies of all these units as a whole, but
metrics are only reported for spec
units (or for a subprogram body unit in case if there is no
separate spec for the given subprogram).</p>
<p>For unit coupling, dependencies are computed between all kinds of program
units. For control coupling, the dependencies of a given unit are limited to
those units that define subprograms. Thus control fan-out coupling is reported
for all units, but control fan-in coupling is only reported for units
that define subprograms.</p>
<p>The following simple example illustrates the difference between unit coupling
and control coupling metrics:</p>
<blockquote>
<div><div class="highlight-ada"><div class="highlight"><pre><span></span><span class="k">package </span><span class="nf">Lib_1</span> <span class="kr">is</span><span class="p"></span>
    <span class="k">function </span><span class="nf">F_1</span> <span class="o">(</span><span class="n">I</span> <span class="o">:</span> <span class="n">Integer</span><span class="o">)</span> <span class="kr">return</span><span class="p"> </span><span class="n">Integer</span><span class="p">;</span>
<span class="k">end </span><span class="nf">Lib_1</span><span class="p">;</span>

<span class="k">package </span><span class="nf">Lib_2</span> <span class="kr">is</span><span class="p"></span>
    <span class="kr">type</span><span class="p"> </span><span class="n">T_2</span> <span class="kr">is</span><span class="p"> </span><span class="kr">new</span><span class="p"> </span><span class="n">Integer</span><span class="p">;</span>
<span class="k">end </span><span class="nf">Lib_2</span><span class="p">;</span>

<span class="k">package body </span><span class="nf">Lib_1</span> <span class="kr">is</span><span class="p"></span>
    <span class="k">function </span><span class="nf">F_1</span> <span class="o">(</span><span class="n">I</span> <span class="o">:</span> <span class="n">Integer</span><span class="o">)</span> <span class="kr">return</span><span class="p"> </span><span class="n">Integer</span> <span class="kr">is</span><span class="p"></span>
    <span class="kr">begin</span><span class="p"></span>
       <span class="kr">return</span><span class="p"> </span><span class="n">I</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">end </span><span class="nf">F_1</span><span class="p">;</span>
<span class="k">end </span><span class="nf">Lib_1</span><span class="p">;</span>

<span class="kr">with</span><span class="nn"> Lib_2;</span> <span class="kr">use</span><span class="p"> </span><span class="n">Lib_2</span><span class="p">;</span>
<span class="k">package </span><span class="nf">Pack</span> <span class="kr">is</span><span class="p"></span>
    <span class="n">Var</span> <span class="o">:</span> <span class="n">T_2</span><span class="p">;</span>
    <span class="k">function </span><span class="nf">Fun</span> <span class="o">(</span><span class="n">I</span> <span class="o">:</span> <span class="n">Integer</span><span class="o">)</span> <span class="kr">return</span><span class="p"> </span><span class="n">Integer</span><span class="p">;</span>
<span class="k">end </span><span class="nf">Pack</span><span class="p">;</span>

<span class="kr">with</span><span class="nn"> Lib_1;</span> <span class="kr">use</span><span class="p"> </span><span class="n">Lib_1</span><span class="p">;</span>
<span class="k">package body </span><span class="nf">Pack</span> <span class="kr">is</span><span class="p"></span>
    <span class="k">function </span><span class="nf">Fun</span> <span class="o">(</span><span class="n">I</span> <span class="o">:</span> <span class="n">Integer</span><span class="o">)</span> <span class="kr">return</span><span class="p"> </span><span class="n">Integer</span> <span class="kr">is</span><span class="p"></span>
    <span class="kr">begin</span><span class="p"></span>
       <span class="kr">return</span><span class="p"> </span><span class="n">F_1</span> <span class="o">(</span><span class="n">I</span><span class="o">)</span><span class="p">;</span>
    <span class="k">end </span><span class="nf">Fun</span><span class="p">;</span>
<span class="k">end </span><span class="nf">Pack</span><span class="p">;</span>
</pre></div>
</div>
</div></blockquote>
<p>If we apply <code class="docutils literal"><span class="pre">gnatmetric</span></code> with the <code class="switch docutils literal"><span class="pre">--coupling-all</span></code> option to
these units, the result will be:</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Coupling</span> <span class="n">metrics</span><span class="p">:</span>
<span class="o">=================</span>
    <span class="n">Unit</span> <span class="n">Lib_1</span> <span class="p">(</span><span class="n">C</span><span class="p">:</span>\\<span class="n">customers</span>\\<span class="mi">662</span>\\<span class="n">L406</span><span class="o">-</span><span class="mi">007</span>\\<span class="n">lib_1</span><span class="o">.</span><span class="n">ads</span><span class="p">)</span>
       <span class="n">control</span> <span class="n">fan</span><span class="o">-</span><span class="n">out</span> <span class="n">coupling</span>  <span class="p">:</span> <span class="mi">0</span>
       <span class="n">control</span> <span class="n">fan</span><span class="o">-</span><span class="ow">in</span> <span class="n">coupling</span>   <span class="p">:</span> <span class="mi">1</span>
       <span class="n">unit</span> <span class="n">fan</span><span class="o">-</span><span class="n">out</span> <span class="n">coupling</span>     <span class="p">:</span> <span class="mi">0</span>
       <span class="n">unit</span> <span class="n">fan</span><span class="o">-</span><span class="ow">in</span> <span class="n">coupling</span>      <span class="p">:</span> <span class="mi">1</span>

    <span class="n">Unit</span> <span class="n">Pack</span> <span class="p">(</span><span class="n">C</span><span class="p">:</span>\\<span class="n">customers</span>\\<span class="mi">662</span>\\<span class="n">L406</span><span class="o">-</span><span class="mi">007</span>\\<span class="n">pack</span><span class="o">.</span><span class="n">ads</span><span class="p">)</span>
       <span class="n">control</span> <span class="n">fan</span><span class="o">-</span><span class="n">out</span> <span class="n">coupling</span>  <span class="p">:</span> <span class="mi">1</span>
       <span class="n">control</span> <span class="n">fan</span><span class="o">-</span><span class="ow">in</span> <span class="n">coupling</span>   <span class="p">:</span> <span class="mi">0</span>
       <span class="n">unit</span> <span class="n">fan</span><span class="o">-</span><span class="n">out</span> <span class="n">coupling</span>     <span class="p">:</span> <span class="mi">2</span>
       <span class="n">unit</span> <span class="n">fan</span><span class="o">-</span><span class="ow">in</span> <span class="n">coupling</span>      <span class="p">:</span> <span class="mi">0</span>

    <span class="n">Unit</span> <span class="n">Lib_2</span> <span class="p">(</span><span class="n">C</span><span class="p">:</span>\\<span class="n">customers</span>\\<span class="mi">662</span>\\<span class="n">L406</span><span class="o">-</span><span class="mi">007</span>\\<span class="n">lib_2</span><span class="o">.</span><span class="n">ads</span><span class="p">)</span>
       <span class="n">control</span> <span class="n">fan</span><span class="o">-</span><span class="n">out</span> <span class="n">coupling</span>  <span class="p">:</span> <span class="mi">0</span>
       <span class="n">unit</span> <span class="n">fan</span><span class="o">-</span><span class="n">out</span> <span class="n">coupling</span>     <span class="p">:</span> <span class="mi">0</span>
       <span class="n">unit</span> <span class="n">fan</span><span class="o">-</span><span class="ow">in</span> <span class="n">coupling</span>      <span class="p">:</span> <span class="mi">1</span>
</pre></div>
</div>
</div></blockquote>
<p>The result does not contain values for object-oriented
coupling because none of the argument units contains a tagged type and
therefore none of these units can be treated as a class.</p>
<p>The <code class="docutils literal"><span class="pre">Pack</span></code> package (spec and body) depends on two
units &#8211; <code class="docutils literal"><span class="pre">Lib_1</span></code> and <code class="docutils literal"><span class="pre">Lib_2</span></code> &#8211; and so its unit fan-out coupling
is 2. Since nothing depends on it, its unit fan-in coupling is 0, as
is its control fan-in coupling. Only one of the units <code class="docutils literal"><span class="pre">Pack</span></code> depends
upon defines a subprogram, so its control fan-out coupling is 1.</p>
<p><code class="docutils literal"><span class="pre">Lib_2</span></code> depends on nothing, so its fan-out metrics are 0. It does
not define any subprograms, so it has no control fan-in metric.
One unit (<code class="docutils literal"><span class="pre">Pack</span></code>) depends on it , so its unit fan-in coupling is 1.</p>
<p><code class="docutils literal"><span class="pre">Lib_1</span></code> is similar to <code class="docutils literal"><span class="pre">Lib_2</span></code>, but it does define a subprogram.
Its control fan-in coupling is 1 (because there is one unit
depending on it).</p>
<p>When computing coupling metrics, <code class="docutils literal"><span class="pre">gnatmetric</span></code> counts only
dependencies between units that are arguments of the <code class="docutils literal"><span class="pre">gnatmetric</span></code>
invocation. Coupling metrics are program-wide (or project-wide) metrics, so
you should invoke <code class="docutils literal"><span class="pre">gnatmetric</span></code> for
the complete set of sources comprising your program. This can be done
by invoking <code class="docutils literal"><span class="pre">gnatmetric</span></code> with the corresponding project file
and with the <code class="switch docutils literal"><span class="pre">-U</span></code> option.</p>
<p>By default, all the coupling metrics are reported. You can use the following
switches to select specific syntax metrics.</p>
<span class="target" id="index-119"></span><span class="target" id="index-120"></span><span class="target" id="index-121"></span><dl class="docutils" id="index-122">
<dt><code class="switch docutils literal"><span class="pre">--coupling-all</span></code></dt>
<dd>Report all the coupling metrics</dd>
<dt><code class="switch docutils literal"><span class="pre">--tagged-coupling-out</span></code></dt>
<dd>Report tagged (class) fan-out coupling</dd>
<dt><code class="switch docutils literal"><span class="pre">--tagged-coupling-in</span></code></dt>
<dd>Report tagged (class) fan-in coupling</dd>
<dt><code class="switch docutils literal"><span class="pre">--hierarchy-coupling-out</span></code></dt>
<dd>Report hierarchy (category) fan-out coupling</dd>
<dt><code class="switch docutils literal"><span class="pre">--hierarchy-coupling-in</span></code></dt>
<dd>Report hierarchy (category) fan-in coupling</dd>
<dt><code class="switch docutils literal"><span class="pre">--unit-coupling-out</span></code></dt>
<dd>Report unit fan-out coupling</dd>
<dt><code class="switch docutils literal"><span class="pre">--unit-coupling-in</span></code></dt>
<dd>Report unit fan-in coupling</dd>
<dt><code class="switch docutils literal"><span class="pre">--control-coupling-out</span></code></dt>
<dd>Report control fan-out coupling</dd>
<dt><code class="switch docutils literal"><span class="pre">--control-coupling-in</span></code></dt>
<dd>Report control fan-in coupling</dd>
</dl>
</div>
</div>
<div class="section" id="other-gnatmetric-switches">
<span id="id32"></span><h3>5.7.4. Other <code class="docutils literal"><span class="pre">gnatmetric</span></code> Switches<a class="headerlink" href="#other-gnatmetric-switches" title="Permalink to this headline">¶</a></h3>
<p>Additional <code class="docutils literal"><span class="pre">gnatmetric</span></code> switches are as follows:</p>
<dl class="docutils" id="index-123">
<dt><code class="switch docutils literal"><span class="pre">--version</span></code></dt>
<dd>Display copyright and version, then exit disregarding all other options.</dd>
</dl>
<dl class="docutils" id="index-124">
<dt><code class="switch docutils literal"><span class="pre">--help</span></code></dt>
<dd>Display usage, then exit disregarding all other options.</dd>
</dl>
<dl class="docutils" id="index-125">
<dt><code class="switch docutils literal"><span class="pre">-P</span> <em><span class="pre">file</span></em></code></dt>
<dd>Indicates the name of the project file that describes the set of sources
to be processed. The exact set of argument sources depends on other options
specified, see below. An aggregate project is allowed as the file parameter
only if it has exactly one non-aggregate project being aggregated.</dd>
</dl>
<dl class="docutils" id="index-126">
<dt><code class="switch docutils literal"><span class="pre">-U</span></code></dt>
<dd>If a project file is specified and no argument source is explicitly
specified (either directly or by means of <code class="switch docutils literal"><span class="pre">-files</span></code> option), process
all the units of the closure of the argument project. Otherwise this option
has no effect.</dd>
<dt><code class="switch docutils literal"><span class="pre">-U</span> <em><span class="pre">main_unit</span></em></code></dt>
<dd>If a project file is specified and no argument source is explicitly
specified (either directly or by means of <code class="switch docutils literal"><span class="pre">-files</span></code> option), process
the closure of units rooted at <code class="docutils literal"><span class="pre">main_unit</span></code>. Otherwise this option
has no effect.</dd>
</dl>
<dl class="docutils" id="index-127">
<dt><code class="switch docutils literal"><span class="pre">-X</span><em><span class="pre">name</span></em><span class="pre">=</span><em><span class="pre">value</span></em></code></dt>
<dd>Indicates that external variable <code class="docutils literal"><span class="pre">name</span></code> in the argument project
has the value <code class="docutils literal"><span class="pre">value</span></code>. Has no effect if no project is specified.</dd>
</dl>
<dl class="docutils" id="index-128">
<dt><code class="switch docutils literal"><span class="pre">--RTS=</span><em><span class="pre">rts-path</span></em></code></dt>
<dd>Specifies the default location of the runtime library. Same meaning as the
equivalent <code class="docutils literal"><span class="pre">gnatmake</span></code> flag (see <a class="reference internal" href="building_executable_programs_with_gnat.html#switches-for-gnatmake"><span class="std std-ref">Switches for gnatmake</span></a>).</dd>
</dl>
<dl class="docutils" id="index-129">
<dt><code class="switch docutils literal"><span class="pre">--subdirs=</span><em><span class="pre">dir</span></em></code></dt>
<dd>Use the specified subdirectory of the project objects file (or of the
project file directory if the project does not specify an object directory)
for tool output files. Has no effect if no project is specified as
tool argument r if <code class="switch docutils literal"><span class="pre">--no_objects_dir</span></code> is specified.</dd>
</dl>
<dl class="docutils" id="index-130">
<dt><code class="switch docutils literal"><span class="pre">--files=</span><em><span class="pre">file</span></em></code></dt>
<dd>Take as arguments the files listed in text file <code class="docutils literal"><span class="pre">file</span></code>.
Text file <code class="docutils literal"><span class="pre">file</span></code> may contain empty lines that are ignored.
Each nonempty line should contain the name of an existing file.
Several such switches may be specified simultaneously.</dd>
</dl>
<dl class="docutils" id="index-131">
<dt><code class="switch docutils literal"><span class="pre">--ignore=</span><em><span class="pre">filename</span></em></code></dt>
<dd>Do not process the sources listed in a specified file.</dd>
</dl>
<dl class="docutils" id="index-132">
<dt><code class="switch docutils literal"><span class="pre">--verbose</span></code></dt>
<dd>Verbose mode;
<code class="docutils literal"><span class="pre">gnatmetric</span></code> generates version information and then
a trace of sources being processed.</dd>
</dl>
<dl class="docutils" id="index-133">
<dt><code class="switch docutils literal"><span class="pre">--quiet</span></code></dt>
<dd>Quiet mode.</dd>
</dl>
<p>If a project file is specified and no argument source is explicitly
specified (either directly or by means of <code class="switch docutils literal"><span class="pre">-files</span></code> option), and no
<code class="switch docutils literal"><span class="pre">-U</span></code> is specified, then the set of processed sources is
all the immediate units of the argument project.</p>
<div class="section" id="legacy-switches">
<h4>5.7.4.1. Legacy Switches<a class="headerlink" href="#legacy-switches" title="Permalink to this headline">¶</a></h4>
<p>Some switches have a short form, mostly for legacy reasons,
as shown below.</p>
<dl class="docutils" id="index-134">
<dt><code class="switch docutils literal"><span class="pre">-x</span></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--generate-xml-output</span></code></dd>
</dl>
<dl class="docutils" id="index-135">
<dt><code class="switch docutils literal"><span class="pre">-xs</span></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--generate-xml-schema</span></code></dd>
</dl>
<dl class="docutils" id="index-136">
<dt><code class="switch docutils literal"><span class="pre">-nt</span></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--no-text-output</span></code></dd>
</dl>
<dl class="docutils" id="index-137">
<dt><code class="switch docutils literal"><span class="pre">-d</span> <em><span class="pre">output-dir</span></em></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--output-dir</span></code></dd>
</dl>
<dl class="docutils" id="index-138">
<dt><code class="switch docutils literal"><span class="pre">-o</span> <em><span class="pre">file-suffix</span></em></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--output-suffix</span></code></dd>
</dl>
<dl class="docutils" id="index-139">
<dt><code class="switch docutils literal"><span class="pre">-og</span> <em><span class="pre">file-name</span></em></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--global-file-name</span></code></dd>
</dl>
<dl class="docutils" id="index-140">
<dt><code class="switch docutils literal"><span class="pre">-ox</span> <em><span class="pre">file-name</span></em></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--xml-file-name</span></code></dd>
</dl>
<dl class="docutils" id="index-141">
<dt><code class="switch docutils literal"><span class="pre">-sfn</span></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--short-file-names</span></code></dd>
</dl>
<dl class="docutils" id="index-142">
<dt><code class="switch docutils literal"><span class="pre">-nolocal</span></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--no-local-metrics</span></code></dd>
</dl>
<dl class="docutils" id="index-143">
<dt><code class="switch docutils literal"><span class="pre">-ne</span></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--no-treat-exit-as-goto</span></code></dd>
</dl>
<dl class="docutils" id="index-144">
<dt><code class="switch docutils literal"><span class="pre">-files</span> <em><span class="pre">filename</span></em></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--files</span></code></dd>
</dl>
<dl class="docutils" id="index-145">
<dt><code class="switch docutils literal"><span class="pre">-v</span></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--verbose</span></code></dd>
</dl>
<dl class="docutils" id="index-146">
<dt><code class="switch docutils literal"><span class="pre">-q</span></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--quiet</span></code></dd>
</dl>
</div>
</div>
</div>
<div class="section" id="the-gnat-pretty-printer-gnatpp">
<span id="id33"></span><h2>5.8. The GNAT Pretty Printer <code class="docutils literal"><span class="pre">gnatpp</span></code><a class="headerlink" href="#the-gnat-pretty-printer-gnatpp" title="Permalink to this headline">¶</a></h2>
<span class="target" id="index-147"></span><p id="index-148">This documentation is for the new libadalang-based version
of <code class="docutils literal"><span class="pre">gnatpp</span></code>, which replaces the ASIS-based version.</p>
<p>The <code class="docutils literal"><span class="pre">gnatpp</span></code> tool is a utility for source reformatting / pretty
printing. It takes an Ada source file as input and generates a
reformatted version as output. You can specify various style
directives via switches; e.g., identifier case conventions, rules of
indentation, and comment layout.</p>
<p><code class="docutils literal"><span class="pre">gnatpp</span></code> is a project-aware tool
(see <a class="reference internal" href="#using-project-files-with-gnat-tools"><span class="std std-ref">Using Project Files with GNAT Tools</span></a> for a description of
the project-related switches). The project file package that can specify
<code class="docutils literal"><span class="pre">gnatpp</span></code> switches is named <code class="docutils literal"><span class="pre">Pretty_Printer</span></code>.</p>
<p><code class="docutils literal"><span class="pre">gnatpp</span></code> cannot process sources that contain preprocessing
directives.</p>
<p>The <code class="docutils literal"><span class="pre">gnatpp</span></code> command has the form</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span>$ gnatpp [ switches ] filename
</pre></div>
</div>
</div></blockquote>
<p>where</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">switches</span></code> is an optional sequence of switches defining such properties as
the formatting rules, the source search path, and the destination for the
output source file</li>
<li><code class="docutils literal"><span class="pre">filename</span></code> is the name of the source file to reformat; wildcards
or several file names on the same gnatpp command are allowed. The
file name may contain path information; it does not have to follow
the GNAT file naming rules</li>
</ul>
<div class="section" id="switches-for-gnatpp">
<span id="id34"></span><h3>5.8.1. Switches for <code class="docutils literal"><span class="pre">gnatpp</span></code><a class="headerlink" href="#switches-for-gnatpp" title="Permalink to this headline">¶</a></h3>
<p>The following subsections describe the various switches accepted by
<code class="docutils literal"><span class="pre">gnatpp</span></code>, organized by category.</p>
<p>You specify a switch by supplying a name and generally also a value.
In many cases the values for a switch with a given name are incompatible with
each other
(for example the switch that controls the casing of a reserved word may have
exactly one value: upper case, lower case, or
mixed case) and thus exactly one such switch can be in effect for an
invocation of <code class="docutils literal"><span class="pre">gnatpp</span></code>.
If more than one is supplied, the last one is used.
However, some values for the same switch are mutually compatible.
You may supply several such switches to <code class="docutils literal"><span class="pre">gnatpp</span></code>, but then
each must be specified in full, with both the name and the value.
Abbreviated forms (the name appearing once, followed by each value) are
not permitted.</p>
<div class="section" id="alignment-control">
<span id="id35"></span><h4>5.8.1.1. Alignment Control<a class="headerlink" href="#alignment-control" title="Permalink to this headline">¶</a></h4>
<p id="index-149">Programs can be easier to read if certain constructs are vertically aligned.
By default, alignment of the following constructs is set ON:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">:</span></code> in declarations,</li>
<li><code class="docutils literal"><span class="pre">:=</span></code> in initializations in declarations,</li>
<li><code class="docutils literal"><span class="pre">:=</span></code> in assignment statements,</li>
<li><code class="docutils literal"><span class="pre">=&gt;</span></code> in associations, and</li>
<li><code class="docutils literal"><span class="pre">at</span></code> keywords in the component clauses in record representation clauses.</li>
</ul>
</div></blockquote>
<p>In addition, <code class="docutils literal"><span class="pre">in</span></code> and <code class="docutils literal"><span class="pre">out</span></code> in parameter specifications are lined up.</p>
<span class="target" id="index-150"></span><span class="target" id="index-151"></span><dl class="docutils" id="index-152">
<dt><code class="switch docutils literal"><span class="pre">--no-alignment</span></code></dt>
<dd>Set alignment to OFF</dd>
<dt><code class="switch docutils literal"><span class="pre">--alignment</span></code></dt>
<dd>Set alignment to ON</dd>
<dt><code class="switch docutils literal"><span class="pre">--no-align-modes</span></code></dt>
<dd>Do not line up <code class="docutils literal"><span class="pre">in</span></code> and <code class="docutils literal"><span class="pre">out</span></code> in parameter specifications.</dd>
</dl>
</div>
<div class="section" id="casing-control">
<span id="id36"></span><h4>5.8.1.2. Casing Control<a class="headerlink" href="#casing-control" title="Permalink to this headline">¶</a></h4>
<p id="index-153"><code class="docutils literal"><span class="pre">gnatpp</span></code> allows you to specify the casing for reserved words,
pragma names, attribute designators and identifiers.
For identifiers you may define a
general rule for name casing but also override this rule
via a set of dictionary files.</p>
<p>Three types of casing are supported: lower case, upper case, and mixed case.
&#8216;Mixed case&#8217; means that the first letter, and also each letter immediately
following an underscore, are converted to their uppercase forms;
all the other letters are converted to their lowercase forms.</p>
<p>(Note: the casing switches are not yet fully supported in the
libadalang-based version of gnatpp.)</p>
<dl class="docutils" id="index-154">
<dt><code class="switch docutils literal"><span class="pre">--name-case-as-declared</span></code></dt>
<dd>Name casing for defining occurrences are as they appear in the source file
(this is the default)</dd>
</dl>
<dl class="docutils" id="index-155">
<dt><code class="switch docutils literal"><span class="pre">--name-upper-case</span></code></dt>
<dd>Names are in upper case</dd>
</dl>
<dl class="docutils" id="index-156">
<dt><code class="switch docutils literal"><span class="pre">--name-lower-case</span></code></dt>
<dd>Names are in lower case</dd>
</dl>
<dl class="docutils" id="index-157">
<dt><code class="switch docutils literal"><span class="pre">--name-mixed-case</span></code></dt>
<dd>Names are in mixed case</dd>
</dl>
<dl class="docutils" id="index-158">
<dt><code class="switch docutils literal"><span class="pre">--attribute-lower-case</span></code></dt>
<dd>Attribute designators are lower case</dd>
</dl>
<dl class="docutils" id="index-159">
<dt><code class="switch docutils literal"><span class="pre">--attribute-upper-case</span></code></dt>
<dd>Attribute designators are upper case</dd>
</dl>
<dl class="docutils" id="index-160">
<dt><code class="switch docutils literal"><span class="pre">--attribute-mixed-case</span></code></dt>
<dd>Attribute designators are mixed case (this is the default)</dd>
</dl>
<dl class="docutils" id="index-161">
<dt><code class="switch docutils literal"><span class="pre">--keyword-lower-case</span></code></dt>
<dd>Keywords (technically, these are known in Ada as <em>reserved words</em>) are
lower case (this is the default)</dd>
</dl>
<dl class="docutils" id="index-162">
<dt><code class="switch docutils literal"><span class="pre">--keyword-upper-case</span></code></dt>
<dd>Keywords are upper case</dd>
</dl>
<dl class="docutils" id="index-163">
<dt><code class="switch docutils literal"><span class="pre">--enum-case-as-declared</span></code></dt>
<dd>Enumeration literal casing for defining occurrences are as they appear in the
source file. Overrides -n casing setting.</dd>
</dl>
<dl class="docutils" id="index-164">
<dt><code class="switch docutils literal"><span class="pre">--enum-upper-case</span></code></dt>
<dd>Enumeration literals are in upper case. Overrides -n casing
setting.</dd>
</dl>
<dl class="docutils" id="index-165">
<dt><code class="switch docutils literal"><span class="pre">--enum-lower-case</span></code></dt>
<dd>Enumeration literals are in lower case. Overrides -n casing
setting.</dd>
</dl>
<dl class="docutils" id="index-166">
<dt><code class="switch docutils literal"><span class="pre">--enum-mixed-case</span></code></dt>
<dd>Enumeration literals are in mixed case. Overrides -n casing
setting.</dd>
</dl>
<dl class="docutils" id="index-167">
<dt><code class="switch docutils literal"><span class="pre">--type-case-as-declared</span></code></dt>
<dd>Names introduced by type and subtype declarations are always
cased as they appear in the declaration in the source file.
Overrides -n casing setting.</dd>
</dl>
<dl class="docutils" id="index-168">
<dt><code class="switch docutils literal"><span class="pre">--type-upper-case</span></code></dt>
<dd>Names introduced by type and subtype declarations are always in
upper case. Overrides -n casing setting.</dd>
</dl>
<dl class="docutils" id="index-169">
<dt><code class="switch docutils literal"><span class="pre">--type-lower-case</span></code></dt>
<dd>Names introduced by type and subtype declarations are always in
lower case. Overrides -n casing setting.</dd>
</dl>
<dl class="docutils" id="index-170">
<dt><code class="switch docutils literal"><span class="pre">--type-mixed-case</span></code></dt>
<dd>Names introduced by type and subtype declarations are always in
mixed case. Overrides -n casing setting.</dd>
</dl>
<dl class="docutils" id="index-171">
<dt><code class="switch docutils literal"><span class="pre">--number-upper-case</span></code></dt>
<dd>Names introduced by number declarations are always in
upper case. Overrides -n casing setting.</dd>
</dl>
<dl class="docutils" id="index-172">
<dt><code class="switch docutils literal"><span class="pre">--number-lower-case</span></code></dt>
<dd>Names introduced by number declarations are always in
lower case. Overrides -n casing setting.</dd>
</dl>
<dl class="docutils" id="index-173">
<dt><code class="switch docutils literal"><span class="pre">--number-mixed-case</span></code></dt>
<dd>Names introduced by number declarations are always in
mixed case. Overrides -n casing setting.</dd>
</dl>
<dl class="docutils" id="index-174">
<dt><code class="switch docutils literal"><span class="pre">--pragma-lower-case</span></code></dt>
<dd>Pragma names are lower case</dd>
</dl>
<dl class="docutils" id="index-175">
<dt><code class="switch docutils literal"><span class="pre">--pragma-upper-case</span></code></dt>
<dd>Pragma names are upper case</dd>
</dl>
<dl class="docutils" id="index-176">
<dt><code class="switch docutils literal"><span class="pre">--pragma-mixed-case</span></code></dt>
<dd>Pragma names are mixed case (this is the default)</dd>
</dl>
<dl class="docutils" id="index-177">
<dt><code class="switch docutils literal"><span class="pre">--syntax-only</span></code></dt>
<dd>Disable the semantic analysis (name resolution) done by libadalang.
This means gnatpp will not be able to support any of the
&#8220;as-declared&#8221; switches.</dd>
</dl>
<dl class="docutils" id="index-178">
<dt><code class="switch docutils literal"><span class="pre">--dictionary=</span><em><span class="pre">file</span></em></code></dt>
<dd><p class="first">Use <code class="docutils literal"><span class="pre">file</span></code> as a <em>dictionary file</em> that defines
the casing for a set of specified names,
thereby overriding the effect on these names by
any explicit or implicit
-n switch.
To supply more than one dictionary file,
use several <code class="docutils literal"><span class="pre">--dictionary</span></code> switches.</p>
<p class="last"><code class="docutils literal"><span class="pre">gnatpp</span></code> implicitly uses a <em>default dictionary file</em>
to define the casing for the Ada predefined names and
the names declared in the GNAT libraries.</p>
</dd>
</dl>
<dl class="docutils" id="index-179">
<dt><code class="switch docutils literal"><span class="pre">--dictionary=-</span></code></dt>
<dd>Do not use the default dictionary file;
instead, use the casing
defined by a <code class="docutils literal"><span class="pre">-n</span></code> switch and any explicit
dictionary file(s)</dd>
</dl>
<p>The structure of a dictionary file, and details on the conventions
used in the default dictionary file, are defined in <a class="reference internal" href="#name-casing"><span class="std std-ref">Name Casing</span></a>.</p>
<p>The <code class="switch docutils literal"><span class="pre">--dictionary=-</span></code> and
<code class="switch docutils literal"><span class="pre">--dictionary=</span><em><span class="pre">file</span></em></code> switches are mutually
compatible.</p>
<p>This group of <code class="docutils literal"><span class="pre">gnatpp</span></code> switches controls the layout of comments and
complex syntactic constructs. See <a class="reference internal" href="#formatting-comments"><span class="std std-ref">Formatting Comments</span></a> for details
on their effect.</p>
<dl class="docutils" id="index-180">
<dt><code class="switch docutils literal"><span class="pre">--comments-unchanged</span></code></dt>
<dd>All comments remain unchanged.</dd>
<dt><code class="switch docutils literal"><span class="pre">--comments-gnat-indentation</span></code></dt>
<dd>GNAT-style comment line indentation.
This is the default.</dd>
<dt><code class="switch docutils literal"><span class="pre">--comments-gnat-beginning</span></code></dt>
<dd>GNAT-style comment beginning.</dd>
<dt><code class="switch docutils literal"><span class="pre">--comments-fill</span></code></dt>
<dd>Fill comment blocks.</dd>
<dt><code class="switch docutils literal"><span class="pre">--comments-special</span></code></dt>
<dd>Keep unchanged special form comments.
This is the default.</dd>
</dl>
<dl class="docutils" id="index-181">
<dt><code class="switch docutils literal"><span class="pre">--comments-only</span></code></dt>
<dd>Format just the comments.</dd>
</dl>
<dl class="docutils" id="index-182">
<dt><code class="switch docutils literal"><span class="pre">--no-end-id</span></code></dt>
<dd>Do not insert the name of a unit after <code class="docutils literal"><span class="pre">end</span></code>; leave whatever comes
after <code class="docutils literal"><span class="pre">end</span></code>, if anything, alone.</dd>
</dl>
<dl class="docutils" id="index-183">
<dt><code class="switch docutils literal"><span class="pre">--no-separate-is</span></code></dt>
<dd>Do not place the keyword <code class="docutils literal"><span class="pre">is</span></code> on a separate line in a subprogram body in
case if the spec occupies more than one line.</dd>
</dl>
<dl class="docutils" id="index-184">
<dt><code class="switch docutils literal"><span class="pre">--separate-loop</span></code></dt>
<dd>Place the keyword <code class="docutils literal"><span class="pre">loop</span></code> in FOR and WHILE loop statements
on a separate line.</dd>
</dl>
<dl class="docutils" id="index-185">
<dt><code class="switch docutils literal"><span class="pre">--separate-then</span></code></dt>
<dd>Place the keyword <code class="docutils literal"><span class="pre">then</span></code> in IF statements
on a separate line.</dd>
</dl>
<dl class="docutils" id="index-186">
<dt><code class="switch docutils literal"><span class="pre">--no-separate-loop</span></code></dt>
<dd>Do not place the keyword <code class="docutils literal"><span class="pre">loop</span></code> in FOR and WHILE loop statements
on a separate line. This option is
incompatible with the <code class="switch docutils literal"><span class="pre">--separate-loop</span></code> option.</dd>
</dl>
<dl class="docutils" id="index-187">
<dt><code class="switch docutils literal"><span class="pre">--no-separate-then</span></code></dt>
<dd>Do not place the keyword <code class="docutils literal"><span class="pre">then</span></code> in IF statements
on a separate line. This option is
incompatible with the <code class="switch docutils literal"><span class="pre">--separate-then</span></code> option.</dd>
</dl>
<dl class="docutils" id="index-188">
<dt><code class="switch docutils literal"><span class="pre">--separate-loop-then</span></code></dt>
<dd>Equivalent to <code class="switch docutils literal"><span class="pre">--separate-loop</span></code> <code class="switch docutils literal"><span class="pre">--separate-then</span></code>.</dd>
</dl>
<dl class="docutils" id="index-189">
<dt><code class="switch docutils literal"><span class="pre">--no-separate-loop-then</span></code></dt>
<dd>Equivalent to <code class="switch docutils literal"><span class="pre">--no-separate-loop</span></code> <code class="switch docutils literal"><span class="pre">--no-separate-then</span></code>.</dd>
</dl>
<dl class="docutils" id="index-190">
<dt><code class="switch docutils literal"><span class="pre">--use-on-new-line</span></code></dt>
<dd>Start each USE clause in a context clause from a separate line.</dd>
</dl>
<dl class="docutils" id="index-191">
<dt><code class="switch docutils literal"><span class="pre">--insert-blank-lines</span></code></dt>
<dd>Insert blank lines where appropriate (between bodies and other large
constructs).</dd>
</dl>
<dl class="docutils" id="index-192">
<dt><code class="switch docutils literal"><span class="pre">--preserve-blank-lines</span></code></dt>
<dd>Preserve blank lines in the input. By default, gnatpp will squeeze
multiple blank lines down to one.</dd>
</dl>
<dl class="docutils" id="index-193">
<dt><code class="switch docutils literal"><span class="pre">--preserve-line-breaks</span></code></dt>
<dd>Preserve line breaks in the input, to the extent possible.
By default, line breaks are also inserted at appropriate
places.</dd>
</dl>
<dl class="docutils" id="index-194">
<dt><code class="switch docutils literal"><span class="pre">--source-line-breaks</span></code></dt>
<dd>Keep the line breaks from the source; do not insert or delete any
line breaks.</dd>
</dl>
<dl class="docutils" id="index-195">
<dt><code class="switch docutils literal"><span class="pre">--spaces-only</span></code></dt>
<dd>Disable all formatting except for inserting and removing spaces.
This implies &#8211;source-line-breaks.</dd>
</dl>
<p>The <code class="docutils literal"><span class="pre">--comments</span></code> switches are compatible with one another, except
that the <code class="docutils literal"><span class="pre">--comments-unchanged</span></code> switch disables all other comment
formatting switches.</p>
</div>
<div class="section" id="general-text-layout-control">
<span id="id37"></span><h4>5.8.1.3. General Text Layout Control<a class="headerlink" href="#general-text-layout-control" title="Permalink to this headline">¶</a></h4>
<p>These switches allow control over line length and indentation.</p>
<dl class="docutils" id="index-196">
<dt><code class="switch docutils literal"><span class="pre">--max-line-length=</span><em><span class="pre">nnn</span></em></code></dt>
<dd>Maximum line length, <code class="docutils literal"><span class="pre">nnn</span></code> from 32...256, the default value is 79</dd>
</dl>
<dl class="docutils" id="index-197">
<dt><code class="switch docutils literal"><span class="pre">--indentation=</span><em><span class="pre">nnn</span></em></code></dt>
<dd>Indentation level, <code class="docutils literal"><span class="pre">nnn</span></code> from 1...9, the default value is 3</dd>
</dl>
<dl class="docutils" id="index-198">
<dt><code class="switch docutils literal"><span class="pre">--indent-continuation=</span><em><span class="pre">nnn</span></em></code></dt>
<dd>Indentation level for continuation lines (relative to the line being
continued), <code class="docutils literal"><span class="pre">nnn</span></code> from 1...9.
The default
value is one less than the (normal) indentation level, unless the
indentation is set to 1 (in which case the default value for continuation
line indentation is also 1)</dd>
</dl>
</div>
<div class="section" id="other-formatting-options">
<span id="id38"></span><h4>5.8.1.4. Other Formatting Options<a class="headerlink" href="#other-formatting-options" title="Permalink to this headline">¶</a></h4>
<p>These switches control other formatting not listed above.</p>
<dl class="docutils" id="index-199">
<dt><code class="switch docutils literal"><span class="pre">--decimal-grouping=</span><em><span class="pre">n</span></em></code></dt>
<dd>Put underscores in decimal literals (numeric literals without a base)
every <code class="docutils literal"><span class="pre">n</span></code> characters. If a literal already has one or more
underscores, it is not modified. For example, with
<code class="docutils literal"><span class="pre">--decimal-grouping=3</span></code>, <code class="docutils literal"><span class="pre">1000000</span></code> will be changed to
<code class="docutils literal"><span class="pre">1_000_000</span></code>.</dd>
</dl>
<dl class="docutils" id="index-200">
<dt><code class="switch docutils literal"><span class="pre">--based-grouping=</span><em><span class="pre">n</span></em></code></dt>
<dd>Same as <code class="docutils literal"><span class="pre">--decimal-grouping</span></code>, but for based literals. For
example, with <code class="docutils literal"><span class="pre">--based-grouping=4</span></code>, <code class="docutils literal"><span class="pre">16#0001FFFE#</span></code> will be
changed to <code class="docutils literal"><span class="pre">16#0001_FFFE#</span></code>.</dd>
</dl>
<dl class="docutils" id="index-201">
<dt><code class="switch docutils literal"><span class="pre">--split-line-before-record</span></code></dt>
<dd>Split the line just before <code class="docutils literal"><span class="pre">record</span></code> in a record type declaration.</dd>
</dl>
<dl class="docutils" id="index-202">
<dt><code class="switch docutils literal"><span class="pre">--indent-named-statements</span></code></dt>
<dd>Named block and loop statements are indented with respect to
the name.</dd>
</dl>
<dl class="docutils" id="index-203">
<dt><code class="switch docutils literal"><span class="pre">--split-line-before-op</span></code></dt>
<dd>If it is necessary to split a line at a binary operator, by default
the line is split after the operator. With this option, it is split
before the operator.</dd>
</dl>
<dl class="docutils" id="index-204">
<dt><code class="switch docutils literal"><span class="pre">--RM-style-spacing</span></code></dt>
<dd>Do not insert an extra blank before various occurrences of
&#8216;(&#8216; and &#8216;:&#8217;. This also turns off alignment.</dd>
</dl>
<dl class="docutils" id="index-205">
<dt><code class="switch docutils literal"><span class="pre">--call_threshold=</span><em><span class="pre">nnn</span></em></code></dt>
<dd>If the number of parameter associations is greater than <code class="docutils literal"><span class="pre">nnn</span></code> and if at
least one association uses named notation, start each association from
a new line. If <code class="docutils literal"><span class="pre">nnn</span></code> is 0, no check for the number of associations
is made; this is the default.</dd>
</dl>
<dl class="docutils" id="index-206">
<dt><code class="switch docutils literal"><span class="pre">--par_threshold=</span><em><span class="pre">nnn</span></em></code></dt>
<dd>If the number of parameter specifications is greater than <code class="docutils literal"><span class="pre">nnn</span></code>
(or equal to <code class="docutils literal"><span class="pre">nnn</span></code> in case of a function), start each specification from
a new line. If <code class="docutils literal"><span class="pre">nnn</span></code> is 0, and <code class="switch docutils literal"><span class="pre">--no-separate-is</span></code> was not specified, then
the <code class="docutils literal"><span class="pre">is</span></code> is placed on a separate line. This feature is disabled by default.</dd>
</dl>
<dl class="docutils" id="index-207">
<dt><code class="switch docutils literal"><span class="pre">--vertical-enum-types</span></code></dt>
<dd>Format enumeration type declarations &#8220;vertically&#8221;, e.g. each
enumeration literal goes on a separate line.</dd>
</dl>
<dl class="docutils" id="index-208">
<dt><code class="switch docutils literal"><span class="pre">--vertical-array-types</span></code></dt>
<dd>Format array type declarations &#8220;vertically&#8221;, e.g. for
multidimensional arrays, each index_subtype_definition or
discrete_subtype_definition goes on a separate line.</dd>
</dl>
<dl class="docutils" id="index-209">
<dt><code class="switch docutils literal"><span class="pre">--vertical-named-aggregates</span></code></dt>
<dd>Format aggregates &#8220;vertically&#8221; if named notation is used for all
component_associations, e.g. each component_association
goes on a separate line.</dd>
</dl>
<dl class="docutils" id="index-210">
<dt><code class="switch docutils literal"><span class="pre">--vertical-case-alternatives</span></code></dt>
<dd>Format case statements, case expressions, and variant parts with
additional line breaks.</dd>
</dl>
</div>
<div class="section" id="setting-the-source-search-path">
<span id="id39"></span><h4>5.8.1.5. Setting the Source Search Path<a class="headerlink" href="#setting-the-source-search-path" title="Permalink to this headline">¶</a></h4>
<p>To define the search path for the input source file, <code class="docutils literal"><span class="pre">gnatpp</span></code>
uses the same switches as the GNAT compiler, with the same effects:</p>
<p id="index-211"><code class="switch docutils literal"><span class="pre">-I</span><em><span class="pre">dir</span></em></code></p>
<p id="index-212"><code class="switch docutils literal"><span class="pre">-I-</span></code></p>
<p id="index-213"><code class="switch docutils literal"><span class="pre">-gnatec=</span><em><span class="pre">path</span></em></code></p>
</div>
<div class="section" id="output-file-control-gnatpp">
<span id="id40"></span><h4>5.8.1.6. Output File Control<a class="headerlink" href="#output-file-control-gnatpp" title="Permalink to this headline">¶</a></h4>
<p>By default the output overwrites the input file.
The output may be redirected by the following switches:</p>
<dl class="docutils" id="index-214">
<dt><code class="switch docutils literal"><span class="pre">--replace</span></code></dt>
<dd>This is the default.
Replace the input source file with the reformatted output without
creating any backup copy of the input source.</dd>
</dl>
<dl class="docutils" id="index-215">
<dt><code class="switch docutils literal"><span class="pre">--output-dir=</span><em><span class="pre">dir</span></em></code></dt>
<dd>Generate output file in directory <code class="file docutils literal"><span class="pre">dir</span></code> with the same name as
the input file. If <code class="file docutils literal"><span class="pre">dir</span></code> is the same as the directory
containing the input file, the input file is not processed; use
<code class="docutils literal"><span class="pre">--replace</span></code> if you want to update the input file in
place.</dd>
</dl>
<dl class="docutils" id="index-216">
<dt><code class="switch docutils literal"><span class="pre">--pipe</span></code></dt>
<dd>Send the output to <code class="docutils literal"><span class="pre">Standard_Output</span></code></dd>
</dl>
<dl class="docutils" id="index-217">
<dt><code class="switch docutils literal"><span class="pre">--output=</span><em><span class="pre">output_file</span></em></code></dt>
<dd>Write the output into <code class="docutils literal"><span class="pre">output_file</span></code>.
If <code class="docutils literal"><span class="pre">output_file</span></code> already exists, <code class="docutils literal"><span class="pre">gnatpp</span></code> terminates without
reading or processing the input file.</dd>
</dl>
<dl class="docutils" id="index-218">
<dt><code class="switch docutils literal"><span class="pre">--output-force=</span><em><span class="pre">output_file</span></em></code></dt>
<dd>Write the output into <code class="docutils literal"><span class="pre">output_file</span></code>, overwriting the existing file
(if one is present).</dd>
</dl>
<dl class="docutils" id="index-219">
<dt><code class="switch docutils literal"><span class="pre">--replace-backup</span></code></dt>
<dd>Replace the input source file with the reformatted output, and copy the
original input source into the file whose name is obtained by appending the
<code class="file docutils literal"><span class="pre">.npp</span></code> suffix to the name of the input file.
If a file with this name already exists, <code class="docutils literal"><span class="pre">gnatpp</span></code> terminates without
reading or processing the input file.</dd>
</dl>
<dl class="docutils" id="index-220">
<dt><code class="switch docutils literal"><span class="pre">--replace-force-backup</span></code></dt>
<dd>Like <code class="docutils literal"><span class="pre">--replace-backup</span></code> except that if the file with the specified name
already exists, it is overwritten.</dd>
</dl>
<dl class="docutils" id="index-221">
<dt><code class="switch docutils literal"><span class="pre">--eol=</span><em><span class="pre">xxx</span></em></code></dt>
<dd><p class="first">Specifies the line-ending style of the reformatted output file. The
<code class="docutils literal"><span class="pre">xxx</span></code> string specified with the switch may be:</p>
<ul class="simple">
<li><em>dos</em> - MS DOS style, lines end with CR LF characters*</li>
<li><em>crlf</em>  - the same as <em>dos</em></li>
<li><em>unix</em> - UNIX style, lines end with LF character*</li>
<li><em>lf</em> -  the same as <em>unix</em></li>
</ul>
<p class="last">The default is to use the same end-of-line convention as the input.</p>
</dd>
</dl>
<dl class="docutils" id="index-222">
<dt><code class="switch docutils literal"><span class="pre">--wide-character-encoding=</span><em><span class="pre">e</span></em></code></dt>
<dd><p class="first">Specify the wide character encoding method for the input and output
files. <code class="docutils literal"><span class="pre">e</span></code> is one of the following:</p>
<ul class="last simple">
<li><em>8</em> - UTF-8 encoding</li>
<li><em>b</em> - Brackets encoding (default value)</li>
</ul>
</dd>
</dl>
<p>Options <code class="docutils literal"><span class="pre">--output-file</span></code> and <code class="docutils literal"><span class="pre">--output-force</span></code> are allowed only if
the call to gnatpp contains only one file to reformat.</p>
<p>Option <code class="docutils literal"><span class="pre">--eol</span></code> and <code class="docutils literal"><span class="pre">--wide-character-encoding</span></code> cannot be used together
with the <code class="docutils literal"><span class="pre">--pipe</span></code> option.</p>
</div>
<div class="section" id="other-gnatpp-switches">
<span id="id41"></span><h4>5.8.1.7. Other <code class="docutils literal"><span class="pre">gnatpp</span></code> Switches<a class="headerlink" href="#other-gnatpp-switches" title="Permalink to this headline">¶</a></h4>
<p>The additional <code class="docutils literal"><span class="pre">gnatpp</span></code> switches are defined in this subsection.</p>
<dl class="docutils" id="index-223">
<dt><code class="switch docutils literal"><span class="pre">--version</span></code></dt>
<dd>Display copyright and version, then exit disregarding all other options.</dd>
</dl>
<dl class="docutils" id="index-224">
<dt><code class="switch docutils literal"><span class="pre">--help</span></code></dt>
<dd>Display usage, then exit disregarding all other options.</dd>
</dl>
<dl class="docutils" id="index-225">
<dt><code class="switch docutils literal"><span class="pre">-P</span> <em><span class="pre">file</span></em></code></dt>
<dd>Indicates the name of the project file that describes the set of sources
to be processed. The exact set of argument sources depends on other options
specified; see below.</dd>
</dl>
<dl class="docutils" id="index-226">
<dt><code class="switch docutils literal"><span class="pre">-U</span></code></dt>
<dd>If a project file is specified and no argument source is explicitly
specified (either directly or by means of <code class="docutils literal"><span class="pre">--files</span></code> option), process
all the units of the closure of the argument project. Otherwise this option
has no effect.</dd>
<dt><code class="switch docutils literal"><span class="pre">-U</span> <em><span class="pre">main_unit</span></em></code></dt>
<dd>If a project file is specified and no argument source is explicitly
specified (either directly or by means of <code class="docutils literal"><span class="pre">--files</span></code> option), process
the closure of units rooted at <code class="docutils literal"><span class="pre">main_unit</span></code>. Otherwise this option
has no effect.</dd>
</dl>
<dl class="docutils" id="index-227">
<dt><code class="switch docutils literal"><span class="pre">-X</span><em><span class="pre">name</span></em><span class="pre">=</span><em><span class="pre">value</span></em></code></dt>
<dd>Indicates that external variable <code class="docutils literal"><span class="pre">name</span></code> in the argument project
has the value <code class="docutils literal"><span class="pre">value</span></code>. Has no effect if no project is specified.</dd>
</dl>
<dl class="docutils" id="index-228">
<dt><code class="switch docutils literal"><span class="pre">--RTS=</span><em><span class="pre">rts-path</span></em></code></dt>
<dd>Specifies the default location of the runtime library. Same meaning as the
equivalent <code class="docutils literal"><span class="pre">gnatmake</span></code> flag (<a class="reference internal" href="building_executable_programs_with_gnat.html#switches-for-gnatmake"><span class="std std-ref">Switches for gnatmake</span></a>).</dd>
</dl>
<dl class="docutils" id="index-229">
<dt><code class="switch docutils literal"><span class="pre">--incremental</span></code></dt>
<dd>Incremental processing on a per-file basis. Source files are only
processed if they have been modified, or if files they depend on have
been modified. This is similar to the way gnatmake/gprbuild only
compiles files that need to be recompiled. A project file is required
in this mode, and the gnat driver (as in <em>gnat pretty</em>) is not
supported.
(Note: this switch is not yet supported in the libadalang-based
version of gnatpp.)</dd>
</dl>
<dl class="docutils" id="index-230">
<dt><code class="switch docutils literal"><span class="pre">--pp-off=</span><em><span class="pre">xxx</span></em></code></dt>
<dd>Use <code class="switch docutils literal"><span class="pre">--xxx</span></code> as the command to turn off pretty printing, instead
of the default <code class="docutils literal"><span class="pre">--!pp</span> <span class="pre">off</span></code>.</dd>
</dl>
<dl class="docutils" id="index-231">
<dt><code class="switch docutils literal"><span class="pre">--pp-on=</span><em><span class="pre">xxx</span></em></code></dt>
<dd>Use <code class="switch docutils literal"><span class="pre">--xxx</span></code> as the command to turn pretty printing back on, instead
of the default <code class="docutils literal"><span class="pre">--!pp</span> <span class="pre">on</span></code>.</dd>
</dl>
<dl class="docutils" id="index-232">
<dt><code class="switch docutils literal"><span class="pre">--files=</span><em><span class="pre">filename</span></em></code></dt>
<dd>Take as arguments the files listed in text file <code class="docutils literal"><span class="pre">file</span></code>.
Text file <code class="docutils literal"><span class="pre">file</span></code> may contain empty lines that are ignored.
Each nonempty line should contain the name of an existing file.
Several such switches may be specified simultaneously.</dd>
</dl>
<dl class="docutils" id="index-233">
<dt><code class="switch docutils literal"><span class="pre">--ignore=</span><em><span class="pre">filename</span></em></code></dt>
<dd>Do not process the sources listed in a specified file. This option cannot
be used in incremental mode.</dd>
</dl>
<dl class="docutils" id="index-234">
<dt><code class="switch docutils literal"><span class="pre">--jobs=</span><em><span class="pre">n</span></em></code></dt>
<dd>With <code class="docutils literal"><span class="pre">--incremental</span></code>, use <em>n</em> <code class="docutils literal"><span class="pre">gnatpp</span></code> processes to perform
pretty printing in parallel. If <em>n</em> is 0, then the maximum number
processes is the number of core processors on the platform.</dd>
</dl>
<dl class="docutils" id="index-235">
<dt><code class="switch docutils literal"><span class="pre">--verbose</span></code></dt>
<dd>Verbose mode</dd>
</dl>
<dl class="docutils" id="index-236">
<dt><code class="switch docutils literal"><span class="pre">--quiet</span></code></dt>
<dd>Quiet mode</dd>
</dl>
<p>If a project file is specified and no argument source is explicitly
specified (either directly or by means of <code class="docutils literal"><span class="pre">--files</span></code> option), and no
<code class="docutils literal"><span class="pre">-U</span></code> is specified, then the set of processed sources is
all the immediate units of the argument project.</p>
<dl class="docutils" id="index-237">
<dt><code class="switch docutils literal"><span class="pre">--gnat83</span></code></dt>
<dd>Ada 83 mode</dd>
</dl>
<dl class="docutils" id="index-238">
<dt><code class="switch docutils literal"><span class="pre">--gnat95</span></code></dt>
<dd>Ada 95 mode</dd>
</dl>
<dl class="docutils" id="index-239">
<dt><code class="switch docutils literal"><span class="pre">--gnat2005</span></code></dt>
<dd>Ada 2005 mode</dd>
</dl>
<dl class="docutils" id="index-240">
<dt><code class="switch docutils literal"><span class="pre">--gnat2012</span></code></dt>
<dd>Ada 2012 mode</dd>
</dl>
</div>
</div>
<div class="section" id="formatting-rules">
<span id="id42"></span><h3>5.8.2. Formatting Rules<a class="headerlink" href="#formatting-rules" title="Permalink to this headline">¶</a></h3>
<p>The following subsections show how <code class="docutils literal"><span class="pre">gnatpp</span></code> treats white space,
comments, program layout, and name casing.
They provide detailed descriptions of the switches shown above.</p>
<div class="section" id="disabling-pretty-printing">
<span id="id43"></span><h4>5.8.2.1. Disabling Pretty Printing<a class="headerlink" href="#disabling-pretty-printing" title="Permalink to this headline">¶</a></h4>
<p>Pretty printing is highly heuristic in nature, and sometimes doesn&#8217;t
do exactly what you want. If you wish to format a certain region of
code by hand, you can turn off pretty printing in that region by
surrounding it with special comments that start with <code class="docutils literal"><span class="pre">--!pp</span> <span class="pre">off</span></code>
and <code class="docutils literal"><span class="pre">--!pp</span> <span class="pre">on</span></code>. The text in that region will then be reproduced
verbatim in the output with no formatting.</p>
<p>To disable pretty printing for the whole file, put <code class="docutils literal"><span class="pre">--!pp</span> <span class="pre">off</span></code> at
the top, with no following <code class="docutils literal"><span class="pre">--!pp</span> <span class="pre">on</span></code>.</p>
<p>The comments must appear on a line by themselves, with nothing
preceding except spaces. The initial text of the comment must be
exactly <code class="docutils literal"><span class="pre">--!pp</span> <span class="pre">off</span></code> or <code class="docutils literal"><span class="pre">--!pp</span> <span class="pre">on</span></code> (case sensitive), but may
be followed by arbitrary additional text. For example:</p>
<blockquote>
<div><div class="highlight-ada"><div class="highlight"><pre><span></span><span class="k">package </span><span class="nf">Interrupts</span> <span class="kr">is</span><span class="p"></span>
   <span class="c">--!pp off -- turn off pretty printing so &quot;Interrupt_Kind&quot; lines up</span>
   <span class="kr">type</span><span class="p"> </span>           <span class="n">Interrupt_Kind</span> <span class="kr">is</span><span class="p"></span>
     <span class="o">(</span><span class="n">Asynchronous_Interrupt_Kind</span><span class="p">,</span>
       <span class="n">Synchronous_Interrupt_Kind</span><span class="p">,</span>
             <span class="n">Green_Interrupt_Kind</span><span class="o">)</span><span class="p">;</span>
   <span class="c">--!pp on -- reenable pretty printing</span>
   <span class="o">...</span>
</pre></div>
</div>
</div></blockquote>
<p>You can specify different comment strings using the <code class="docutils literal"><span class="pre">--pp-off</span></code>
and <code class="docutils literal"><span class="pre">--pp-on</span></code> switches. For example, if you say:</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span>$ gnatpp --pp-off=&#39; pp-&#39; *.ad?
</pre></div>
</div>
</div></blockquote>
<p>then gnatpp will recognize comments of the form
<code class="docutils literal"><span class="pre">--</span> <span class="pre">pp-</span></code> instead of <code class="docutils literal"><span class="pre">--!pp</span> <span class="pre">off</span></code> for disabling pretty
printing. Note that the leading <code class="docutils literal"><span class="pre">--</span></code> of the comment is not
included in the argument to these switches.</p>
</div>
<div class="section" id="white-space-and-empty-lines">
<span id="id44"></span><h4>5.8.2.2. White Space and Empty Lines<a class="headerlink" href="#white-space-and-empty-lines" title="Permalink to this headline">¶</a></h4>
<p><code class="docutils literal"><span class="pre">gnatpp</span></code> does not have an option to control space characters.
It will add or remove spaces according to the style illustrated by the
examples in the <cite>Ada Reference Manual</cite>.
The output file will contain no lines with trailing white space.</p>
<p>By default, a sequence of one or more blank lines in the input is
converted to a single blank line in the output; multiple blank lines
are squeezed down to one.
The <code class="docutils literal"><span class="pre">--preserve-blank-lines</span></code> option
turns off the squeezing; each blank line in the input is copied
to the output.
The <code class="docutils literal"><span class="pre">--insert-blank-lines</span></code> option
causes additional blank lines to be inserted if not already
present in the input (e.g. between bodies).</p>
</div>
<div class="section" id="formatting-comments">
<span id="id45"></span><h4>5.8.2.3. Formatting Comments<a class="headerlink" href="#formatting-comments" title="Permalink to this headline">¶</a></h4>
<p>Comments in Ada code are of two kinds:</p>
<ul class="simple">
<li>a <em>whole-line comment</em>, which appears by itself (possibly preceded by
white space) on a line</li>
<li>an <em>end-of-line comment</em>, which follows some other Ada code on
the same line.</li>
</ul>
<p>A whole-line comment is indented according to the surrounding code,
with some exceptions. Comments that start in column 1 are kept
there. If possible, comments are not moved so far to the right that
the maximum line length is exceeded. The <code class="docutils literal"><span class="pre">--comments-unchanged</span></code>
option turns off comment formatting. Special-form comments such as
SPARK-style <code class="docutils literal"><span class="pre">--#...</span></code> are left alone.</p>
<p>For an end-of-line comment, <code class="docutils literal"><span class="pre">gnatpp</span></code> tries to leave the same
number of spaces between the end of the preceding Ada code and the
beginning of the comment as appear in the original source.</p>
<p>The <code class="docutils literal"><span class="pre">--comments-gnat-beginning</span></code> switch (GNAT style comment
beginning) has the following effect:</p>
<blockquote>
<div><ul class="simple">
<li>For each whole-line comment that does not end with two hyphens,
<code class="docutils literal"><span class="pre">gnatpp</span></code> inserts spaces if necessary after the starting two
hyphens to ensure that there are at least two spaces between
these hyphens and the first non-blank character of the comment.</li>
</ul>
</div></blockquote>
<p>The <code class="docutils literal"><span class="pre">--comments-fill</span></code> switch specifies that whole-line comments
that form a paragraph will be filled in typical word processor style
(that is, moving words between lines to make the lines other than the
last similar in length ).</p>
<p>The <code class="docutils literal"><span class="pre">--comments-only</span></code> switch specifies that only the comments are
formatted; the rest of the program text is left alone. The comments
are formatted according to the <code class="docutils literal"><span class="pre">--comments-gnat-beginning</span></code> and
<code class="docutils literal"><span class="pre">--comments-fill</span></code> switches; other formatting switches are ignored. For
example, <code class="docutils literal"><span class="pre">--comments-only</span> <span class="pre">--comments-fill</span></code> means to fill comment
paragraphs, and do nothing else. Likewise, <code class="docutils literal"><span class="pre">--comments-only</span>
<span class="pre">--comments-gnat-beginning</span></code> ensures comments start with at least two
spaces after <code class="docutils literal"><span class="pre">--</span></code>, and <code class="docutils literal"><span class="pre">--comments-only</span> <span class="pre">--comments-gnat-beginning</span>
<span class="pre">--comments-fill</span></code> does both. If <code class="docutils literal"><span class="pre">--comments-only</span></code> is given without
<code class="docutils literal"><span class="pre">--comments-gnat-beginning</span></code> or <code class="docutils literal"><span class="pre">--comments-fill</span></code>, then gnatpp
doesn&#8217;t format anything.</p>
</div>
<div class="section" id="name-casing">
<span id="id46"></span><h4>5.8.2.4. Name Casing<a class="headerlink" href="#name-casing" title="Permalink to this headline">¶</a></h4>
<p><code class="docutils literal"><span class="pre">gnatpp</span></code> always converts the usage occurrence of a (simple) name to
the same casing as the corresponding defining identifier.</p>
<p>You control the casing for defining occurrences via the <code class="docutils literal"><span class="pre">--name...</span></code>
switches. With <code class="docutils literal"><span class="pre">--name-case-as-declared</span></code>, which is the default,
defining occurrences appear exactly as in the source file where they
are declared. The other values for this switch &#8211;
<code class="docutils literal"><span class="pre">--name-upper-case</span></code>, <code class="docutils literal"><span class="pre">--name-lower-case</span></code>, <code class="docutils literal"><span class="pre">--name-mixed-case</span></code>
&#8211; result in upper, lower, or mixed case, respectively. If
<code class="docutils literal"><span class="pre">gnatpp</span></code> changes the casing of a defining occurrence, it
analogously changes the casing of all the usage occurrences of this
name.</p>
<p>If the defining occurrence of a name is not in the source compilation
unit currently being processed by <code class="docutils literal"><span class="pre">gnatpp</span></code>, the casing of each
reference to this name is changed according to the switch (subject to
the dictionary file mechanism described below). Thus <code class="docutils literal"><span class="pre">gnatpp</span></code> acts
as though the switch had affected the casing for the defining
occurrence of the name.</p>
<p>The options
<code class="switch docutils literal"><span class="pre">--attribute...</span></code>,
<code class="switch docutils literal"><span class="pre">--keyword...</span></code>,
<code class="switch docutils literal"><span class="pre">--enum...</span></code>,
<code class="switch docutils literal"><span class="pre">--type...</span></code>,
<code class="switch docutils literal"><span class="pre">--number...</span></code>, and
<code class="switch docutils literal"><span class="pre">--pragma...</span></code>
allow finer-grained control over casing for
attributes, keywords, enumeration literals,
types, named numbers and pragmas, respectively.
<code class="switch docutils literal"><span class="pre">--type...</span></code> cover subtypes as well.</p>
<p>Some names may need to be spelled with casing conventions that are not
covered by the upper-, lower-, and mixed-case transformations.
You can arrange correct casing by placing such names in a
<em>dictionary file</em>,
and then supplying a <code class="docutils literal"><span class="pre">--dictionary</span></code> switch.
The casing of names from dictionary files overrides
any <code class="docutils literal"><span class="pre">--name...</span></code> switch.</p>
<p>To handle the casing of Ada predefined names and the names from GNAT libraries,
<code class="docutils literal"><span class="pre">gnatpp</span></code> assumes a default dictionary file.
The name of each predefined entity is spelled with the same casing as is used
for the entity in the <cite>Ada Reference Manual</cite> (usually mixed case).
The name of each entity in the GNAT libraries is spelled with the same casing
as is used in the declaration of that entity.</p>
<p>The <code class="docutils literal"><span class="pre">--dictionary=-</span></code> switch suppresses the use of
the default dictionary file. Instead, the casing for predefined and
GNAT-defined names will be established by the
<code class="docutils literal"><span class="pre">-n</span></code> switch or explicit dictionary files. For
example, by default the names <code class="docutils literal"><span class="pre">Ada.Text_IO</span></code> and
<code class="docutils literal"><span class="pre">GNAT.OS_Lib</span></code> will appear as just shown, even in the presence of
a <code class="docutils literal"><span class="pre">--name-upper-case</span></code> switch. To ensure that even
such names are rendered in uppercase, additionally supply the
&#8211;dictionary=- switch (or else place these names
in upper case in a dictionary file).</p>
<p>A dictionary file is a plain text file; each line in this file can be
either a blank line (containing only space characters), an Ada comment
line, or the specification of exactly one <em>casing schema</em>.</p>
<p>A casing schema is a string that has the following syntax:</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">casing_schema</span> <span class="p">::</span><span class="o">=</span> <span class="n">identifier</span> <span class="o">|</span> <span class="n">simple_identifier</span>

<span class="n">simple_identifier</span> <span class="p">::</span><span class="o">=</span> <span class="n">letter</span><span class="p">{</span><span class="n">letter_or_digit</span><span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<p>(See <cite>Ada Reference Manual</cite>, Section 2.3) for the definition of the
<code class="docutils literal"><span class="pre">identifier</span></code> lexical element and the <code class="docutils literal"><span class="pre">letter_or_digit</span></code> category.)</p>
<p>The casing schema string can be followed by white space and/or an Ada-style
comment; any amount of white space is allowed before the string.</p>
<p>If a dictionary file is passed as
the value of a <code class="switch docutils literal"><span class="pre">--dictionary=</span><em><span class="pre">file</span></em></code> switch
then for every
simple name and every identifier, <code class="docutils literal"><span class="pre">gnatpp</span></code> checks if the dictionary
defines the casing for the name or for some of its parts (the term &#8216;subword&#8217;
is used below to denote the part of a name which is delimited by &#8216;_&#8217; or by
the beginning or end of the word and which does not contain any &#8216;_&#8217; inside):</p>
<ul class="simple">
<li>if the whole name is in the dictionary, <code class="docutils literal"><span class="pre">gnatpp</span></code> uses for this name
the casing defined by the dictionary; no subwords are checked for this word</li>
<li>for every subword <code class="docutils literal"><span class="pre">gnatpp</span></code> checks if the dictionary contains the
corresponding string of the form <code class="docutils literal"><span class="pre">simple_identifier</span></code>,
and if it does, the casing of this <code class="docutils literal"><span class="pre">simple_identifier</span></code> is used
for this subword</li>
<li>if the whole name does not contain any &#8216;_&#8217; inside, and if for this name
the dictionary contains two entries &#8211; one of the form <code class="docutils literal"><span class="pre">identifier</span></code>,
and another of the form <code class="docutils literal"><span class="pre">simple_identifier</span></code> &#8211; then the first one
is applied to define the casing of this name</li>
<li>if more than one dictionary file is passed as <code class="docutils literal"><span class="pre">gnatpp</span></code> switches, each
dictionary adds new casing exceptions and overrides all the existing casing
exceptions set by the previous dictionaries</li>
<li>when <code class="docutils literal"><span class="pre">gnatpp</span></code> checks if the word or subword is in the dictionary,
this check is not case sensitive</li>
</ul>
<p>For example, suppose we have the following source to reformat:</p>
<blockquote>
<div><div class="highlight-ada"><div class="highlight"><pre><span></span><span class="k">procedure </span><span class="nf">test</span> <span class="kr">is</span><span class="p"></span>
   <span class="n">name1</span> <span class="o">:</span> <span class="n">integer</span> <span class="o">:=</span> <span class="mi">1</span><span class="p">;</span>
   <span class="n">name4_name3_name2</span> <span class="o">:</span> <span class="n">integer</span> <span class="o">:=</span> <span class="mi">2</span><span class="p">;</span>
   <span class="n">name2_name3_name4</span> <span class="o">:</span> <span class="n">Boolean</span><span class="p">;</span>
   <span class="n">name1_var</span> <span class="o">:</span> <span class="n">Float</span><span class="p">;</span>
<span class="kr">begin</span><span class="p"></span>
   <span class="n">name2_name3_name4</span> <span class="o">:=</span> <span class="n">name4_name3_name2</span> <span class="o">&gt;</span> <span class="n">name1</span><span class="p">;</span>
<span class="kr">end</span><span class="p">;</span>
</pre></div>
</div>
</div></blockquote>
<p>And suppose we have two dictionaries:</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">*</span><span class="n">dict1</span><span class="p">:</span><span class="o">*</span>
   <span class="n">NAME1</span>
   <span class="o">*</span><span class="n">NaMe3</span><span class="o">*</span>
   <span class="o">*</span><span class="n">Name1</span><span class="o">*</span>

<span class="o">*</span><span class="n">dict2</span><span class="p">:</span><span class="o">*</span>
  <span class="o">*</span><span class="n">NAME3</span><span class="o">*</span>
</pre></div>
</div>
</div></blockquote>
<p>If <code class="docutils literal"><span class="pre">gnatpp</span></code> is called with the following switches:</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span>$ gnatpp --name-mixed-case --dictionary=dict1 --dictionary=dict2 test.adb
</pre></div>
</div>
</div></blockquote>
<p>then we will get the following name casing in the <code class="docutils literal"><span class="pre">gnatpp</span></code> output:</p>
<blockquote>
<div><div class="highlight-ada"><div class="highlight"><pre><span></span><span class="k">procedure </span><span class="nf">Test</span> <span class="kr">is</span><span class="p"></span>
   <span class="n">NAME1</span>             <span class="o">:</span> <span class="n">Integer</span> <span class="o">:=</span> <span class="mi">1</span><span class="p">;</span>
   <span class="n">Name4_NAME3_Name2</span> <span class="o">:</span> <span class="n">Integer</span> <span class="o">:=</span> <span class="mi">2</span><span class="p">;</span>
   <span class="n">Name2_NAME3_Name4</span> <span class="o">:</span> <span class="n">Boolean</span><span class="p">;</span>
   <span class="n">Name1_Var</span>         <span class="o">:</span> <span class="n">Float</span><span class="p">;</span>
<span class="kr">begin</span><span class="p"></span>
   <span class="n">Name2_NAME3_Name4</span> <span class="o">:=</span> <span class="n">Name4_NAME3_Name2</span> <span class="o">&gt;</span> <span class="n">NAME1</span><span class="p">;</span>
<span class="k">end </span><span class="nf">Test</span><span class="p">;</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="preprocessor-directives">
<span id="id47"></span><h4>5.8.2.5. Preprocessor Directives<a class="headerlink" href="#preprocessor-directives" title="Permalink to this headline">¶</a></h4>
<p><code class="docutils literal"><span class="pre">gnatpp</span></code> has some support for preprocessor directives.
You can use preprocessor symbols, as in <code class="docutils literal"><span class="pre">$symbol</span></code>.
In addition, you can use conditional compilation,
so long as the program text is syntactically legal Ada code
after removing all the preprocessor directives (lines starting
with <code class="docutils literal"><span class="pre">#</span></code>). For example, <code class="docutils literal"><span class="pre">gnatpp</span></code> can format the following:</p>
<blockquote>
<div><div class="highlight-ada"><div class="highlight"><pre><span></span><span class="k">package </span><span class="nf">P</span> <span class="kr">is</span><span class="p"></span>
#<span class="kr">IF</span><span class="p"> </span><span class="n">SOMETHING</span>
   <span class="n">X</span> <span class="o">:</span> <span class="kr">constant</span><span class="p"> </span><span class="n">Integer</span> <span class="o">:=</span> <span class="mi">123</span><span class="p">;</span>
#<span class="kr">ELSE</span><span class="p"></span>
   <span class="n">X</span> <span class="o">:</span> <span class="kr">constant</span><span class="p"> </span><span class="n">Integer</span> <span class="o">:=</span> <span class="mi">456</span><span class="p">;</span>
#<span class="k">END IF</span><span class="p">;</span>
<span class="k">end </span><span class="nf">P</span><span class="p">;</span>
</pre></div>
</div>
</div></blockquote>
<p>which will be formatted as if it were:</p>
<blockquote>
<div><div class="highlight-ada"><div class="highlight"><pre><span></span><span class="k">package </span><span class="nf">P</span> <span class="kr">is</span><span class="p"></span>
   <span class="n">X</span> <span class="o">:</span> <span class="kr">constant</span><span class="p"> </span><span class="n">Integer</span> <span class="o">:=</span> <span class="mi">123</span><span class="p">;</span>
   <span class="n">X</span> <span class="o">:</span> <span class="kr">constant</span><span class="p"> </span><span class="n">Integer</span> <span class="o">:=</span> <span class="mi">456</span><span class="p">;</span>
<span class="k">end </span><span class="nf">P</span><span class="p">;</span>
</pre></div>
</div>
</div></blockquote>
<p>except that the <code class="docutils literal"><span class="pre">#</span></code> lines will be preserved.
However, <code class="docutils literal"><span class="pre">gnatpp</span></code> cannot format the following:</p>
<blockquote>
<div><div class="highlight-ada"><div class="highlight"><pre><span></span><span class="k">procedure </span><span class="nf">P</span> <span class="kr">is</span><span class="p"></span>
<span class="kr">begin</span><span class="p"></span>
#<span class="kr">IF</span><span class="p"> </span><span class="n">SOMETHING</span>
   <span class="kr">if</span><span class="p"> </span><span class="n">X</span> <span class="o">=</span> <span class="mi">0</span> <span class="kr">then</span><span class="p"></span>
#<span class="kr">ELSE</span><span class="p"></span>
   <span class="kr">if</span><span class="p"> </span><span class="n">X</span> <span class="o">=</span> <span class="mi">1</span> <span class="kr">then</span><span class="p"></span>
#<span class="k">END IF</span><span class="p">;</span>
      <span class="kr">null</span><span class="p">;</span>
   <span class="k">end if</span><span class="p">;</span>
<span class="k">end </span><span class="nf">P</span><span class="p">;</span>
</pre></div>
</div>
</div></blockquote>
<p>because removing the <code class="docutils literal"><span class="pre">#</span></code> lines gives:</p>
<blockquote>
<div><div class="highlight-ada"><div class="highlight"><pre><span></span><span class="k">procedure </span><span class="nf">P</span> <span class="kr">is</span><span class="p"></span>
<span class="kr">begin</span><span class="p"></span>
   <span class="kr">if</span><span class="p"> </span><span class="n">X</span> <span class="o">=</span> <span class="mi">0</span> <span class="kr">then</span><span class="p"></span>
   <span class="kr">if</span><span class="p"> </span><span class="n">X</span> <span class="o">=</span> <span class="mi">1</span> <span class="kr">then</span><span class="p"></span>
      <span class="kr">null</span><span class="p">;</span>
   <span class="k">end if</span><span class="p">;</span>
<span class="k">end </span><span class="nf">P</span><span class="p">;</span>
</pre></div>
</div>
</div></blockquote>
<p>which is not syntactically legal.</p>
</div>
<div class="section" id="id48">
<h4>5.8.2.6. Legacy Switches<a class="headerlink" href="#id48" title="Permalink to this headline">¶</a></h4>
<p>Some switches have a short form, mostly for legacy reasons,
as shown below.</p>
<dl class="docutils" id="index-241">
<dt><code class="switch docutils literal"><span class="pre">-nD</span></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--name-case-as-declared</span></code></dd>
<dt><code class="switch docutils literal"><span class="pre">-nU</span></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--name-upper-case</span></code></dd>
<dt><code class="switch docutils literal"><span class="pre">-nL</span></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--name-lower-case</span></code></dd>
<dt><code class="switch docutils literal"><span class="pre">-nM</span></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--name-mixed-case</span></code></dd>
</dl>
<dl class="docutils" id="index-242">
<dt><code class="switch docutils literal"><span class="pre">-aL</span></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--attribute-lower-case</span></code></dd>
<dt><code class="switch docutils literal"><span class="pre">-aU</span></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--attribute-upper-case</span></code></dd>
<dt><code class="switch docutils literal"><span class="pre">-aM</span></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--attribute-mixed-case</span></code></dd>
</dl>
<dl class="docutils" id="index-243">
<dt><code class="switch docutils literal"><span class="pre">-kL</span></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--keyword-lower-case</span></code></dd>
<dt><code class="switch docutils literal"><span class="pre">-kU</span></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--keyword-upper-case</span></code></dd>
</dl>
<dl class="docutils" id="index-244">
<dt><code class="switch docutils literal"><span class="pre">-neD</span></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--enum-case-as-declared</span></code></dd>
<dt><code class="switch docutils literal"><span class="pre">-neU</span></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--enum-upper-case</span></code></dd>
<dt><code class="switch docutils literal"><span class="pre">-neL</span></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--enum-lower-case</span></code></dd>
<dt><code class="switch docutils literal"><span class="pre">-neM</span></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--enum-mixed-case</span></code></dd>
</dl>
<dl class="docutils" id="index-245">
<dt><code class="switch docutils literal"><span class="pre">-ntD</span></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--type-case-as-declared</span></code></dd>
<dt><code class="switch docutils literal"><span class="pre">-ntU</span></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--type-upper-case</span></code></dd>
<dt><code class="switch docutils literal"><span class="pre">-ntL</span></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--type-lower-case</span></code></dd>
<dt><code class="switch docutils literal"><span class="pre">-ntM</span></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--type-mixed-case</span></code></dd>
<dt><code class="switch docutils literal"><span class="pre">-nnU</span></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--number-upper-case</span></code></dd>
<dt><code class="switch docutils literal"><span class="pre">-nnL</span></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--number-lower-case</span></code></dd>
<dt><code class="switch docutils literal"><span class="pre">-nnM</span></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--number-mixed-case</span></code></dd>
</dl>
<dl class="docutils" id="index-246">
<dt><code class="switch docutils literal"><span class="pre">-pL</span></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--pragma-lower-case</span></code></dd>
<dt><code class="switch docutils literal"><span class="pre">-pU</span></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--pragma-upper-case</span></code></dd>
<dt><code class="switch docutils literal"><span class="pre">-pM</span></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--pragma-mixed-case</span></code></dd>
</dl>
<dl class="docutils" id="index-247">
<dt><code class="switch docutils literal"><span class="pre">-D</span><em><span class="pre">file</span></em></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--dictionary=</span><em><span class="pre">file</span></em></code></dd>
</dl>
<dl class="docutils" id="index-248">
<dt><code class="switch docutils literal"><span class="pre">-D-</span></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--dictionary=-</span></code></dd>
</dl>
<dl class="docutils" id="index-249">
<dt><code class="switch docutils literal"><span class="pre">-c0</span></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--comments-unchanged</span></code></dd>
<dt><code class="switch docutils literal"><span class="pre">-c1</span></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--comments-gnat-indentation</span></code></dd>
<dt><code class="switch docutils literal"><span class="pre">-c3</span></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--comments-gnat-beginning</span></code></dd>
<dt><code class="switch docutils literal"><span class="pre">-c4</span></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--comments-fill</span></code></dd>
<dt><code class="switch docutils literal"><span class="pre">-c5</span></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--comments-special</span></code></dd>
</dl>
<dl class="docutils" id="index-250">
<dt><code class="switch docutils literal"><span class="pre">-M</span><em><span class="pre">nnn</span></em></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--max-line-length=</span><em><span class="pre">nnn</span></em></code></dd>
</dl>
<dl class="docutils" id="index-251">
<dt><code class="switch docutils literal"><span class="pre">-i</span><em><span class="pre">nnn</span></em></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--indentation=</span><em><span class="pre">nnn</span></em></code></dd>
</dl>
<dl class="docutils" id="index-252">
<dt><code class="switch docutils literal"><span class="pre">-cl</span><em><span class="pre">nnn</span></em></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--indent-continuation=</span><em><span class="pre">nnn</span></em></code></dd>
</dl>
<dl class="docutils" id="index-253">
<dt><code class="switch docutils literal"><span class="pre">-pipe</span></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--pipe</span></code></dd>
</dl>
<dl class="docutils" id="index-254">
<dt><code class="switch docutils literal"><span class="pre">-o</span> <em><span class="pre">output-file</span></em></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--output=</span><em><span class="pre">output-file</span></em></code></dd>
</dl>
<dl class="docutils" id="index-255">
<dt><code class="switch docutils literal"><span class="pre">-of</span> <em><span class="pre">output-file</span></em></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--output-force=</span><em><span class="pre">output-file</span></em></code></dd>
</dl>
<dl class="docutils" id="index-256">
<dt><code class="switch docutils literal"><span class="pre">-rnb</span></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--replace</span></code></dd>
<dt><code class="switch docutils literal"><span class="pre">-r</span></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--replace-backup</span></code></dd>
</dl>
<dl class="docutils" id="index-257">
<dt><code class="switch docutils literal"><span class="pre">-rf</span></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--replace-force-backup</span></code></dd>
</dl>
<span class="target" id="index-258"></span><span class="target" id="index-259"></span><dl class="docutils" id="index-260">
<dt><code class="switch docutils literal"><span class="pre">-W</span><em><span class="pre">e</span></em></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--wide-character-encoding=</span><em><span class="pre">e</span></em></code></dd>
</dl>
<dl class="docutils" id="index-261">
<dt><code class="switch docutils literal"><span class="pre">-files</span> <em><span class="pre">filename</span></em></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--files=</span><em><span class="pre">filename</span></em></code></dd>
</dl>
<dl class="docutils" id="index-262">
<dt><code class="switch docutils literal"><span class="pre">-j</span><em><span class="pre">n</span></em></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--jobs=</span><em><span class="pre">n</span></em></code></dd>
</dl>
<dl class="docutils" id="index-263">
<dt><code class="switch docutils literal"><span class="pre">-v</span></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--verbose</span></code></dd>
</dl>
<dl class="docutils" id="index-264">
<dt><code class="switch docutils literal"><span class="pre">-q</span></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--quiet</span></code></dd>
</dl>
</div>
</div>
</div>
<div class="section" id="the-body-stub-generator-gnatstub">
<span id="id49"></span><h2>5.9. The Body Stub Generator <em>gnatstub</em><a class="headerlink" href="#the-body-stub-generator-gnatstub" title="Permalink to this headline">¶</a></h2>
<p id="index-265"><code class="docutils literal"><span class="pre">gnatstub</span></code> creates empty but compilable bodies
for library unit declarations, and empty but compilable
subunits for body stubs.</p>
<p><code class="docutils literal"><span class="pre">gnatstub</span></code> is a project-aware tool.
(See <a class="reference internal" href="#using-project-files-with-gnat-tools"><span class="std std-ref">Using Project Files with GNAT Tools</span></a> for a description of
the project-related switches but note that <code class="docutils literal"><span class="pre">gnatstub</span></code> does not support
the <code class="switch docutils literal"><span class="pre">-U</span></code>, <code class="switch docutils literal"><span class="pre">-U</span> <em><span class="pre">main_unit</span></em></code>, <code class="switch docutils literal"><span class="pre">--subdirs=</span><em><span class="pre">dir</span></em></code>, or
<code class="switch docutils literal"><span class="pre">--no_objects_dir</span></code> switches.)
The project file package that can specify
<code class="docutils literal"><span class="pre">gnatstub</span></code> switches is named <code class="docutils literal"><span class="pre">gnatstub</span></code>.</p>
<p>By default, all the program unit bodies generated by <code class="docutils literal"><span class="pre">gnatstub</span></code>
raise <code class="docutils literal"><span class="pre">Program_Error</span></code>, which will catch accidental calls of
generated stubs. This behavior can be changed with option
<code class="docutils literal"><span class="pre">--no-exception</span></code> (see below).</p>
<div class="section" id="running-gnatstub">
<span id="id50"></span><h3>5.9.1. Running <code class="docutils literal"><span class="pre">gnatstub</span></code><a class="headerlink" href="#running-gnatstub" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal"><span class="pre">gnatstub</span></code> invocation has the following form:</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span>$ gnatstub [ switches ] {filename}
</pre></div>
</div>
</div></blockquote>
<p>where</p>
<ul class="simple">
<li><dl class="first docutils">
<dt><em>filename</em></dt>
<dd>is the name of the source file that contains a library unit declaration
for which a body must be created or a library unit body for which subunits
must be created for the body stubs declared in this body.
The file name may contain path information.
If the name does not follow GNAT file naming conventions and the set
of switches does not contain a project file that defines naming
conventions, the name of the body file must
be provided
explicitly as the value of the <code class="switch docutils literal"><span class="pre">--output=</span><em><span class="pre">body-name</span></em></code> option.
If the file name follows the GNAT file naming
conventions and the name of the body file is not provided,
<code class="docutils literal"><span class="pre">gnatstub</span></code>
takes the naming conventions for the generated source from the
project file provided as a parameter of <code class="docutils literal"><span class="pre">-P</span></code> switch if any,
or creates the name file to generate using the standard GNAT
naming conventions.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><em>switches</em></dt>
<dd>is an optional sequence of switches as described in the next section</dd>
</dl>
</li>
</ul>
</div>
<div class="section" id="switches-for-gnatstub">
<span id="id51"></span><h3>5.9.2. Switches for <code class="docutils literal"><span class="pre">gnatstub</span></code><a class="headerlink" href="#switches-for-gnatstub" title="Permalink to this headline">¶</a></h3>
<dl class="docutils" id="index-266">
<dt><code class="switch docutils literal"><span class="pre">--version</span></code></dt>
<dd>Display copyright and version, then exit disregarding all other options.</dd>
</dl>
<dl class="docutils" id="index-267">
<dt><code class="switch docutils literal"><span class="pre">--help</span></code></dt>
<dd>Display usage, then exit disregarding all other options.</dd>
</dl>
<dl class="docutils" id="index-268">
<dt><code class="switch docutils literal"><span class="pre">-P</span> <em><span class="pre">file</span></em></code></dt>
<dd>Indicates the name of the project file that describes the set of sources
to be processed. An aggregate project is allowed as the file parameter only
if it has exactly one non-aggregate project being aggregated.</dd>
</dl>
<dl class="docutils" id="index-269">
<dt><code class="switch docutils literal"><span class="pre">-X</span><em><span class="pre">name</span></em><span class="pre">=</span><em><span class="pre">value</span></em></code></dt>
<dd>Indicates that external variable <code class="docutils literal"><span class="pre">name</span></code> in the argument project
has the value <code class="docutils literal"><span class="pre">value</span></code>. Has no effect if no project is specified.</dd>
</dl>
<dl class="docutils" id="index-270">
<dt><code class="switch docutils literal"><span class="pre">--RTS=</span><em><span class="pre">rts-path</span></em></code></dt>
<dd>Specifies the default location of the runtime library. Same meaning as the
equivalent <code class="docutils literal"><span class="pre">gnatmake</span></code> flag (<a class="reference internal" href="building_executable_programs_with_gnat.html#switches-for-gnatmake"><span class="std std-ref">Switches for gnatmake</span></a>).</dd>
</dl>
<dl class="docutils" id="index-271">
<dt><code class="switch docutils literal"><span class="pre">--subunits</span></code></dt>
<dd>Generate subunits for body stubs. If this switch is specified,
<code class="docutils literal"><span class="pre">gnatstub</span></code> expects a library unit body as an argument file;
otherwise a library unit declaration is expected. If a body stub
already has a corresponding subunit, <code class="docutils literal"><span class="pre">gnatstub</span></code> does not
generate anything for it.</dd>
</dl>
<dl class="docutils" id="index-272">
<dt><code class="switch docutils literal"><span class="pre">--force</span></code></dt>
<dd>If the destination directory already contains a file with the name of the
body file
for the argument spec file, replace it with the generated body stub.
This switch cannot be used together with <code class="docutils literal"><span class="pre">--subunits</span></code>.</dd>
</dl>
<dl class="docutils" id="index-273">
<dt><code class="switch docutils literal"><span class="pre">--comment-header-spec</span></code></dt>
<dd>Put the comment header (i.e., all the comments preceding the
compilation unit) from the source of the library unit declaration
into the body stub.</dd>
</dl>
<dl class="docutils" id="index-274">
<dt><code class="switch docutils literal"><span class="pre">--comment-header-sample</span></code></dt>
<dd>Put a sample comment header into the body stub.</dd>
</dl>
<dl class="docutils" id="index-275">
<dt><code class="switch docutils literal"><span class="pre">--header-file=</span><em><span class="pre">filename</span></em></code></dt>
<dd>Use the content of the file as the comment header for a generated body stub.</dd>
</dl>
<dl class="docutils" id="index-276">
<dt><code class="switch docutils literal"><span class="pre">--max-line-length=</span><em><span class="pre">n</span></em></code></dt>
<dd>(<code class="docutils literal"><span class="pre">n</span></code> is a non-negative integer). Set the maximum line length for
the output files. The default is 79. The maximum value that can be
specified is 32767.</dd>
</dl>
<dl class="docutils" id="index-277">
<dt><code class="switch docutils literal"><span class="pre">--indentation=</span><em><span class="pre">n</span></em></code></dt>
<dd>(<code class="docutils literal"><span class="pre">n</span></code> is an integer from 1 to 9). Set the indentation level in
the generated files to <code class="docutils literal"><span class="pre">n</span></code>.
The default indentation is 3.</dd>
</dl>
<dl class="docutils" id="index-278">
<dt><code class="switch docutils literal"><span class="pre">--alphabetical-order</span></code></dt>
<dd>Order local bodies alphabetically. (By default local bodies are ordered
in the same way as the corresponding local specs in the argument
spec file.)</dd>
</dl>
<dl class="docutils" id="index-279">
<dt><code class="switch docutils literal"><span class="pre">--no-exception</span></code></dt>
<dd>Avoid raising Program_Error in the generated bodies of program unit stubs,
except in the case of functions, where we have no value to return.</dd>
</dl>
<dl class="docutils" id="index-280">
<dt><code class="switch docutils literal"><span class="pre">--no-local-header</span></code></dt>
<dd>Do not place local comment header with unit name before body stub for a
unit.</dd>
</dl>
<dl class="docutils" id="index-281">
<dt><code class="switch docutils literal"><span class="pre">--files=</span><em><span class="pre">filename</span></em></code></dt>
<dd>Take as arguments the files listed in text file <code class="docutils literal"><span class="pre">file</span></code>.
Text file <code class="docutils literal"><span class="pre">file</span></code> may contain empty lines that are ignored.
Each nonempty line should contain the name of an existing file.
Several such switches may be specified.</dd>
</dl>
<dl class="docutils" id="index-282">
<dt><code class="switch docutils literal"><span class="pre">--output=</span><em><span class="pre">body-name</span></em></code></dt>
<dd>Body file name. This should be set if the argument file name does
not follow the default GNAT file naming conventions, and the naming
conventions are not specified by a project file. If this switch and
<code class="docutils literal"><span class="pre">-P</span></code> are both omitted, the name for the body will be obtained
according to the default GNAT file naming conventions.</dd>
</dl>
<dl class="docutils" id="index-283">
<dt><code class="switch docutils literal"><span class="pre">--output-dir=</span><em><span class="pre">dir-name</span></em></code></dt>
<dd>The directory in which to place the output files.
If this switch is not set, the generated library unit body is
placed in the current directory, and generated sununits
in the directory where the argument body is located.</dd>
</dl>
<dl class="docutils" id="index-284">
<dt><code class="switch docutils literal"><span class="pre">--wide-character-encoding=</span><em><span class="pre">e</span></em></code></dt>
<dd><p class="first">Specify the wide character encoding method for the input and output
files. <code class="docutils literal"><span class="pre">e</span></code> is one of the following:</p>
<ul class="last simple">
<li><em>8</em> - UTF-8 encoding</li>
<li><em>b</em> - Brackets encoding (default value)</li>
</ul>
</dd>
</dl>
<dl class="docutils" id="index-285">
<dt><code class="switch docutils literal"><span class="pre">--gnat83</span></code></dt>
<dd>Ada 83 mode</dd>
</dl>
<dl class="docutils" id="index-286">
<dt><code class="switch docutils literal"><span class="pre">--gnat95</span></code></dt>
<dd>Ada 95 mode</dd>
</dl>
<dl class="docutils" id="index-287">
<dt><code class="switch docutils literal"><span class="pre">--gnat2005</span></code></dt>
<dd>Ada 2005 mode</dd>
</dl>
<dl class="docutils" id="index-288">
<dt><code class="switch docutils literal"><span class="pre">--gnat2012</span></code></dt>
<dd>Ada 2012 mode</dd>
</dl>
<span class="target" id="index-289"></span><dl class="docutils" id="index-290">
<dt><code class="switch docutils literal"><span class="pre">--quiet</span></code> / <code class="switch docutils literal"><span class="pre">-q</span></code></dt>
<dd>Quiet mode.</dd>
</dl>
<span class="target" id="index-291"></span><dl class="docutils" id="index-292">
<dt><code class="switch docutils literal"><span class="pre">--verbose</span></code> / <code class="switch docutils literal"><span class="pre">-v</span></code></dt>
<dd>Verbose mode.</dd>
</dl>
<div class="section" id="id52">
<h4>5.9.2.1. Legacy Switches<a class="headerlink" href="#id52" title="Permalink to this headline">¶</a></h4>
<p>Some switches have a short form, mostly for legacy reasons,
as shown below.</p>
<dl class="docutils" id="index-293">
<dt><code class="switch docutils literal"><span class="pre">-gnatyM</span><em><span class="pre">nnn</span></em></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--max-line-length=</span><em><span class="pre">nnn</span></em></code></dd>
</dl>
<dl class="docutils" id="index-294">
<dt><code class="switch docutils literal"><span class="pre">-i</span><em><span class="pre">nnn</span></em></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--indentation=</span><em><span class="pre">nnn</span></em></code></dd>
</dl>
<dl class="docutils" id="index-295">
<dt><code class="switch docutils literal"><span class="pre">-gnaty</span><em><span class="pre">nnn</span></em></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--indentation=</span><em><span class="pre">nnn</span></em></code></dd>
</dl>
<dl class="docutils" id="index-296">
<dt><code class="switch docutils literal"><span class="pre">-f</span></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--force</span></code></dd>
</dl>
<dl class="docutils" id="index-297">
<dt><code class="switch docutils literal"><span class="pre">-gnatyo</span></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--alphabetical-order</span></code></dd>
</dl>
<dl class="docutils" id="index-298">
<dt><code class="switch docutils literal"><span class="pre">-hg</span></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--comment-header-sample</span></code></dd>
</dl>
<dl class="docutils" id="index-299">
<dt><code class="switch docutils literal"><span class="pre">-hs</span></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--comment-header-spec</span></code></dd>
</dl>
<dl class="docutils" id="index-300">
<dt><code class="switch docutils literal"><span class="pre">-o</span> <em><span class="pre">output-file</span></em></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--output=</span><em><span class="pre">output-file</span></em></code></dd>
</dl>
<dl class="docutils" id="index-301">
<dt><code class="switch docutils literal"><span class="pre">-dir</span> <em><span class="pre">dir-name</span></em></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--output-dir=</span><em><span class="pre">dir-name</span></em></code></dd>
</dl>
<dl class="docutils" id="index-302">
<dt><code class="switch docutils literal"><span class="pre">-W</span><em><span class="pre">e</span></em></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--wide-character-encoding=</span><em><span class="pre">e</span></em></code></dd>
</dl>
<dl class="docutils" id="index-303">
<dt><code class="switch docutils literal"><span class="pre">-files</span> <em><span class="pre">filename</span></em></code></dt>
<dd><code class="switch docutils literal"><span class="pre">--files=</span><em><span class="pre">filename</span></em></code></dd>
</dl>
</div>
</div>
</div>
<div class="section" id="the-unit-test-generator-gnattest">
<span id="id53"></span><h2>5.10. The Unit Test Generator <code class="docutils literal"><span class="pre">gnattest</span></code><a class="headerlink" href="#the-unit-test-generator-gnattest" title="Permalink to this headline">¶</a></h2>
<p id="index-304"><code class="docutils literal"><span class="pre">gnattest</span></code> is an ASIS-based utility that creates unit-test skeletons
as well as a test driver infrastructure (harness). <code class="docutils literal"><span class="pre">gnattest</span></code> creates
a skeleton for each visible subprogram in the packages under consideration when
they do not exist already.</p>
<p><code class="docutils literal"><span class="pre">gnattest</span></code> is a project-aware tool.
(See <a class="reference internal" href="#using-project-files-with-gnat-tools"><span class="std std-ref">Using Project Files with GNAT Tools</span></a> for a description of
the project-related switches but note that <code class="docutils literal"><span class="pre">gnattest</span></code> does not support
the <code class="switch docutils literal"><span class="pre">-U</span></code>, <code class="switch docutils literal"><span class="pre">-eL</span></code>, <code class="switch docutils literal"><span class="pre">--subdirs=</span><em><span class="pre">dir</span></em></code>, or
<code class="switch docutils literal"><span class="pre">--no_objects_dir</span></code> switches.)
The project file package that can specify
<code class="docutils literal"><span class="pre">gnattest</span></code> switches is named <code class="docutils literal"><span class="pre">gnattest</span></code>.</p>
<p>The user can choose to generate a single test driver
that will run all individual tests, or separate test drivers for each test. The
second option allows much greater flexibility in test execution environment,
allows to benefit from parallel tests execution to increase performance, and
provides stubbing support.</p>
<p><code class="docutils literal"><span class="pre">gnattest</span></code> also has a mode of operation where it acts as the test
aggregator when multiple test executables must be run, in particular when
the separate test drivers were generated. In this mode it handles individual
tests execution and upon completion reports the summary results of the test
run.</p>
<p>In order to process source files from a project, <code class="docutils literal"><span class="pre">gnattest</span></code> has to
semantically analyze the sources. Therefore, test skeletons can only be
generated for legal Ada units. If a unit is dependent on other units,
those units should be among the source files of the project or of other projects
imported by this one.</p>
<p>Generated skeletons and harnesses are based on the AUnit testing framework.
AUnit is an Ada adaptation of the xxxUnit testing frameworks, similar to JUnit
for Java or CppUnit for C++. While it is advised that gnattest users read
the AUnit manual, deep knowledge of AUnit is not necessary for using <code class="docutils literal"><span class="pre">gnattest</span></code>.
For correct operation of <code class="docutils literal"><span class="pre">gnattest</span></code>, AUnit should be installed and
aunit.gpr must be on the project path. Except for some special circumstances
(e.g. a custom run-time is used), this should normally be the case out of the box.</p>
<div class="section" id="running-gnattest">
<span id="id54"></span><h3>5.10.1. Running <code class="docutils literal"><span class="pre">gnattest</span></code><a class="headerlink" href="#running-gnattest" title="Permalink to this headline">¶</a></h3>
<p>There are two ways of running <code class="docutils literal"><span class="pre">gnattest</span></code>.</p>
<div class="section" id="framework-generation-mode">
<span id="id55"></span><h4>5.10.1.1. Framework Generation Mode<a class="headerlink" href="#framework-generation-mode" title="Permalink to this headline">¶</a></h4>
<p>In this mode <code class="docutils literal"><span class="pre">gnattest</span></code> has the following command-line interface:</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span>$ gnattest -Pprojname [ switches ] [ filename ] [ -cargs gcc_switches ]
</pre></div>
</div>
</div></blockquote>
<p>where</p>
<ul class="simple">
<li><dl class="first docutils">
<dt><code class="switch docutils literal"><span class="pre">-P</span><em><span class="pre">projname</span></em></code></dt>
<dd>specifies the project defining the location of source files. When no
file names are provided on the command line, all sources in the project
are used as input. This switch is required.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="switch docutils literal"><em><span class="pre">filename</span></em></code></dt>
<dd>is the name of the source file containing the library unit package <em>declaration</em>
(the package &#8220;spec&#8221;) for which a test package will be created. The file name
may be given with a path.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="samp docutils literal"><em><span class="pre">switches</span></em></code></dt>
<dd>is an optional sequence of switches as described below.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="samp docutils literal"><em><span class="pre">gcc_switches</span></em></code></dt>
<dd>is a list of additional switches for
<code class="docutils literal"><span class="pre">gcc</span></code> that will be passed to all compiler invocations
made by <code class="docutils literal"><span class="pre">gnattest</span></code> to generate a set of ASIS trees.</dd>
</dl>
</li>
</ul>
<p><code class="docutils literal"><span class="pre">gnattest</span></code> results can be found in two different places.</p>
<ul>
<li><dl class="first docutils">
<dt><em>automatic harness</em>:</dt>
<dd><p class="first">This is the harness code, which is located by default in
&#8220;gnattest/harness&#8221; directory created in the object directory of
the main project file. All of this code is generated completely
automatically and can be destroyed and regenerated at will, with the
exception of the file <em>gnattest_common.gpr</em>, which is created if absent,
but never overwritten. It is not recommended to modify other files
manually, since these modifications will be lost if <code class="docutils literal"><span class="pre">gnattest</span></code> is re-run.
The entry point in the harness code is
the project file named <em>test_driver.gpr</em>. Tests can be compiled and run
using a command such as:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ gprbuild -P&lt;harness-dir&gt;/test_driver
</pre></div>
</div>
<p class="last">Note that if you need to adjust any options used to compile the harness,
you can do so by editing the file <em>gnattest_common.gpr</em>.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><em>actual unit test skeletons</em>:</dt>
<dd><p class="first">A test skeleton for each visible subprogram is created in a separate file, if it
doesn&#8217;t exist already. By default, those separate test files are located in a
&#8220;gnattest/tests&#8221; directory that is created in the object directory of
corresponding project file. For example, if a source file my_unit.ads in
directory src contains a visible subprogram Proc, then the corresponding unit
test will be found in file src/tests/my_unit-test_data-tests.adb and will be
called Test_Proc_&lt;code&gt;. &lt;code&gt; is a signature encoding used to differentiate
test names in case of overloading.</p>
<p class="last">Note that if the project already has both my_unit.ads and my_unit-test_data.ads,
this will cause a name conflict with the generated test package.</p>
</dd>
</dl>
</li>
</ul>
</div>
<div class="section" id="test-execution-mode">
<span id="id56"></span><h4>5.10.1.2. Test Execution Mode<a class="headerlink" href="#test-execution-mode" title="Permalink to this headline">¶</a></h4>
<p>In this  mode <code class="docutils literal"><span class="pre">gnattest</span></code> has a the following command-line interface:</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span>$ gnattest test_drivers.list [ switches ]
</pre></div>
</div>
</div></blockquote>
<p>where</p>
<ul class="simple">
<li><dl class="first docutils">
<dt><code class="samp docutils literal"><em><span class="pre">test_drivers.list</span></em></code></dt>
<dd>is the name of the text file containing the list of executables to treat as
test drivers. This file is automatically generated by gnattest, but can be
hand-edited to add or remove tests. This switch is required.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="samp docutils literal"><em><span class="pre">switches</span></em></code></dt>
<dd>is an optional sequence of switches as described below.</dd>
</dl>
</li>
</ul>
</div>
</div>
<div class="section" id="switches-for-gnattest-in-framework-generation-mode">
<span id="id57"></span><h3>5.10.2. Switches for <code class="docutils literal"><span class="pre">gnattest</span></code> in framework generation mode<a class="headerlink" href="#switches-for-gnattest-in-framework-generation-mode" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div></div></blockquote>
<dl class="docutils" id="index-305">
<dt><code class="switch docutils literal"><span class="pre">--strict</span></code></dt>
<dd>Return error exit code if there are any compilation errors.</dd>
<dt id="index-306"><code class="switch docutils literal"><span class="pre">-q</span></code></dt>
<dd>Quiet mode: suppresses noncritical output messages.</dd>
<dt id="index-307"><code class="switch docutils literal"><span class="pre">-v</span></code></dt>
<dd>Verbose mode: produces additional output about the execution of the tool.
When specified alone on the command line, prints tool version and exits.</dd>
<dt id="index-308"><code class="switch docutils literal"><span class="pre">-r</span></code></dt>
<dd>Recursively considers all sources from all projects.</dd>
<dt id="index-309"><code class="switch docutils literal"><span class="pre">-files=</span><em><span class="pre">filename</span></em></code></dt>
<dd>Take as arguments the files listed in text file <code class="docutils literal"><span class="pre">file</span></code>.
Text file <code class="docutils literal"><span class="pre">file</span></code> may contain empty lines that are ignored.
Each nonempty line should contain the name of an existing file.
Several such switches may be specified simultaneously.</dd>
<dt id="index-310"><code class="switch docutils literal"><span class="pre">--ignore=</span><em><span class="pre">filename</span></em></code></dt>
<dd>Do not process the sources listed in a specified file.</dd>
<dt id="index-311"><code class="switch docutils literal"><span class="pre">--RTS=</span><em><span class="pre">rts-path</span></em></code></dt>
<dd>Specifies the default location of the runtime library. Same meaning as the
equivalent <code class="docutils literal"><span class="pre">gnatmake</span></code> flag (<a class="reference internal" href="building_executable_programs_with_gnat.html#switches-for-gnatmake"><span class="std std-ref">Switches for gnatmake</span></a>). For restricted
profiles, <code class="docutils literal"><span class="pre">gnattest</span></code> takes into account the run-time limitations when
generating the harness.</dd>
<dt id="index-312"><code class="switch docutils literal"><span class="pre">--additional-tests=</span><em><span class="pre">projname</span></em></code></dt>
<dd>Sources described in <code class="docutils literal"><span class="pre">projname</span></code> are considered potential additional
manual tests to be added to the test suite.</dd>
<dt id="index-313"><code class="switch docutils literal"><span class="pre">--harness-only</span></code></dt>
<dd>When this option is given, <code class="docutils literal"><span class="pre">gnattest</span></code> creates a harness for all
sources, treating them as test packages. This option is not compatible with
closure computation done by -U main.</dd>
<dt id="index-314"><code class="switch docutils literal"><span class="pre">--separate-drivers[=</span><em><span class="pre">val</span></em><span class="pre">]</span></code></dt>
<dd>Generates a separate test driver for each test or unit under test, rather
than a single executable incorporating all tests. <code class="docutils literal"><span class="pre">val</span></code> can be &#8220;unit&#8221; or
&#8220;test&#8221;, or may be omitted, which defaults to &#8220;unit&#8221;.</dd>
<dt id="index-315"><code class="switch docutils literal"><span class="pre">--stub</span></code></dt>
<dd>Generates the testing framework that uses subsystem stubbing to isolate the
code under test.</dd>
<dt id="index-316"><code class="switch docutils literal"><span class="pre">--harness-dir=</span><em><span class="pre">dirname</span></em></code></dt>
<dd>Specifies the directory that will hold the harness packages and project file
for the test driver. If the <code class="docutils literal"><span class="pre">dirname</span></code> is a relative path, it is considered
relative to the object directory of the project file.</dd>
<dt id="index-317"><code class="switch docutils literal"><span class="pre">--tests-dir=</span><em><span class="pre">dirname</span></em></code></dt>
<dd>All test packages are placed in the <code class="docutils literal"><span class="pre">dirname</span></code> directory.
If the <code class="docutils literal"><span class="pre">dirname</span></code> is a relative path, it is considered relative to the object
directory of the project file. When all sources from all projects are taken
recursively from all projects, <code class="docutils literal"><span class="pre">dirname</span></code> directories are created for each
project in their object directories and test packages are placed accordingly.</dd>
<dt id="index-318"><code class="switch docutils literal"><span class="pre">--subdir=</span><em><span class="pre">dirname</span></em></code></dt>
<dd>Test packages are placed in a subdirectory of the corresponding source
directory, with the name <code class="docutils literal"><span class="pre">dirname</span></code>. Thus, each set of unit tests is located
in a subdirectory of the code under test. If the sources are in separate
directories, each source directory has a test subdirectory named <code class="docutils literal"><span class="pre">dirname</span></code>.</dd>
<dt id="index-319"><code class="switch docutils literal"><span class="pre">--tests-root=</span><em><span class="pre">dirname</span></em></code></dt>
<dd>The hierarchy of source directories, if any, is recreated in the <code class="docutils literal"><span class="pre">dirname</span></code>
directory, with test packages placed in directories corresponding to those
of the sources.
If the <code class="docutils literal"><span class="pre">dirname</span></code> is a relative path, it is considered relative to the object
directory of the project file. When projects are considered recursively,
directory hierarchies of tested sources are
recreated for each project in their object directories and test packages are
placed accordingly.</dd>
<dt id="index-320"><code class="switch docutils literal"><span class="pre">--stubs-dir=</span><em><span class="pre">dirname</span></em></code></dt>
<dd>The hierarchy of directories containing stubbed units is recreated in
the <code class="docutils literal"><span class="pre">dirname</span></code> directory, with stubs placed in directories corresponding to
projects they are derived from.
If the <code class="docutils literal"><span class="pre">dirname</span></code> is a relative path, it is considered relative to the object
directory of the project file. When projects are considered recursively,
directory hierarchies of stubs are
recreated for each project in their object directories and test packages are
placed accordingly.</dd>
<dt id="index-321"><code class="switch docutils literal"><span class="pre">--exclude-from-stubbing=</span><em><span class="pre">filename</span></em></code></dt>
<dd>Disables stubbing of units listed in <code class="docutils literal"><span class="pre">filename</span></code>. The file should contain
corresponding spec files, one per line.</dd>
<dt><code class="switch docutils literal"><span class="pre">--exclude-from-stubbing:</span><em><span class="pre">unit</span></em><span class="pre">=</span><em><span class="pre">filename</span></em></code></dt>
<dd>Same as above, but corresponding units will not be stubbed only when testing
specified <code class="docutils literal"><span class="pre">unit</span></code>.</dd>
<dt id="index-322"><code class="switch docutils literal"><span class="pre">--validate-type-extensions</span></code></dt>
<dd>Enables substitution check: run all tests from all parents in order
to check substitutability in accordance with the Liskov substitution principle (LSP).</dd>
<dt id="index-323"><code class="switch docutils literal"><span class="pre">--inheritance-check</span></code></dt>
<dd>Enables inheritance check: run inherited tests against descendants.</dd>
<dt id="index-324"><code class="switch docutils literal"><span class="pre">--no-inheritance-check</span></code></dt>
<dd>Disables inheritance check.</dd>
<dt id="index-325"><code class="switch docutils literal"><span class="pre">--test-case-only</span></code></dt>
<dd>Generates test skeletons only for subprograms that have at least one
associated pragma or aspect Test_Case.</dd>
<dt id="index-326"><code class="switch docutils literal"><span class="pre">--skeleton-default=</span><em><span class="pre">val</span></em></code></dt>
<dd>Specifies the default behavior of generated skeletons. <code class="docutils literal"><span class="pre">val</span></code> can be either
&#8220;fail&#8221; or &#8220;pass&#8221;, &#8220;fail&#8221; being the default.</dd>
<dt id="index-327"><code class="switch docutils literal"><span class="pre">--passed-tests=</span><em><span class="pre">val</span></em></code></dt>
<dd>Specifies whether or not passed tests should be shown. <code class="docutils literal"><span class="pre">val</span></code> can be either
&#8220;show&#8221; or &#8220;hide&#8221;, &#8220;show&#8221; being the default.</dd>
<dt id="index-328"><code class="switch docutils literal"><span class="pre">--exit-status=</span><em><span class="pre">val</span></em></code></dt>
<dd>Specifies whether or not generated test driver should return failure exit
status if at least one test fails or crashes. <code class="docutils literal"><span class="pre">val</span></code> can be either
&#8220;on&#8221; or &#8220;off&#8221;, &#8220;off&#8221; being the default.</dd>
<dt id="index-329"><code class="switch docutils literal"><span class="pre">--omit-sloc</span></code></dt>
<dd>Suppresses comment line containing file name and line number of corresponding
subprograms in test skeletons.</dd>
<dt id="index-330"><code class="switch docutils literal"><span class="pre">--no-command-line</span></code></dt>
<dd>Don&#8217;t add command line support to test driver. Note that regardless of this
switch, <code class="docutils literal"><span class="pre">gnattest</span></code> will automatically refrain from adding command
line support if it detects that the selected run-time doesn&#8217;t provide
this capability.</dd>
<dt id="index-331"><code class="switch docutils literal"><span class="pre">--separates</span></code></dt>
<dd>Bodies of all test routines are generated as separates. Note that this mode is
kept for compatibility reasons only and it is not advised to use it due to
possible problems with hash in names of test skeletons when using an
inconsistent casing. Separate test skeletons can be incorporated to monolith
test package with improved hash being used by using <code class="docutils literal"><span class="pre">--transition</span></code>
switch.</dd>
<dt id="index-332"><code class="switch docutils literal"><span class="pre">--transition</span></code></dt>
<dd>This allows transition from separate test routines to monolith test packages.
All matching test routines are overwritten with contents of corresponding
separates. Note that if separate test routines had any manually added with
clauses they will be moved to the test package body as is and have to be moved
by hand.</dd>
<dt id="index-333"><code class="switch docutils literal"><span class="pre">--test-duration</span></code></dt>
<dd>Adds time measurements for each test in generated test driver.</dd>
</dl>
<p><code class="switch docutils literal"><span class="pre">--tests_root</span></code>, <code class="switch docutils literal"><span class="pre">--subdir</span></code> and <code class="switch docutils literal"><span class="pre">--tests-dir</span></code> switches are mutually exclusive.</p>
</div>
<div class="section" id="switches-for-gnattest-in-test-execution-mode">
<span id="id58"></span><h3>5.10.3. Switches for <code class="docutils literal"><span class="pre">gnattest</span></code> in test execution mode<a class="headerlink" href="#switches-for-gnattest-in-test-execution-mode" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div></div></blockquote>
<dl class="docutils" id="index-334">
<dt><code class="switch docutils literal"><span class="pre">--passed-tests=</span><em><span class="pre">val</span></em></code></dt>
<dd>Specifies whether or not passed tests should be shown. <code class="docutils literal"><span class="pre">val</span></code> can be either
&#8220;show&#8221; or &#8220;hide&#8221;, &#8220;show&#8221; being the default.<span class="target" id="index-335"></span></dd>
<dt id="index-336"><code class="switch docutils literal"><span class="pre">--queues=</span><em><span class="pre">n</span></em></code>, <code class="switch docutils literal"><span class="pre">-j</span><em><span class="pre">n</span></em></code></dt>
<dd>Runs <code class="docutils literal"><span class="pre">n</span></code> tests in parallel (default is 1).</dd>
<dt id="index-337"><code class="switch docutils literal"><span class="pre">--copy-environment=</span><em><span class="pre">dir</span></em></code></dt>
<dd>Contents of <code class="docutils literal"><span class="pre">dir</span></code> directory will be copied to temporary directories
created by gnattest in which individual test drivers are spawned.</dd>
</dl>
</div>
<div class="section" id="project-attributes-for-gnattest">
<span id="id59"></span><h3>5.10.4. Project Attributes for <code class="docutils literal"><span class="pre">gnattest</span></code><a class="headerlink" href="#project-attributes-for-gnattest" title="Permalink to this headline">¶</a></h3>
<p>Most of the command-line options can also be passed to the tool by adding
special attributes to the project file. Those attributes should be put in
package <code class="docutils literal"><span class="pre">Gnattest</span></code>. Here is the list of attributes:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">Tests_Root</span></code></dt>
<dd>is used to select the same output mode as with the <code class="docutils literal"><span class="pre">--tests-root</span></code> option.
This attribute cannot be used together with <code class="docutils literal"><span class="pre">Subdir</span></code> or <code class="docutils literal"><span class="pre">Tests_Dir</span></code>.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">Subdir</span></code></dt>
<dd>is used to select the same output mode as with the <code class="docutils literal"><span class="pre">--subdir</span></code> option.
This attribute cannot be used together with <code class="docutils literal"><span class="pre">Tests_Root</span></code> or <code class="docutils literal"><span class="pre">Tests_Dir</span></code>.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">Tests_Dir</span></code></dt>
<dd>is used to select the same output mode as with the <code class="docutils literal"><span class="pre">--tests-dir</span></code> option.
This attribute cannot be used together with <code class="docutils literal"><span class="pre">Subdir</span></code> or <code class="docutils literal"><span class="pre">Tests_Root</span></code>.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">Stubs_Dir</span></code></dt>
<dd>is used to select the same output mode as with the <code class="docutils literal"><span class="pre">--stubs-dir</span></code> option.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">Harness_Dir</span></code></dt>
<dd>is used to specify the directory in which to place harness packages and project
file for the test driver, otherwise specified by <code class="docutils literal"><span class="pre">--harness-dir</span></code>.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">Additional_Tests</span></code></dt>
<dd>is used to specify the project file, otherwise given by
<code class="docutils literal"><span class="pre">--additional-tests</span></code> switch.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">Skeletons_Default</span></code></dt>
<dd>is used to specify the default behaviour of test skeletons, otherwise
specified by <code class="docutils literal"><span class="pre">--skeleton-default</span></code> option. The value of this attribute
should be either <code class="docutils literal"><span class="pre">pass</span></code> or <code class="docutils literal"><span class="pre">fail</span></code>.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">Default_Stub_Exclusion_List</span></code></dt>
<dd>is used to specify the file with list of units whose bodies should not
be stubbed, otherwise specified by <code class="docutils literal"><span class="pre">--exclude-from-stubbing=filename</span></code>.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">Stub_Exclusion_List</span> <span class="pre">(&quot;unit&quot;)</span></code></dt>
<dd>is used to specify the file with list of units whose bodies should not
be stubbed when testing &#8220;unit&#8221;, otherwise specified by
<code class="docutils literal"><span class="pre">--exclude-from-stubbing:unit=filename</span></code>.</dd>
</dl>
</li>
</ul>
<p>Each of those attributes can be overridden from the command line if needed.
Other <code class="docutils literal"><span class="pre">gnattest</span></code> switches can also be passed via the project
file as an attribute list called <code class="docutils literal"><span class="pre">Gnattest_Switches</span></code>.</p>
</div>
<div class="section" id="simple-example">
<span id="simple-gnattest-example"></span><h3>5.10.5. Simple Example<a class="headerlink" href="#simple-example" title="Permalink to this headline">¶</a></h3>
<p>Let&#8217;s take a very simple example using the first <code class="docutils literal"><span class="pre">gnattest</span></code> example
located in:</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">install_prefix</span><span class="o">&gt;/</span><span class="n">share</span><span class="o">/</span><span class="n">examples</span><span class="o">/</span><span class="n">gnattest</span><span class="o">/</span><span class="n">simple</span>
</pre></div>
</div>
</div></blockquote>
<p>This project contains a simple package containing one subprogram. By running <code class="docutils literal"><span class="pre">gnattest</span></code>:</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span>$ gnattest --harness-dir=driver -Psimple.gpr
</pre></div>
</div>
</div></blockquote>
<p>a test driver is created in directory <code class="docutils literal"><span class="pre">driver</span></code>. It can be compiled and run:</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span>$ cd obj/driver
$ gprbuild -Ptest_driver
$ test_runner
</pre></div>
</div>
</div></blockquote>
<p>One failed test with the diagnosis &#8220;test not implemented&#8221; is reported.
Since no special output option was specified, the test package <code class="docutils literal"><span class="pre">Simple.Tests</span></code>
is located in:</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">install_prefix</span><span class="o">&gt;/</span><span class="n">share</span><span class="o">/</span><span class="n">examples</span><span class="o">/</span><span class="n">gnattest</span><span class="o">/</span><span class="n">simple</span><span class="o">/</span><span class="n">obj</span><span class="o">/</span><span class="n">gnattest</span><span class="o">/</span><span class="n">tests</span>
</pre></div>
</div>
</div></blockquote>
<p>For each package containing visible subprograms, a child test package is
generated. It contains one test routine per tested subprogram. Each
declaration of a test subprogram has a comment specifying which tested
subprogram it corresponds to. Bodies of test routines are placed in test package
bodies and are surrounded by special comment sections. Those comment sections
should not be removed or modified in order for gnattest to be able to regenerate
test packages and keep already written tests in place.
The test routine <code class="docutils literal"><span class="pre">Test_Inc_5eaee3</span></code> located at <code class="file docutils literal"><span class="pre">simple-test_data-tests.adb</span></code> contains
a single statement: a call to procedure <code class="docutils literal"><span class="pre">Assert</span></code>. It has two arguments:
the Boolean expression we want to check and the diagnosis message to display if
the condition is false.</p>
<p>That is where actual testing code should be written after a proper setup.
An actual check can be performed by replacing the <code class="docutils literal"><span class="pre">Assert</span></code> call with:</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Assert</span> <span class="p">(</span><span class="n">Inc</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;wrong incrementation&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<p>After recompiling and running the test driver, one successfully passed test
is reported.</p>
</div>
<div class="section" id="setting-up-and-tearing-down-the-testing-environment">
<span id="id60"></span><h3>5.10.6. Setting Up and Tearing Down the Testing Environment<a class="headerlink" href="#setting-up-and-tearing-down-the-testing-environment" title="Permalink to this headline">¶</a></h3>
<p>Besides test routines themselves, each test package has a parent package
<code class="docutils literal"><span class="pre">Test_Data</span></code> that has two procedures: <code class="docutils literal"><span class="pre">Set_Up</span></code> and <code class="docutils literal"><span class="pre">Tear_Down</span></code>. This package is never
overwritten by the tool. <code class="docutils literal"><span class="pre">Set_Up</span></code> is called before each test routine of the
package, and <code class="docutils literal"><span class="pre">Tear_Down</span></code> is called after each test routine. Those two procedures
can be used to perform necessary initialization and finalization,
memory allocation, etc. Test type declared in <code class="docutils literal"><span class="pre">Test_Data</span></code> package is parent type
for the test type of test package and can have user-defined components whose
values can be set by <code class="docutils literal"><span class="pre">Set_Up</span></code> routine and used in test routines afterwards.</p>
</div>
<div class="section" id="regenerating-tests">
<span id="id61"></span><h3>5.10.7. Regenerating Tests<a class="headerlink" href="#regenerating-tests" title="Permalink to this headline">¶</a></h3>
<p>Bodies of test routines and <code class="docutils literal"><span class="pre">Test_Data</span></code> packages are never overridden after they
have been created once. As long as the name of the subprogram, full expanded Ada
names and order of its parameters are the same, and comment sections are
intact, the old test routine will fit in its place and no test skeleton will be
generated for the subprogram.</p>
<p>This can be demonstrated with the previous example. By uncommenting declaration
and body of function Dec in <code class="docutils literal"><span class="pre">simple.ads</span></code> and <code class="docutils literal"><span class="pre">simple.adb</span></code>, running
<code class="docutils literal"><span class="pre">gnattest</span></code> on the project, and then running the test driver:</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span>$ gnattest --harness-dir=driver -Psimple.gpr
$ cd obj/driver
$ gprbuild -Ptest_driver
$ test_runner
</pre></div>
</div>
</div></blockquote>
<p>The old test is not replaced with a stub, nor is it lost, but a new test
skeleton is created for function <code class="docutils literal"><span class="pre">Dec</span></code>.</p>
<p>The only way of regenerating tests skeletons is to remove the previously created
tests together with corresponding comment sections.</p>
</div>
<div class="section" id="default-test-behavior">
<span id="id62"></span><h3>5.10.8. Default Test Behavior<a class="headerlink" href="#default-test-behavior" title="Permalink to this headline">¶</a></h3>
<p>The generated test driver can treat unimplemented tests in two ways:
either count them all as failed (this is useful to see which tests are still
left to implement) or as passed (to sort out unimplemented ones from those
actually failing).</p>
<p>The test driver accepts a switch to specify this behavior:
<code class="switch docutils literal"><span class="pre">--skeleton-default=</span><em><span class="pre">val</span></em></code>, where <code class="docutils literal"><span class="pre">val</span></code> is either <code class="docutils literal"><span class="pre">pass</span></code> or <code class="docutils literal"><span class="pre">fail</span></code> (exactly as for
<code class="docutils literal"><span class="pre">gnattest</span></code>).</p>
<p>The default behavior of the test driver is set with the same switch
as passed to <code class="docutils literal"><span class="pre">gnattest</span></code> when generating the test driver.</p>
<p>Passing it to the driver generated on the first example:</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span>$ test_runner --skeleton-default=pass
</pre></div>
</div>
</div></blockquote>
<p>makes both tests pass, even the unimplemented one.</p>
</div>
<div class="section" id="testing-primitive-operations-of-tagged-types">
<span id="id63"></span><h3>5.10.9. Testing Primitive Operations of Tagged Types<a class="headerlink" href="#testing-primitive-operations-of-tagged-types" title="Permalink to this headline">¶</a></h3>
<p>Creation of test skeletons for primitive operations of tagged types entails
a number of features. Test routines for all primitives of a given tagged type
are placed in a separate child package named according to the tagged type. For
example, if you have tagged type <code class="docutils literal"><span class="pre">T</span></code> in package <code class="docutils literal"><span class="pre">P</span></code>, all tests for primitives
of <code class="docutils literal"><span class="pre">T</span></code> will be in <code class="docutils literal"><span class="pre">P.T_Test_Data.T_Tests</span></code>.</p>
<p>Consider running <code class="docutils literal"><span class="pre">gnattest</span></code> on the second example (note: actual tests for this
example already exist, so there&#8217;s no need to worry if the tool reports that
no new stubs were generated):</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span>$ cd &lt;install_prefix&gt;/share/examples/gnattest/tagged_rec
$ gnattest --harness-dir=driver -Ptagged_rec.gpr
</pre></div>
</div>
</div></blockquote>
<p>Taking a closer look at the test type declared in the test package
<em>Speed1.Controller_Test_Data</em> is necessary. It is declared in:</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">install_prefix</span><span class="o">&gt;/</span><span class="n">share</span><span class="o">/</span><span class="n">examples</span><span class="o">/</span><span class="n">gnattest</span><span class="o">/</span><span class="n">tagged_rec</span><span class="o">/</span><span class="n">obj</span><span class="o">/</span><span class="n">gnattest</span><span class="o">/</span><span class="n">tests</span>
</pre></div>
</div>
</div></blockquote>
<p>Test types are direct or indirect descendants of
<em>AUnit.Test_Fixtures.Test_Fixture</em> type. In the case of non-primitive tested
subprograms, the user doesn&#8217;t need to be concerned with them. However,
when generating test packages for primitive operations, there are some things
the user needs to know.</p>
<p>Type <code class="docutils literal"><span class="pre">Test_Controller</span></code> has components that allow assignment of various
derivations of type <code class="docutils literal"><span class="pre">Controller</span></code>. And if you look at the specification of
package <em>Speed2.Auto_Controller</em>, you will see that <code class="docutils literal"><span class="pre">Test_Auto_Controller</span></code>
actually derives from <code class="docutils literal"><span class="pre">Test_Controller</span></code> rather than AUnit type <code class="docutils literal"><span class="pre">Test_Fixture</span></code>.
Thus, test types mirror the hierarchy of tested types.</p>
<p>The <code class="docutils literal"><span class="pre">Set_Up</span></code> procedure of <code class="docutils literal"><span class="pre">Test_Data</span></code> package corresponding to a test package
of primitive operations of type <code class="docutils literal"><span class="pre">T</span></code> assigns to <code class="docutils literal"><span class="pre">Fixture</span></code> a reference to an
object of that exact type <code class="docutils literal"><span class="pre">T</span></code>. Note, however, that if the tagged type has
discriminants, the <code class="docutils literal"><span class="pre">Set_Up</span></code> only has a commented template for setting
up the fixture, since filling the discriminant with actual value is up
to the user.</p>
<p>The knowledge of the structure of test types allows additional testing
without additional effort. Those possibilities are described below.</p>
</div>
<div class="section" id="testing-inheritance">
<span id="id64"></span><h3>5.10.10. Testing Inheritance<a class="headerlink" href="#testing-inheritance" title="Permalink to this headline">¶</a></h3>
<p>Since the test type hierarchy mimics the hierarchy of tested types, the
inheritance of tests takes place. An example of such inheritance can be
seen by running the test driver generated for the second example. As previously
mentioned, actual tests are already written for this example.</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span>$ cd obj/driver
$ gprbuild -Ptest_driver
$ test_runner
</pre></div>
</div>
</div></blockquote>
<p>There are 6 passed tests while there are only 5 testable subprograms. The test
routine for function Speed has been inherited and run against objects of the
derived type.</p>
</div>
<div class="section" id="tagged-type-substitutability-testing">
<span id="id65"></span><h3>5.10.11. Tagged Type Substitutability Testing<a class="headerlink" href="#tagged-type-substitutability-testing" title="Permalink to this headline">¶</a></h3>
<p><em>Tagged Type Substitutability Testing</em> is a way of verifying the global type
consistency by testing. Global type consistency is a principle stating that if
<code class="docutils literal"><span class="pre">S</span></code> is a subtype of <code class="docutils literal"><span class="pre">T</span></code> (in Ada, <code class="docutils literal"><span class="pre">S</span></code> is a derived type of tagged type <code class="docutils literal"><span class="pre">T</span></code>),
then objects of type <code class="docutils literal"><span class="pre">T</span></code> may be replaced with objects of type <code class="docutils literal"><span class="pre">S</span></code> (that is,
objects of type <code class="docutils literal"><span class="pre">S</span></code> may be substituted for objects of type <code class="docutils literal"><span class="pre">T</span></code>), without
altering any of the desirable properties of the program. When the properties
of the program are expressed in the form of subprogram preconditions and
postconditions (let&#8217;s call them pre and post), the principle is formulated as
relations between the pre and post of primitive operations and the pre and post
of their derived operations. The pre of a derived operation should not be
stronger than the original pre, and the post of the derived operation should
not be weaker than the original post. Those relations ensure that verifying if
a dispatching call is safe can be done just by using the pre and post of the
root operation.</p>
<p>Verifying global type consistency by testing consists of running all the unit
tests associated with the primitives of a given tagged type with objects of its
derived types.</p>
<p>In the example used in the previous section, there was clearly a violation of
type consistency. The overriding primitive <code class="docutils literal"><span class="pre">Adjust_Speed</span></code> in package <code class="docutils literal"><span class="pre">Speed2</span></code>
removes the functionality of the overridden primitive and thus doesn&#8217;t respect
the consistency principle.
<code class="docutils literal"><span class="pre">gnattest</span></code> has a special option to run overridden parent tests against objects
of the type which have overriding primitives:</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span>$ gnattest --harness-dir=driver --validate-type-extensions -Ptagged_rec.gpr
$ cd obj/driver
$ gprbuild -Ptest_driver
$ test_runner
</pre></div>
</div>
</div></blockquote>
<p>While all the tests pass by themselves, the parent test for <code class="docutils literal"><span class="pre">Adjust_Speed</span></code> fails
against objects of the derived type.</p>
<p>Non-overridden tests are already inherited for derived test types, so the
<code class="docutils literal"><span class="pre">--validate-type-extensions</span></code> enables the application of overridden tests
to objects of derived types.</p>
</div>
<div class="section" id="testing-with-contracts">
<span id="id66"></span><h3>5.10.12. Testing with Contracts<a class="headerlink" href="#testing-with-contracts" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal"><span class="pre">gnattest</span></code> supports pragmas <code class="docutils literal"><span class="pre">Pre</span></code>, <code class="docutils literal"><span class="pre">Post</span></code>, and <code class="docutils literal"><span class="pre">Test_Case</span></code>,
as well as the corresponding Ada 2012 aspects.
Test routines are generated, one per each <code class="docutils literal"><span class="pre">Test_Case</span></code> associated with a tested
subprogram. Those test routines have special wrappers for tested functions
that have composition of pre- and postcondition of the subprogram with
&#8220;requires&#8221; and &#8220;ensures&#8221; of the <code class="docutils literal"><span class="pre">Test_Case</span></code> (depending on the mode, pre and post
either count for <code class="docutils literal"><span class="pre">Nominal</span></code> mode or do <em>not</em> count for <code class="docutils literal"><span class="pre">Robustness</span></code> mode).</p>
<p>The third example demonstrates how this works:</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span>$ cd &lt;install_prefix&gt;/share/examples/gnattest/contracts
$ gnattest --harness-dir=driver -Pcontracts.gpr
</pre></div>
</div>
</div></blockquote>
<p>Putting actual checks within the range of the contract does not cause any
error reports. For example, for the test routine which corresponds to
test case 1:</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Assert</span> <span class="p">(</span><span class="n">Sqrt</span> <span class="p">(</span><span class="mf">9.0</span><span class="p">)</span> <span class="o">=</span> <span class="mf">3.0</span><span class="p">,</span> <span class="s2">&quot;wrong sqrt&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<p>and for the test routine corresponding to test case 2:</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Assert</span> <span class="p">(</span><span class="n">Sqrt</span> <span class="p">(</span><span class="o">-</span><span class="mf">5.0</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;wrong error indication&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<p>are acceptable:</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span>$ cd obj/driver
$ gprbuild -Ptest_driver
$ test_runner
</pre></div>
</div>
</div></blockquote>
<p>However, by changing 9.0 to 25.0 and 3.0 to 5.0, for example, you can get
a precondition violation for test case one. Also, by using any otherwise
correct but positive pair of numbers in the second test routine, you can also
get a precondition violation. Postconditions are checked and reported
the same way.</p>
</div>
<div class="section" id="additional-tests">
<span id="id67"></span><h3>5.10.13. Additional Tests<a class="headerlink" href="#additional-tests" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal"><span class="pre">gnattest</span></code> can add user-written tests to the main suite of the test
driver. <code class="docutils literal"><span class="pre">gnattest</span></code> traverses the given packages and searches for test
routines. All procedures with a single in out parameter of a type which is
derived from <em>AUnit.Test_Fixtures.Test_Fixture</em> and that are declared in package
specifications are added to the suites and are then executed by the test driver.
(<code class="docutils literal"><span class="pre">Set_Up</span></code> and <code class="docutils literal"><span class="pre">Tear_Down</span></code> are filtered out.)</p>
<p>An example illustrates two ways of creating test harnesses for user-written
tests. Directory <code class="docutils literal"><span class="pre">additional_tests</span></code> contains an AUnit-based test driver written
by hand.</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">install_prefix</span><span class="o">&gt;/</span><span class="n">share</span><span class="o">/</span><span class="n">examples</span><span class="o">/</span><span class="n">gnattest</span><span class="o">/</span><span class="n">additional_tests</span><span class="o">/</span>
</pre></div>
</div>
</div></blockquote>
<p>To create a test driver for already-written tests, use the <code class="docutils literal"><span class="pre">--harness-only</span></code>
option:</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">gnattest</span> <span class="o">-</span><span class="n">Padditional</span><span class="o">/</span><span class="n">harness</span><span class="o">/</span><span class="n">harness</span><span class="o">.</span><span class="n">gpr</span> <span class="o">--</span><span class="n">harness</span><span class="o">-</span><span class="nb">dir</span><span class="o">=</span><span class="n">harness_only</span> \\
  <span class="o">--</span><span class="n">harness</span><span class="o">-</span><span class="n">only</span>
<span class="n">gprbuild</span> <span class="o">-</span><span class="n">Pharness_only</span><span class="o">/</span><span class="n">test_driver</span><span class="o">.</span><span class="n">gpr</span>
<span class="n">harness_only</span><span class="o">/</span><span class="n">test_runner</span>
</pre></div>
</div>
</div></blockquote>
<p>Additional tests can also be executed together with generated tests:</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">gnattest</span> <span class="o">-</span><span class="n">Psimple</span><span class="o">.</span><span class="n">gpr</span> <span class="o">--</span><span class="n">additional</span><span class="o">-</span><span class="n">tests</span><span class="o">=</span><span class="n">additional</span><span class="o">/</span><span class="n">harness</span><span class="o">/</span><span class="n">harness</span><span class="o">.</span><span class="n">gpr</span> \\
  <span class="o">--</span><span class="n">harness</span><span class="o">-</span><span class="nb">dir</span><span class="o">=</span><span class="n">mixing</span>
<span class="n">gprbuild</span> <span class="o">-</span><span class="n">Pmixing</span><span class="o">/</span><span class="n">test_driver</span><span class="o">.</span><span class="n">gpr</span>
<span class="n">mixing</span><span class="o">/</span><span class="n">test_runner</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="individual-test-drivers">
<span id="id68"></span><h3>5.10.14. Individual Test Drivers<a class="headerlink" href="#individual-test-drivers" title="Permalink to this headline">¶</a></h3>
<p>By default, <code class="docutils literal"><span class="pre">gnattest</span></code> generates a monolithic test driver that
aggregates the individual tests into a single executable. It is also possible
to generate separate executables for each test or each unit under test, by
passing the switch <code class="docutils literal"><span class="pre">--separate-drivers</span></code> with corresponding parameter. This
approach scales better for large testing campaigns, especially involving target
architectures with limited resources typical for embedded development. It can
also provide a major performance benefit on multi-core systems by allowing
simultaneous execution of multiple tests.</p>
<p><code class="docutils literal"><span class="pre">gnattest</span></code> can take charge of executing the individual tests; for this,
instead of passing a project file, a text file containing the list of
executables can be passed. Such a file is automatically generated by gnattest
under the name <code class="file docutils literal"><span class="pre">test_drivers.list</span></code>, but it can be
hand-edited to add or remove tests, or replaced. The individual tests can
also be executed standalone, or from any user-defined scripted framework.</p>
</div>
<div class="section" id="stubbing">
<span id="id69"></span><h3>5.10.15. Stubbing<a class="headerlink" href="#stubbing" title="Permalink to this headline">¶</a></h3>
<p>Depending on the testing campaign, it is sometimes necessary to isolate the
part of the algorithm under test from its dependencies. This is accomplished
via <em>stubbing</em>, i.e. replacing the subprograms that are called from the
subprogram under test by stand-in subprograms that match the profiles of the
original ones, but simply return predetermined values required by the test
scenario.</p>
<p>This mode of test harness generation is activated by the switch <code class="docutils literal"><span class="pre">--stub</span></code>.</p>
<p>The implementation approach chosen by <code class="docutils literal"><span class="pre">gnattest</span></code> is as follows.
For each package under consideration all the packages it is directly depending
on are stubbed, excluding the generic packages and package instantiations.
The stubs are shared for each package under test. The specs of packages to stub
remain intact, while their bodies are replaced, and hide the original bodies by
means of extending projects. Also, for each stubbed
package, a child package with setter routines for each subprogram declaration
is created. These setters are meant to be used to set the behavior of
stubbed subprograms from within test cases.</p>
<p>Note that subprograms belonging to the same package as the subprogram under
test are not stubbed. This guarantees that the sources being tested are
exactly the sources used for production, which is an important property for
establishing the traceability between the testing campaign and production code.</p>
<p>Due to the nature of stubbing process, this mode implies the switch
<code class="docutils literal"><span class="pre">--separate-drivers</span></code>, i.e. an individual test driver (with the
corresponding hierarchy of extending projects) is generated for each unit under
test.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Developing a stubs-based testing campaign requires
good understanding of the infrastructure created by <code class="docutils literal"><span class="pre">gnattest</span></code> for
this purpose. We recommend following the two stubbing tutorials
<code class="docutils literal"><span class="pre">simple_stubbing</span></code> and <code class="docutils literal"><span class="pre">advanced_stubbing</span></code> provided
under <code class="file docutils literal"><span class="pre">&lt;install_prefix&gt;/share/examples/gnattest</span></code> before
attempting to use this powerful feature.</p>
</div>
</div>
<div class="section" id="integration-with-gnatcoverage">
<span id="gnatcov-integration"></span><h3>5.10.16. Integration with GNATcoverage<a class="headerlink" href="#integration-with-gnatcoverage" title="Permalink to this headline">¶</a></h3>
<p>In addition to the harness, <code class="docutils literal"><span class="pre">gnattest</span></code> generates a Makefile. This Makefile
provides targets for building the test drivers and also the targets for
computing the coverage information using GNATcoverage framework when this
coverage analysis tool is available. The target <code class="docutils literal"><span class="pre">coverage</span></code> fully automates
the process: it will first build all test drivers, then run them under
GNATcoverage, analyze individual trace files, and finally aggregate them:</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">make</span> <span class="n">coverage</span>
</pre></div>
</div>
</div></blockquote>
<p>GNATcoverage options, such as coverage criteria and generated report format,
can be adjusted using Makefile variables provided for this purpose.</p>
<p>Note that coverage targets are not generated in the Makefile when
&#8211;separate-drivers=test is passed to gnattest.</p>
</div>
<div class="section" id="putting-tests-under-version-control">
<span id="id70"></span><h3>5.10.17. Putting Tests under Version Control<a class="headerlink" href="#putting-tests-under-version-control" title="Permalink to this headline">¶</a></h3>
<p>As has been stated earlier, <code class="docutils literal"><span class="pre">gnattest</span></code> generates two different types
of code, test skeletons and harness. The harness is generated completely
automatically each time, does not require manual changes and therefore should
not be put under version control.
It makes sense to put under version control files containing test data packages,
both specs and bodies, and files containing bodies of test packages. Note that
test package specs are also generated automatically each time and should not be
put under version control.
Option <code class="docutils literal"><span class="pre">--omit-sloc</span></code> may be useful when putting test packages under version control.</p>
</div>
<div class="section" id="current-limitations">
<span id="id71"></span><h3>5.10.18. Current Limitations<a class="headerlink" href="#current-limitations" title="Permalink to this headline">¶</a></h3>
<p>The tool currently has the following limitations:</p>
<ul class="simple">
<li>generic tests for nested generic packages and their instantiations are
not supported;</li>
<li>tests for protected subprograms and entries are not supported;</li>
<li>pragma <code class="docutils literal"><span class="pre">No_Run_Time</span></code> is not supported;</li>
<li>pragma <code class="docutils literal"><span class="pre">No_Secondary_Stack</span></code> is not supported;</li>
<li>if pragmas for interfacing with foreign languages are used, manual
adjustments might be necessary to make the test harness compilable;</li>
<li>use of some constructs, such as elaboration-control pragmas, Type_Invariant
aspects, and complex variable initializations that use Subprogram&#8217;Access,
may result in elaboration circularities in the generated harness.</li>
</ul>
</div>
</div>
<div class="section" id="translating-code-addresses-into-source-locations-with-gnatsymbolize">
<span id="the-backtrace-symbolizer-gnatsymbolize"></span><h2>5.11. Translating Code Addresses into Source Locations with <code class="docutils literal"><span class="pre">gnatsymbolize</span></code><a class="headerlink" href="#translating-code-addresses-into-source-locations-with-gnatsymbolize" title="Permalink to this headline">¶</a></h2>
<p id="index-338"><code class="docutils literal"><span class="pre">gnatsymbolize</span></code> is a program which translates addresses into
their corresponding filename, line number, and function names.</p>
<div class="section" id="running-gnatsymbolize">
<h3>5.11.1. Running <code class="docutils literal"><span class="pre">gnatsymbolize</span></code><a class="headerlink" href="#running-gnatsymbolize" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ gnatsymbolize [ switches ] filename [ addresses ]
</pre></div>
</div>
<p>For instance, consider the following Ada program:</p>
<blockquote>
<div><div class="highlight-ada"><div class="highlight"><pre><span></span><span class="k">package </span><span class="nf">Pck</span> <span class="kr">is</span><span class="p"></span>
   <span class="n">Global_Val</span> <span class="o">:</span> <span class="n">Integer</span> <span class="o">:=</span> <span class="mi">0</span><span class="p">;</span>
   <span class="k">procedure </span><span class="nf">Call_Me_First</span><span class="p">;</span>
<span class="k">end </span><span class="nf">Pck</span><span class="p">;</span>

<span class="kr">with</span><span class="nn"> GNAT.IO;</span> <span class="kr">use</span><span class="p"> </span><span class="n">GNAT.IO</span><span class="p">;</span>
<span class="kr">with</span><span class="nn"> GNAT.Traceback;</span> <span class="kr">use</span><span class="p"> </span><span class="n">GNAT.Traceback</span><span class="p">;</span>
<span class="kr">with</span><span class="nn"> GNAT.Debug_Utilities;</span>
<span class="k">package body </span><span class="nf">Pck</span> <span class="kr">is</span><span class="p"></span>
   <span class="k">procedure </span><span class="nf">Call_Me_Third</span> <span class="kr">is</span><span class="p"></span>
      <span class="n">TB</span> <span class="o">:</span> <span class="n">Tracebacks_Array</span> <span class="o">(</span><span class="mi">1</span> <span class="o">..</span> <span class="mi">5</span><span class="o">)</span><span class="p">;</span>
      <span class="n">TB_len</span> <span class="o">:</span> <span class="n">Natural</span><span class="p">;</span>
   <span class="kr">begin</span><span class="p"></span>
      <span class="n">Global_Val</span> <span class="o">:=</span> <span class="n">Global_Val</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>

      <span class="n">Call_Chain</span> <span class="o">(</span><span class="n">TB</span><span class="p">,</span> <span class="n">TB_Len</span><span class="o">)</span><span class="p">;</span>
      <span class="kr">for</span><span class="p"> </span><span class="n">K</span> <span class="kr">in</span><span class="p"> </span><span class="mi">1</span> <span class="o">..</span> <span class="n">TB_Len</span> <span class="kr">loop</span><span class="p"></span>
         <span class="n">Put_Line</span> <span class="o">(</span><span class="n">GNAT.Debug_Utilities.Image_C</span> <span class="o">(</span><span class="n">TB</span> <span class="o">(</span><span class="n">K</span><span class="o">)))</span><span class="p">;</span>
      <span class="k">end loop</span><span class="p">;</span>
   <span class="k">end </span><span class="nf">Call_Me_Third</span><span class="p">;</span>

   <span class="k">procedure </span><span class="nf">Call_Me_Second</span> <span class="kr">is</span><span class="p"></span>
   <span class="kr">begin</span><span class="p"></span>
      <span class="n">Call_Me_Third</span><span class="p">;</span>
   <span class="k">end </span><span class="nf">Call_Me_Second</span><span class="p">;</span>

   <span class="k">procedure </span><span class="nf">Call_Me_First</span> <span class="kr">is</span><span class="p"></span>
   <span class="kr">begin</span><span class="p"></span>
      <span class="n">Call_Me_Second</span><span class="p">;</span>
   <span class="k">end </span><span class="nf">Call_Me_First</span><span class="p">;</span>
<span class="k">end </span><span class="nf">Pck</span><span class="p">;</span>
<span class="kr">with</span><span class="nn"> Pck;</span> <span class="kr">use</span><span class="p"> </span><span class="n">Pck</span><span class="p">;</span>

<span class="k">procedure </span><span class="nf">Foo</span> <span class="kr">is</span><span class="p"></span>
<span class="kr">begin</span><span class="p"></span>
   <span class="n">Global_Val</span> <span class="o">:=</span> <span class="mi">123</span><span class="p">;</span>
   <span class="n">Call_Me_First</span><span class="p">;</span>
<span class="k">end </span><span class="nf">Foo</span><span class="p">;</span>
</pre></div>
</div>
</div></blockquote>
<p>This program, when built and run, prints a list of addresses which
correspond to the traceback when inside function <code class="docutils literal"><span class="pre">Call_Me_Third</span></code>.
For instance, on x86_64 GNU/Linux:</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span>$ gnatmake -g -q foo.adb
$ ./foo
0x0000000000402561
0x00000000004025EF
0x00000000004025FB
0x0000000000402611
0x00000000004024C7
</pre></div>
</div>
</div></blockquote>
<p><code class="docutils literal"><span class="pre">gnatsymbolize</span></code> can be used to translate those addresses into
code locations as follow:</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span>$ gnatsymbolize foo 0x0000000000402561 0x00000000004025EF \
    0x00000000004025FB 0x0000000000402611 0x00000000004024C7
Pck.Call_Me_Third at pck.adb:12
Pck.Call_Me_Second at pck.adb:20
Pck.Call_Me_First at pck.adb:25
Foo at foo.adb:6
Main at b~foo.adb:184
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="switches-for-gnatsymbolize">
<h3>5.11.2. Switches for <code class="docutils literal"><span class="pre">gnatsymbolize</span></code><a class="headerlink" href="#switches-for-gnatsymbolize" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal"><span class="pre">gnatsymbolize</span></code> recognizes the following switches:</p>
<dl class="docutils" id="index-339">
<dt><code class="switch docutils literal"><span class="pre">--help</span></code></dt>
<dd>Display the program&#8217;s usage, and then exit, disregarding all other
options.</dd>
<dt><code class="switch docutils literal"><span class="pre">--cache</span></code></dt>
<dd><p class="first">Read the symbolic information from the executable and cache them
in memory in order to accelerate the translation of each address
into a symbolic location.</p>
<p class="last">Depending on the size of the executable and the number of addresses
to translate, this may not always make <code class="docutils literal"><span class="pre">gnatsymbolize</span></code> faster
overall.</p>
</dd>
<dt><code class="switch docutils literal"><span class="pre">--dump</span></code></dt>
<dd>If <code class="switch docutils literal"><span class="pre">--cache</span></code> is used, dump the contents of the cache on
Standard Output. Has no effect otherwise.</dd>
<dt><code class="switch docutils literal"><span class="pre">--count=</span><em><span class="pre">N</span></em></code></dt>
<dd>If specified, compute the symbolic traceback <code class="docutils literal"><span class="pre">N</span></code> times in a row.
This option is mostly useful for measuring the performance of
<code class="docutils literal"><span class="pre">gnatsymbolize</span></code>, particularly in the case where the cache is
being used.</dd>
</dl>
</div>
<div class="section" id="requirements-for-correct-operation">
<h3>5.11.3. Requirements for Correct Operation<a class="headerlink" href="#requirements-for-correct-operation" title="Permalink to this headline">¶</a></h3>
<p>The translation is performed by reading the DWARF debugging
information produced by the compiler for each unit. All units
for which the translation is to be done must therefore be compiled
such that DWARF debugging information is produced. In most cases,
this is done by simply compiling with <code class="docutils literal"><span class="pre">-g</span></code>.</p>
<p>This program provides a functionality similar to <code class="docutils literal"><span class="pre">addr2line</span></code>.
It has fewer options to tailor its output, but has been designed
to require fewer of the DWARF sections to be present in the
executable. In particular, the following sections can be
stripped from the executable without impact to <code class="docutils literal"><span class="pre">gnatsymbolize</span></code>&#8216;s
functionality:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">.debug_str</span></code></li>
<li><code class="docutils literal"><span class="pre">.debug_ranges</span></code></li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="using-project-files-with-gnat-tools">
<span id="id72"></span><h2>5.12. Using Project Files with GNAT Tools<a class="headerlink" href="#using-project-files-with-gnat-tools" title="Permalink to this headline">¶</a></h2>
<p>This section describes how project files can be used in conjunction
with a number of GNAT tools.
For a comprehensive description of project files and the overall
GNAT Project Manager facility, please refer to the
<em>GNAT Project Manager</em> chapter in the
<em>GPRbuild and GPR Companion Tools User&#8217;s Guide</em>.</p>
<p id="index-340">If a tool can take a project file as an option and extract the needed
information, such a tool is called a <em>project-aware</em> tool.</p>
<div class="section" id="switches-related-to-project-files">
<span id="id73"></span><h3>5.12.1. Switches Related to Project Files<a class="headerlink" href="#switches-related-to-project-files" title="Permalink to this headline">¶</a></h3>
<p>The following switches are used by the project-aware GNAT tools:</p>
<dl class="docutils">
<dt><code class="switch docutils literal"><span class="pre">-P</span><em><span class="pre">project_file</span></em></code></dt>
<dd>Indicates the name of the project file whose source files are to
be processed. The exact set of sources depends on other options
specified, see below.</dd>
<dt><code class="switch docutils literal"><span class="pre">-U</span></code></dt>
<dd>If a project file is supplied, say for project <code class="docutils literal"><span class="pre">proj</span></code>,
but no sources are specified for <code class="docutils literal"><span class="pre">proj</span></code> (either by a
project attribute or through a tool option that provides a list
of the files to be used), process all the source files
from projects imported either directly or indirectly by <code class="docutils literal"><span class="pre">proj</span></code>.
Otherwise this option has no effect.</dd>
<dt><code class="switch docutils literal"><span class="pre">-U</span> <em><span class="pre">source_file</span></em></code></dt>
<dd>Similar to <code class="switch docutils literal"><span class="pre">-U</span></code>, but if no sources are specified then
process only those source files for units in the closure of
the Ada source contained in <code class="docutils literal"><span class="pre">source_file</span></code>. Note that this option
expects the source file name but not the Ada unit name as its
parameter.</dd>
<dt><code class="switch docutils literal"><span class="pre">-X</span><em><span class="pre">name</span></em><span class="pre">=</span><em><span class="pre">val</span></em></code></dt>
<dd>Indicates that the external variable <code class="docutils literal"><span class="pre">name</span></code> in the project has the
value <code class="docutils literal"><span class="pre">val</span></code>. Has no effect if no project has been specified.</dd>
<dt><code class="switch docutils literal"><span class="pre">--subdirs=</span><em><span class="pre">dir</span></em></code></dt>
<dd>Use the <code class="docutils literal"><span class="pre">dir</span></code> subdirectory of the project&#8217;s object directory (or the <code class="docutils literal"><span class="pre">dir</span></code>
subdirectory of the project file directory if the project does not specify
an object directory) for tool output files. Has no effect if no project
has been specified or if <code class="switch docutils literal"><span class="pre">--no_objects_dir</span></code> is specified.</dd>
<dt><code class="switch docutils literal"><span class="pre">--no_objects_dir</span></code></dt>
<dd>Place all the result files into the current directory (i.e., the directory
from which the tool invocation command is issued) instead of the project&#8217;s
object directory. Has no effect if no project has been specified.</dd>
<dt><code class="switch docutils literal"><span class="pre">-eL</span></code></dt>
<dd>Follow all symbolic links when processing project files.</dd>
</dl>
<p>If a project file is specified and there is neither a <code class="switch docutils literal"><span class="pre">-U</span></code> option,
nor a <code class="switch docutils literal"><span class="pre">-U</span> <em><span class="pre">main_unit</span></em></code> option, nor some other explicit option to
specify the source files, then the sources to be processed are the
immediate sources of the specified project (i.e., the source files directly
defined by that project, either implicitly by residing in the project
source directories, or explicitly through any of the source-related
attributes).</p>
</div>
<div class="section" id="tool-specific-packages-in-project-files">
<span id="id74"></span><h3>5.12.2. Tool-specific packages in project files<a class="headerlink" href="#tool-specific-packages-in-project-files" title="Permalink to this headline">¶</a></h3>
<p>Each project-aware tool may have a corresponding package in a project file;
the package names are given elsewhere in this manual, in the sections that describe
the respective tools.</p>
<p>A tool-specific package in a project file may define the <code class="docutils literal"><span class="pre">Default_Switches</span></code>
attribute indexed by &#8220;ada&#8221; (as language name). The value of this attribute
is a list of switches that will be supplied at tool invocation.
Project-specific switches cannot be specified through this attribute.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="gnat_and_program_execution.html" title="6. GNAT and Program Execution"
             >next</a> |</li>
        <li class="right" >
          <a href="building_executable_programs_with_gnat.html" title="4. Building Executable Programs with GNAT"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../gnat_ugn.html">GNAT User&#39;s Guide for Native Platforms 2019 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2008-2019, Free Software Foundation.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.2.
    </div>
  </body>
</html>