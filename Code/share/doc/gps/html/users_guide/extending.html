<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>15. Customizing and Extending GPS &#8212; GPS 19.1 documentation</title>
    
    <link rel="stylesheet" href="_static/adacore.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '19.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="16. Environment" href="environment.html" />
    <link rel="prev" title="14. Using GPS for Remote Development" href="remote.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="environment.html" title="16. Environment"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="remote.html" title="14. Using GPS for Remote Development"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">GPS 19.1 documentation</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/adacore_transparent.png" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">15. Customizing and Extending GPS</a><ul>
<li><a class="reference internal" href="#color-themes">15.1. Color Themes</a></li>
<li><a class="reference internal" href="#custom-fonts">15.2. Custom Fonts</a></li>
<li><a class="reference internal" href="#the-key-shortcuts-editor">15.3. The Key Shortcuts Editor</a></li>
<li><a class="reference internal" href="#editing-plugins">15.4. Editing Plugins</a></li>
<li><a class="reference internal" href="#customizing-through-xml-and-python-files">15.5. Customizing through XML and Python files</a><ul>
<li><a class="reference internal" href="#customization-files-and-plugins">15.5.1. Customization files and plugins</a><ul>
<li><a class="reference internal" href="#python-files">15.5.1.1. Python files</a></li>
<li><a class="reference internal" href="#xml-files">15.5.1.2. XML files</a></li>
</ul>
</li>
<li><a class="reference internal" href="#defining-actions">15.5.2. Defining Actions</a></li>
<li><a class="reference internal" href="#macro-arguments">15.5.3. Macro arguments</a></li>
<li><a class="reference internal" href="#filtering-actions">15.5.4. Filtering actions</a><ul>
<li><a class="reference internal" href="#the-filters-tags">15.5.4.1. The filters tags</a></li>
</ul>
</li>
<li><a class="reference internal" href="#adding-new-menus">15.5.5. Adding new menus</a></li>
<li><a class="reference internal" href="#adding-contextual-menus">15.5.6. Adding contextual menus</a></li>
<li><a class="reference internal" href="#adding-tool-bar-buttons">15.5.7. Adding tool bar buttons</a></li>
<li><a class="reference internal" href="#binding-actions-to-keys">15.5.8. Binding actions to keys</a></li>
<li><a class="reference internal" href="#configuring-preferences">15.5.9. Configuring preferences</a><ul>
<li><a class="reference internal" href="#creating-new-preferences">15.5.9.1. Creating new preferences</a></li>
<li><a class="reference internal" href="#setting-preferences-values">15.5.9.2. Setting preferences values</a></li>
</ul>
</li>
<li><a class="reference internal" href="#creating-themes">15.5.10. Creating themes</a></li>
<li><a class="reference internal" href="#defining-new-search-patterns">15.5.11. Defining new search patterns</a></li>
<li><a class="reference internal" href="#defining-custom-highlighters">15.5.12. Defining custom highlighters</a><ul>
<li><a class="reference internal" href="#tutorial-add-support-for-python-highlighting-in-gps">15.5.12.1. Tutorial: Add support for python highlighting in GPS</a><ul>
<li><a class="reference internal" href="#first-step-creating-a-dumb-highlighter">15.5.12.1.1. First step, creating a dumb highlighter</a></li>
<li><a class="reference internal" href="#second-step-discovering-our-first-helper">15.5.12.1.2. Second step, discovering our first helper</a></li>
<li><a class="reference internal" href="#third-step-highlighting-strings-literals-in-a-clever-way">15.5.12.1.3. Third step, highlighting strings literals in a clever way</a></li>
<li><a class="reference internal" href="#creating-custom-style-tags">15.5.12.1.4. Creating custom style tags</a></li>
<li><a class="reference internal" href="#going-further">15.5.12.1.5. Going further</a></li>
</ul>
</li>
<li><a class="reference internal" href="#api-documentation">15.5.12.2. API Documentation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#adding-support-for-new-languages">15.5.13. Adding support for new languages</a><ul>
<li><a class="reference internal" href="#adding-support-for-a-new-language-via-the-python-interface">15.5.13.1. Adding support for a new language via the Python interface</a></li>
<li><a class="reference internal" href="#adding-support-for-a-new-language-via-the-xml-interface">15.5.13.2. Adding support for a new language via the XML interface</a></li>
</ul>
</li>
<li><a class="reference internal" href="#defining-text-aliases">15.5.14. Defining text aliases</a></li>
<li><a class="reference internal" href="#alias-files">15.5.15. Alias files</a></li>
<li><a class="reference internal" href="#defining-project-attributes">15.5.16. Defining project attributes</a><ul>
<li><a class="reference internal" href="#declaring-the-new-attributes">15.5.16.1. Declaring the new attributes</a></li>
<li><a class="reference internal" href="#declaring-the-type-of-the-new-attributes">15.5.16.2. Declaring the type of the new attributes</a></li>
<li><a class="reference internal" href="#examples">15.5.16.3. Examples</a></li>
<li><a class="reference internal" href="#accessing-project-attributes">15.5.16.4. Accessing project attributes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#adding-casing-exceptions">15.5.17. Adding casing exceptions</a></li>
<li><a class="reference internal" href="#adding-documentation">15.5.18. Adding documentation</a></li>
<li><a class="reference internal" href="#adding-custom-icons">15.5.19. Adding custom icons</a></li>
<li><a class="reference internal" href="#customizing-remote-programming">15.5.20. Customizing Remote Programming</a><ul>
<li><a class="reference internal" href="#defining-a-remote-connection-tool">15.5.20.1. Defining a remote connection tool</a></li>
<li><a class="reference internal" href="#defining-a-shell">15.5.20.2. Defining a shell</a></li>
<li><a class="reference internal" href="#configuring-rsync-usage">15.5.20.3. Configuring <strong class="command">rsync</strong> usage</a></li>
<li><a class="reference internal" href="#defining-a-remote-server">15.5.20.4. Defining a remote server</a></li>
<li><a class="reference internal" href="#defining-a-remote-path-translation">15.5.20.5. Defining a remote path translation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#customizing-build-targets-and-models">15.5.21. Customizing Build Targets and Models</a><ul>
<li><a class="reference internal" href="#defining-new-target-models">15.5.21.1. Defining new Target Models</a></li>
<li><a class="reference internal" href="#defining-new-targets">15.5.21.2. Defining new Targets</a></li>
<li><a class="reference internal" href="#processing-target-s-output">15.5.21.3. Processing Target&#8217;s Output</a></li>
<li><a class="reference internal" href="#defining-new-modes">15.5.21.4. Defining new Modes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#customizing-toolchains">15.5.22. Customizing Toolchains</a></li>
</ul>
</li>
<li><a class="reference internal" href="#adding-support-for-new-tools">15.6. Adding support for new tools</a><ul>
<li><a class="reference internal" href="#defining-supported-languages">15.6.1. Defining supported languages</a></li>
<li><a class="reference internal" href="#defining-the-default-command-line">15.6.2. Defining the default command line</a></li>
<li><a class="reference internal" href="#defining-tool-switches">15.6.3. Defining tool switches</a></li>
<li><a class="reference internal" href="#executing-external-tools">15.6.4. Executing external tools</a><ul>
<li><a class="reference internal" href="#chaining-commands">15.6.4.1. Chaining commands</a></li>
<li><a class="reference internal" href="#saving-open-windows">15.6.4.2. Saving open windows</a></li>
<li><a class="reference internal" href="#querying-project-switches">15.6.4.3. Querying project switches</a></li>
<li><a class="reference internal" href="#querying-switches-interactively">15.6.4.4. Querying switches interactively</a></li>
<li><a class="reference internal" href="#redirecting-the-command-output">15.6.4.5. Redirecting the command output</a></li>
<li><a class="reference internal" href="#processing-the-tool-output">15.6.4.6. Processing the tool output</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#customization-examples">15.7. Customization examples</a><ul>
<li><a class="reference internal" href="#menu-example">15.7.1. Menu example</a></li>
<li><a class="reference internal" href="#tool-example">15.7.2. Tool example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#scripting-gps">15.8. Scripting GPS</a><ul>
<li><a class="reference internal" href="#scripts">15.8.1. Scripts</a></li>
<li><a class="reference internal" href="#scripts-and-gps-actions">15.8.2. Scripts and GPS actions</a></li>
<li><a class="reference internal" href="#the-gps-shell">15.8.3. The GPS Shell</a></li>
<li><a class="reference internal" href="#the-python-interpreter">15.8.4. The Python Interpreter</a></li>
<li><a class="reference internal" href="#python-modules">15.8.5. Python modules</a></li>
<li><a class="reference internal" href="#subprogram-parameters">15.8.6. Subprogram parameters</a></li>
<li><a class="reference internal" href="#python-faq">15.8.7. Python FAQ</a><ul>
<li><a class="reference internal" href="#hello-world-in-python">15.8.7.1. Hello World! in python</a></li>
<li><a class="reference internal" href="#spawning-external-processes">15.8.7.2. Spawning external processes</a></li>
<li><a class="reference internal" href="#redirecting-the-output-of-spawned-processes">15.8.7.3. Redirecting the output of spawned processes</a></li>
<li><a class="reference internal" href="#contextual-menus-on-object-directories-only">15.8.7.4. Contextual menus on object directories only</a></li>
<li><a class="reference internal" href="#redirecting-the-output-to-specific-windows">15.8.7.5. Redirecting the output to specific windows</a></li>
<li><a class="reference internal" href="#reloading-a-python-file-in-gps">15.8.7.6. Reloading a Python file in GPS</a></li>
<li><a class="reference internal" href="#printing-the-gps-python-documentation">15.8.7.7. Printing the GPS Python documentation</a></li>
<li><a class="reference internal" href="#automatically-loading-python-files-at-startup">15.8.7.8. Automatically loading python files at startup</a></li>
<li><a class="reference internal" href="#hiding-contextual-menus">15.8.7.9. Hiding contextual menus</a></li>
<li><a class="reference internal" href="#creating-custom-graphical-interfaces">15.8.7.10. Creating custom graphical interfaces</a></li>
</ul>
</li>
<li><a class="reference internal" href="#hooks">15.8.8. Hooks</a><ul>
<li><a class="reference internal" href="#adding-commands-to-hooks">15.8.8.1. Adding commands to hooks</a></li>
<li><a class="reference internal" href="#action-hooks">15.8.8.2. Action hooks</a></li>
<li><a class="reference internal" href="#running-hooks">15.8.8.3. Running hooks</a></li>
<li><a class="reference internal" href="#creating-new-hooks">15.8.8.4. Creating new hooks</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#the-server-mode">15.9. The Server Mode</a></li>
<li><a class="reference internal" href="#adding-project-templates">15.10. Adding project templates</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="remote.html"
                        title="previous chapter">14. Using GPS for Remote Development</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="environment.html"
                        title="next chapter">16. Environment</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/extending.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="customizing-and-extending-gps">
<span id="id1"></span><h1>15. Customizing and Extending GPS<a class="headerlink" href="#customizing-and-extending-gps" title="Permalink to this headline">¶</a></h1>
<p id="index-0">GPS provides several levels of customization, from simple preference
dialogs to powerful scripting capability through the Python language.  This
chapters describes each of these capabilities.</p>
<div class="section" id="color-themes">
<h2>15.1. Color Themes<a class="headerlink" href="#color-themes" title="Permalink to this headline">¶</a></h2>
<p id="index-1">The <span class="guilabel">Color Theme window</span> shows a list of color themes to choose
from, presented in the form of a list of screenshots. Clicking on the button
underneath a screenshot applies the given color theme to GPS.</p>
<p>Applying a color theme modifies the corresponding GPS preferences. It is
therefore possible to customize the colors after a theme has been applied,
through the preferences dialog.</p>
<p>GPS supports importing themes which use the TextMate (<code class="file docutils literal"><span class="pre">.tmTheme</span></code>)
format: at startup, GPS will look in the directory
<code class="file docutils literal"><span class="pre">GPS_HOME/.gps/themes/</span></code> and will include all the
<code class="file docutils literal"><span class="pre">.tmTheme</span></code> found at the first level of this subdirectory. You can
also import your themes in the <code class="file docutils literal"><span class="pre">INSTALL/share/gps/color_themes/themes/</span></code>
directory if you want to share themes accross your team.</p>
</div>
<div class="section" id="custom-fonts">
<h2>15.2. Custom Fonts<a class="headerlink" href="#custom-fonts" title="Permalink to this headline">¶</a></h2>
<p id="index-2">In addition to the system fonts, GPS will load the fonts located under
<code class="file docutils literal"><span class="pre">share/gps/fonts</span></code>) in the GPS installation directory. The supported
formats are <code class="file docutils literal"><span class="pre">.otf</span></code>, <code class="file docutils literal"><span class="pre">.ttf</span></code> and <code class="file docutils literal"><span class="pre">.ttc</span></code>.</p>
<p>This mechanism works only on UNIX/Linux systems; under Windows, fonts
need to be added at the system level. Fonts that are added directly in this
directory may not show up in the list of fonts in the preferences dialog,
but it is still possible to use them by entering the font name manually.</p>
</div>
<div class="section" id="the-key-shortcuts-editor">
<span id="index-3"></span><span id="id2"></span><h2>15.3. The Key Shortcuts Editor<a class="headerlink" href="#the-key-shortcuts-editor" title="Permalink to this headline">¶</a></h2>
<img alt="_images/key-shortcuts.png" src="_images/key-shortcuts.png" />
<p>This editor is started through the <span class="menuselection">Edit ‣ Preferences</span>
menu, then by selecting the <span class="guilabel">Preferences</span> page.
It provides a convenient way to edit the keyboard shortcuts that
are available throughout GPS.</p>
<p>All keyboard shortcuts are associated with actions, which are either
predefined in GPS, or defined in your customization python files,
as documented in <a class="reference internal" href="#customizing-through-xml-and-python-files"><span class="std std-ref">Customizing through XML and Python files</span></a>.
The main part of the editor is a list showing all actions that are defined
in GPS, grouped into categories.</p>
<p>There are literally hundreds of such actions, and finding the one you should
use might be difficult. To simplify the search, you can use the filter field at
the top-right corner of the editor. Typing any text in this field will restrict
the list of actions to those that contain the text either in their name, their
description, their keyboard shortcut, or the menus the action is bound to.
Entering keyboard shortcut is in fact easier done via the <span class="guilabel">Grab</span>
button next to the filter field. Click on it, then type the shortcut you are
looking for.</p>
<p>By using the local configuration menu (click on the top-right button of the
editor), you can further restrict what is displayed in the editor:</p>
<ul class="simple">
<li><span class="guilabel">Shortcuts only</span> will only display the actions that have an actual
shortcut, and hide all the others.</li>
<li><span class="guilabel">Show categories</span> can be unset if you just want to display a flat
list of all the actions.</li>
<li>All menus in GPS are themselves bound to actions. In general, it is better
to associate a key shortcut to the action itself, as opposed to the menu.
For this reason, GPS by default does not list all the menus in the keyboard
shortcuts editor. However, historically, GPS used to show all menus there
and you can get this behavior back by enabling the
<span class="guilabel">Show all menus</span> configuration.</li>
</ul>
<p>When you select an action, GPS will display its documentation in the bottom
part of the editor. This documentation also includes a pointer to the python
file that defines the action (or whether it is built-in in GPS), as well as the
list of menus that will execute this action when selected.</p>
<p>Finally, the editor includes a set of buttons on its right side, which are
grouped into two logical sets:</p>
<ul>
<li><p class="first">The top three buttons allow you to control <cite>Key themes</cite>. These are sets of
keyboard shortcuts that are either provided as part of GPS (for instance
GPS provides an <span class="target" id="index-4"></span>Emacs key theme which attempts to emulate some of
the Emacs key bindings) or created by the user.</p>
<p>The first box lists all known themes, and lets you alternate between them
simply by selecting their name. This will unset all existing key bindings
except the ones you have set manually, and replace them with the shortcuts
loaded from the key theme. This also updates all the menus to reflect the
new shortcuts.</p>
<p>The <span class="guilabel">Reset</span> button will discard all the key bindings you have
manually overridden, and revert to the theme&#8217;s default key bindings.</p>
<p>The <span class="guilabel">Create</span> lets you create a new key theme by copying all
the current shortcuts (those from the theme and the ones you have set
manually) into a new theme. In effect, this creates a new XML file
in the directory <code class="file docutils literal"><span class="pre">$HOME/.gps/key_themes</span></code>. Removing a custom key
theme is done by deleting the file from that directory, no GUI is
provided for this at the moment.</p>
</li>
<li><p class="first">The second group of buttons lets you edit the shortcut for the currently
selected action either by removing a shortcut, or by overriding the
ones that are currently set.</p>
<p>When you click on the <span class="guilabel">Add</span> button, GPS waits for you to
press any keyboard shortcut you wish to associate with the action. This
shortcut can include multiple keys, so for instance to get an Emacs-like
binding you could for instance press <code class="kbd docutils literal"><span class="pre">Ctrl-x</span></code> and then press
<code class="kbd docutils literal"><span class="pre">Ctrl-k</span></code>. After pressing the last key in the sequence, wait for a
short delay and GPS will associate the resulting shortcut to the action
and update the menus, when relevant, to show the new binding. Note that
multi-key shortcuts cannot be displayed in menus due to technical
limitations of the GUI toolkit.</p>
</li>
</ul>
<p>Any change to the shortcuts is immediately and automatically saved, so that
they become instantly usable in GPS, and will be restored properly when GPS
is restarted.</p>
</div>
<div class="section" id="editing-plugins">
<span id="id3"></span><h2>15.4. Editing Plugins<a class="headerlink" href="#editing-plugins" title="Permalink to this headline">¶</a></h2>
<p id="index-5">You can extensively customize GPS through external plugins, either ones
you write (see <a class="reference internal" href="#customization-files-and-plugins"><span class="std std-ref">Customization files and plugins</span></a>) or using one of the
plugins in GPS&#8217;s own collection.</p>
<p>Some plugins are loaded by default when GPS starts (such as support for
the CVS version management system and support for highlighting in various
programming languages) and others are available but not loaded
automatically, such as Emacs emulation mode.</p>
<p>Some plugins provided with GPS are:</p>
<ul>
<li><p class="first"><code class="file docutils literal"><span class="pre">Makefile</span></code> support</p>
<p id="index-6">A plugin that parses a <code class="file docutils literal"><span class="pre">Makefile</span></code> and creates menus for each of
its targets so you can easily start a <strong class="command">make</strong> command.</p>
</li>
<li><p class="first">Cross-references enhancements</p>
<p>Some plugins take advantage of GPS&#8217;s cross-references information to
create additional menus for navigation such as jumping to the primitive
operations of Ada tagged types and to the body of Ada separate entities.</p>
</li>
<li><p class="first">Text manipulation</p>
<p>Several plugins provide support for advanced text manipulation in the
editors, for example to align a set of lines based on various criteria
or to manipulate a rectangular selection of text.</p>
</li>
</ul>
<p>You can graphically choose which plugins are loaded on startup by
opening the preferences editor dialog (<span class="menuselection">Edit ‣
Preferences...</span> menu), under the <span class="guilabel">Plugins</span> section. This section
lists all the known plugins on the left. By selecting one particular
plugin, the corresponding preferences page is opened on the right. Each
plugin page comes with the same layout:</p>
<ul>
<li><p class="first">A <span class="guilabel">General</span> group</p>
<p>This group indicates the exact location of the plugin file. Moreover,
this group contains a toggle button (<span class="guilabel">Loaded at startup</span>)
which allows you to decide if this plugin should be loaded or not in
the next GPS session.</p>
<p>As described in <a class="reference internal" href="#customization-files-and-plugins"><span class="std std-ref">Customization files and plugins</span></a>, GPS searches for
plugins in various directories and, based on these directories, decides
whether to automatically load the plugin on startup.</p>
</li>
<li><p class="first">An optional <span class="guilabel">Preferences</span> group</p>
<p>This group lists all the preferences related to the selected plugin,
allowing you to customize the plugin behavior. Note that this group
is displayed only if preferences have been registered for this plugin.</p>
</li>
<li><p class="first">A <span class="guilabel">Documentation</span> frame</p>
<p>This frame displays the plugin file documentation. By convention,
each plugin starts with a comment indicating the purpose of this
plugin and more detailed documentation on its usage.</p>
</li>
</ul>
<p>If you have modified the list of plugins that should be loaded at startup,
you will need to restart GPS, since it cannot unload a module due to such
an action having too many possible effects on GPS: then, a dialog is
displayed asking you whether you would like to exit GPS when closing the
preferences editor dialog.</p>
<p>All the changes explicitly set by the user in the list of plugins to load
at startup are saved in <code class="file docutils literal"><span class="pre">HOME/.gps/startup.xml</span></code>.</p>
</div>
<div class="section" id="customizing-through-xml-and-python-files">
<span id="id4"></span><h2>15.5. Customizing through XML and Python files<a class="headerlink" href="#customizing-through-xml-and-python-files" title="Permalink to this headline">¶</a></h2>
<div class="section" id="customization-files-and-plugins">
<span id="index-7"></span><span id="id5"></span><h3>15.5.1. Customization files and plugins<a class="headerlink" href="#customization-files-and-plugins" title="Permalink to this headline">¶</a></h3>
<p>You can customize many capabilities in GPS using files it loads at startup.
For example, you can add items to the menu and tool bars as well as
defining new key bindings, languages, and tools.  Using Python as a
programming language, you can also add new facilities and integrate your
own tools into the GPS platform.</p>
<p>GPS searches for these customization files at startup in several different
directories. Depending on where they are found, they are either
automatically loaded by GPS (and thus can immediately modify things in GPS)
or may only be made visible in the <span class="guilabel">Plugins</span> section of the
preferences editor dialog (see <a class="reference internal" href="#editing-plugins"><span class="std std-ref">Editing Plugins</span></a>).</p>
<p>GPS searches these directories in the order given below. Any script loaded
later can override operations performed by previously loaded scripts. For
example, they can override a key shortcut, remove a menu, or redefine a GPS
action.</p>
<p>In each directory name below, <code class="file docutils literal"><span class="pre">INSTALL</span></code> is the name of the directory
in which you have installed GPS. <code class="file docutils literal"><span class="pre">HOME</span></code> is your home directory, either
by default or as overridden by the <code class="file docutils literal"><span class="pre">GPS_HOME</span></code> environment variable.
In each directory, only files with <code class="file docutils literal"><span class="pre">.xml</span></code> or <code class="file docutils literal"><span class="pre">.py</span></code> extensions
are used. Other files are ignored, although for compatibility with future
versions of GPS you should not have keep other files in these directories.</p>
<ul>
<li><p class="first">Automatically-loaded, global modules</p>
<p>The <code class="file docutils literal"><span class="pre">INSTALL/share/gps/plug-ins</span></code> directory contains the files GPS
automatically loads by default (unless overridden by the user via the
<span class="guilabel">Plugins</span> section of the preferences editor dialog). These
plugins are visible to any user on the system using the same GPS
installation.  Reserve this directory for critical plugins that almost
everyone will use.</p>
</li>
<li><p class="first">Not automatically-loaded, global modules</p>
<p>The <code class="file docutils literal"><span class="pre">INSTALL/share/gps/library</span></code> directory contain files GPS
displays in the <span class="guilabel">Plugins</span> section of the preferences editor dialog
but does not load automatically. Typically, these files add optional
capabilities to GPS that many of users generally will not use.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">GPS_CUSTOM_PATH</span></code></p>
<p>Set this environment variable before launching GPS to be a list of
directories, separated by semicolons (&#8216;;&#8217;) on Windows systems and colons
(&#8216;:&#8217;) on Unix systems. All files in these directories with the
appropriate extensions are automatically loaded by default by GPS, unless
overridden by the user through the <span class="guilabel">Plugins</span> section of
the preferences editor dialog.</p>
<p>This is a convenient way to have project-specific customization
files. You can, for example, create scripts that set the
appropriate value for the variable and then start GPS. Depending on your
project, this allows you to load specific aliases which do not make sense
for other projects.</p>
<p>These directories are also used to search for icons referenced in your
plug-ins.</p>
</li>
<li><p class="first">Automatically loaded user directory</p>
<p>The directory <code class="file docutils literal"><span class="pre">HOME/.gps/plug-ins</span></code> is searched last. Any script in
it is loaded automatically unless overridden via the <span class="guilabel">Plugins</span>
section of the preferences editor dialog.</p>
<p>This is a convenient way for you to create your own plugins or test them
before you make them available to all GPS users by copying them to one of
the other directories.</p>
</li>
<li><p class="first">Automatically loaded together with the project</p>
<p>When GPS loads the project file called <code class="file docutils literal"><span class="pre">&lt;your_project&gt;.gpr</span></code>, it will
automatically look for a python file called <code class="file docutils literal"><span class="pre">&lt;your_project&gt;.ide.py</span></code>. In
this file, you are expected to define two parameterless subprograms, called
<span class="guilabel">initialize_project_plugin</span> and <span class="guilabel">finalize_project_plugin</span>;
GPS will call the first one when the project is loaded, and call the second
one if/when another project is loaded.</p>
<p>This method is convenient for providing project-specific behaviors, and means
that the GPS plugin can be checked under version control together with the
project file.</p>
<p>This feature is implemented via a the GPS plugin <code class="file docutils literal"><span class="pre">auto_load.py</span></code>.</p>
</li>
</ul>
<p>Any script loaded by GPS can contain customization for various aspects of
GPS, such as aliases, new languages or menus, in a single file.</p>
<div class="section" id="python-files">
<h4>15.5.1.1. Python files<a class="headerlink" href="#python-files" title="Permalink to this headline">¶</a></h4>
<p>You can format the Python plugin in any way you want (as long as it can be
executed by Python, of course), the following formatting is
suggested. These plugins are visible in the <span class="guilabel">Plugins</span> section
of the preferences editor dialog, so having a common format makes it easier
for users to understand each plugin:</p>
<ul>
<li><p class="first">Comment</p>
<p>Your script should start with a comment on its goal and usage. This
comment should use Python&#8217;s triple-quote convention, rather than the
start-of-line hash (&#8216;#&#8217;) signs.  The first line of the comment should be
a one line explanation of the goal of the script, separated by a blank
line from the rest of the comment.</p>
</li>
<li><p class="first">Implementation</p>
<p>Separate the implementation from the initial comment by a form-feed
(control-L); the startup scripts editor only displays the first page of
the script in the first page of the editor.</p>
<p>If possible, scripts should avoid executing code when they are
loaded. This gives the user a chance to change the value of global
variables or override functions before the script is actually launched.
Instead, you should to connect to the <strong class="command">&quot;gps_started&quot;</strong> hook, as
in:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="o">^</span><span class="n">L</span>
<span class="c1">###########################################################</span>
<span class="c1">## No user customization below this line</span>
<span class="c1">###########################################################</span>

<span class="kn">import</span> <span class="nn">GPS</span>

<span class="k">def</span> <span class="nf">on_gps_started</span> <span class="p">(</span><span class="n">hook_name</span><span class="p">):</span>
   <span class="o">...</span> <span class="n">launch</span> <span class="n">the</span> <span class="n">script</span>

<span class="n">GPS</span><span class="o">.</span><span class="n">Hook</span> <span class="p">(</span><span class="s2">&quot;gps_started&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">add</span> <span class="p">(</span><span class="n">on_gps_started</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="xml-files">
<h4>15.5.1.2. XML files<a class="headerlink" href="#xml-files" title="Permalink to this headline">¶</a></h4>
<p>XML files must be UTF8-encoded by default. In addition, you can specify any
specific encoding through the standard command:<cite>&lt;?xml encoding=&#8221;...&#8221; ?&gt;</cite>
declaration, as in the following example:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;iso-8859-1&quot;?&gt;</span>
<span class="c">&lt;!--  general description --&gt;</span>
<span class="nt">&lt;submenu&gt;</span>
  <span class="nt">&lt;title&gt;</span>encoded text<span class="nt">&lt;/title&gt;</span>
<span class="nt">&lt;/submenu&gt;</span>
</pre></div>
</div>
<p>These files must be valid XML files, i.e. must start with the <cite>&lt;?xml?&gt;</cite> tag
and contain a single root XML node, the name of which is arbitrary.  The
format is therefore:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;root_node&gt;</span>
   ...
<span class="nt">&lt;/root_node&gt;</span>
</pre></div>
</div>
<p>The first line after the <cite>&lt;?xml?&gt;</cite> tag should contain a comment describing
the purpose and usage of the script.  This comment is made visible in the
the preferences page associated with this plugin, under <span class="guilabel">Plugins</span>
section of the preferences editor dialog. The list of valid XML nodes
that you can specify under <code class="file docutils literal"><span class="pre">&lt;root&gt;</span></code> is described in later sections.
It includes:</p>
<ul class="simple">
<li><a class="reference internal" href="#defining-actions"><span class="std std-ref">&lt;action&gt;</span></a></li>
<li><a class="reference internal" href="#binding-actions-to-keys"><span class="std std-ref">&lt;key&gt;</span></a></li>
<li><a class="reference internal" href="#adding-new-menus"><span class="std std-ref">&lt;submenu&gt;</span></a></li>
<li><a class="reference internal" href="#preferences-support-in-custom-files"><span class="std std-ref">&lt;pref&gt;</span></a></li>
<li><a class="reference internal" href="#preferences-support-in-custom-files"><span class="std std-ref">&lt;preference&gt;</span></a></li>
<li><a class="reference internal" href="#defining-text-aliases"><span class="std std-ref">&lt;alias&gt;</span></a></li>
<li><a class="reference internal" href="#adding-support-for-new-languages"><span class="std std-ref">&lt;language&gt;</span></a></li>
<li><a class="reference internal" href="#adding-tool-bar-buttons"><span class="std std-ref">&lt;button&gt;</span></a></li>
<li><a class="reference internal" href="#adding-tool-bar-buttons"><span class="std std-ref">&lt;entry&gt;</span></a></li>
<li><a class="reference internal" href="#defining-new-search-patterns"><span class="std std-ref">&lt;vsearch-pattern&gt;</span></a></li>
<li><a class="reference internal" href="#adding-support-for-new-tools"><span class="std std-ref">&lt;tool&gt;</span></a></li>
<li><a class="reference internal" href="#filtering-actions"><span class="std std-ref">&lt;filter&gt;</span></a></li>
<li><a class="reference internal" href="#adding-contextual-menus"><span class="std std-ref">&lt;contextual&gt;</span></a></li>
<li><a class="reference internal" href="#adding-casing-exceptions"><span class="std std-ref">&lt;case_exceptions&gt;</span></a></li>
<li><a class="reference internal" href="#adding-documentation"><span class="std std-ref">&lt;documentation_file&gt;</span></a></li>
<li><a class="reference internal" href="#adding-documentation"><span class="std std-ref">&lt;doc_path&gt;</span></a></li>
<li><a class="reference internal" href="#defining-project-attributes"><span class="std std-ref">&lt;project_attribute&gt;</span></a></li>
<li><a class="reference internal" href="#defining-a-remote-server"><span class="std std-ref">&lt;remote_machine_descriptor&gt;</span></a></li>
<li><a class="reference internal" href="#defining-a-remote-path-translation"><span class="std std-ref">&lt;remote_path_config&gt;</span></a></li>
<li><a class="reference internal" href="#defining-a-remote-connection-tool"><span class="std std-ref">&lt;remote_connection_config&gt;</span></a></li>
<li><a class="reference internal" href="#configuring-rsync-usage"><span class="std std-ref">&lt;rsync_configuration&gt;</span></a></li>
</ul>
</div>
</div>
<div class="section" id="defining-actions">
<span id="id6"></span><h3>15.5.2. Defining Actions<a class="headerlink" href="#defining-actions" title="Permalink to this headline">¶</a></h3>
<span class="target" id="index-8"></span><span class="target" id="index-9"></span><span class="target" id="index-10"></span><span class="target" id="index-11"></span><p id="index-12">This mechanism links actions to their associated menus or key
bindings. Actions can take several forms: external commands, shell
commands and predefined commands, each explained in more detail below.</p>
<p>Define new actions using the <code class="file docutils literal"><span class="pre">&lt;action&gt;</span></code> tag.  This tag accepts the
following attributes:</p>
<ul>
<li><p class="first"><code class="file docutils literal"><span class="pre">name</span></code> (required)</p>
<p>The name by which the action is referenced elsewhere in the customization
files, for example when it is associated with a menu or toolbar button.
It can contain any character, although you should avoid XML special
characters and it cannot start with a &#8216;/&#8217;.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">output</span></code> (optional)</p>
<p>Where the output of the commands are sent by default.  You can override
this for each command using the same attribute for <code class="file docutils literal"><span class="pre">&lt;shell&gt;</span></code> and
<code class="file docutils literal"><span class="pre">&lt;external&gt;</span></code> tags.  See <a class="reference internal" href="#redirecting-the-command-output"><span class="std std-ref">Redirecting the command output</span></a>.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">show-command</span></code> (optional, default <strong class="command">true</strong>)</p>
<p>Whether the text of the command itself should be displayed in the same
place as its output. Neither are displayed if the output is hidden. The
default shows the command along with its output.  You can override this
attribute for each command.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">show-task-manager</span></code> (optional, default <strong class="command">false</strong>)</p>
<p>Whether an entry is in the tasks view to show this command. The
progress bar indication is associated with this entry so if you hide the
entry, no progress bar is shown. Alternatively, several progress bars may
displayed for your action if this is enabled, which might be an issue
depending on the context.  You can override this attribute for each
external command.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">category</span></code> (optional, default <strong class="command">General</strong>)</p>
<p>The category in the key bindings editor
(<span class="menuselection">Edit ‣ Preferences</span> menu) in which the action is
displayed. If you specify an empty string, the action is considered part of
the implementation and not displayed in the editor and the user will not be
able to assign it a key binding through the graphical user interface
(although this can still be done via XML commands).</p>
</li>
</ul>
<p>If you define the same action multiple times, the last definition is used.
However, items such as menus and buttons that reference the action keep
their existing semantics: the new definition is only used for items created
after it is defined.</p>
<p>The <code class="file docutils literal"><span class="pre">&lt;action&gt;</span></code> tag can have one or several children, all of which
specify a command to execute. All commands are executed sequentially unless
one fails, in which case the following commands are ignored.</p>
<p>The valid children of <code class="file docutils literal"><span class="pre">&lt;action&gt;</span></code> are the following XML tags:</p>
<ul>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;external&gt;</span></code></p>
<p id="index-13">Defines a system command (i.e. a standard Unix or Windows command).</p>
<ul>
<li><p class="first"><code class="file docutils literal"><span class="pre">server</span></code> (optional)</p>
<p>Execute the external command on a remote server. The values are
<strong class="command">gps_server</strong> (default), <strong class="command">build_server</strong>,
<strong class="command">execution_server</strong>, <strong class="command">debug_server</strong>, and
<strong class="command">tools_server</strong>.  See <a class="reference internal" href="remote.html#remote-operations"><span class="std std-ref">Remote operations</span></a> for information
on what each of these servers are.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">check-password</span></code> (optional)</p>
<p id="index-14">Tell GPS to check for and handle password prompts from the external
command. The values are false (default) and true.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">show-command</span></code> (optional)</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">output</span></code> (optional)</p>
<p>Override the value of the attribute of the same name specified in the
<code class="file docutils literal"><span class="pre">&lt;action&gt;</span></code> tag.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">progress-regexp</span></code> (optional)</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">progress-current</span></code> (optional, default <strong class="command">1</strong>)</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">progress-final</span></code> (optional, default <strong class="command">2</strong>)</p>
<p><code class="file docutils literal"><span class="pre">progress-regexp</span></code> is a regular expression that GPS matches the
output of the command against. When the regular expression matches, it
must provide two subexpressions whose numeric values represent the
current and total number of steps to perform, which are used to display
the progress indicators at the bottom-right corner of the GPS window.
<code class="file docutils literal"><span class="pre">progress-current</span></code> is the ordinal of the subexpression containing
the current step, and <code class="file docutils literal"><span class="pre">progress-final</span></code> is the ordinal of the
subexpression containing the total number of steps, which grows as
needed. For example, <strong class="program">gnatmake</strong> outputs the number of the file
it is currently compiling and the total number of files to be
compiled. However, that last number may increase, since compiling a new
file may cause additional files to be compiled.</p>
<p>The name of the action is printed in the progress bar while the action is
executing.  Here is an example:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;progress_action&gt;</span>
  <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&quot;progress&quot;</span> <span class="nt">&gt;</span>
    <span class="nt">&lt;external</span>
      <span class="na">progress-regexp=</span><span class="s">&quot;(\\d+) out of (\\d+).*$&quot;</span>
      <span class="na">progress-current=</span><span class="s">&quot;1&quot;</span>
      <span class="na">progress-final=</span><span class="s">&quot;2&quot;</span>
      <span class="na">progress-hide=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;</span>gnatmake foo.adb
    <span class="nt">&lt;/external&gt;</span>
  <span class="nt">&lt;/action&gt;</span>
<span class="nt">&lt;/progress_action&gt;</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">progress-hide</span></code> (optional, default <strong class="command">true</strong>)</p>
<p>If true, all lines matching <code class="file docutils literal"><span class="pre">progress-regexp</span></code> and are used to
compute the progress are not displayed in the output
console. Otherwise, those lines are displayed with the rest of the
output.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">show-task-manager</span></code> (optional, default inherited from
<code class="file docutils literal"><span class="pre">&lt;action&gt;</span></code>)</p>
<p>Whether an entry is created in the tasks view to show this command.
The progress bar indicator is associated with this entry, so if you
hide the entry, no progress is shown. Alternatively, several progress
bars may be displayed for your action if this is enabled, which might
be an issue depending on the context.</p>
<p>If set a value for <cite>progress-regexp</cite>, this attribute is automatically
set to true so the progress bar is displayed in the tasks view.</p>
</li>
</ul>
<p>Note for Windows users: like Unix, scripts can be called from a custom
menu.  To allow that, you need to write your script in a <code class="file docutils literal"><span class="pre">.bat</span></code> or
<code class="file docutils literal"><span class="pre">.cmd</span></code> file and call this file.  So the <code class="file docutils literal"><span class="pre">external</span></code> tag would
look like:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;external_example&gt;</span>
  <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&quot;my_command&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;external&gt;</span>c:\\.gps\\my_scripts\\my_cmd.cmd<span class="nt">&lt;/external&gt;</span>
  <span class="nt">&lt;/action&gt;</span>
<span class="nt">&lt;/external_example&gt;</span>
</pre></div>
</div>
</li>
<li id="index-15"><p class="first"><code class="file docutils literal"><span class="pre">on-failure</span></code></p>
<p>Specifies a command or group of commands to be executed if the previous
external command fails. Typically, this is used to parse the output of the
command and fill the <span class="guilabel">Locations</span> view appropriately
(see <a class="reference internal" href="#processing-the-tool-output"><span class="std std-ref">Processing the tool output</span></a>).</p>
<p>For example, the following action spawns an external tool and parses its
output to the <span class="guilabel">Locations</span> view.  It calls the automatic fixing
tool if the external tool fails.</p>
<p>You can use the %... and $... macros in this group of commands
(see <a class="reference internal" href="#macro-arguments"><span class="std std-ref">Macro arguments</span></a>):</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;action_launch_to_location&gt;</span>
  <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&quot;launch tool to location&quot;</span> <span class="nt">&gt;</span>
    <span class="nt">&lt;external&gt;</span>tool-path<span class="nt">&lt;/external&gt;</span>
    <span class="nt">&lt;on-failure&gt;</span>
      <span class="nt">&lt;shell&gt;</span>Locations.parse &quot;%1&quot; category<span class="nt">&lt;shell&gt;</span>
      <span class="nt">&lt;external&gt;</span>echo the error message is &quot;%2&quot;<span class="nt">&lt;/external&gt;</span>
    <span class="nt">&lt;/on-failure&gt;</span>
    <span class="nt">&lt;external&gt;</span>echo the tool succeeded with message %1<span class="nt">&lt;/external&gt;</span>
  <span class="nt">&lt;/action&gt;</span>
<span class="nt">&lt;/action_launch_to_location&gt;</span>
</pre></div>
</div>
<span class="target" id="index-16"></span><span class="target" id="index-17"></span></li>
<li id="index-18"><p class="first"><code class="file docutils literal"><span class="pre">shell</span></code></p>
<p>You can use custom menu items to invoke GPS commands using the
<code class="file docutils literal"><span class="pre">shell</span></code> tag. These are written in one of the shell scripts
supported by GPS.</p>
<p>This tag supports the same <code class="file docutils literal"><span class="pre">show-command</span></code> and <code class="file docutils literal"><span class="pre">output</span></code>
attributes as the <code class="file docutils literal"><span class="pre">&lt;action&gt;</span></code> tag.</p>
<p>The following example shows how to create two actions to invoke the
<strong class="command">help</strong> interactive command and open the file <code class="file docutils literal"><span class="pre">main.c</span></code>:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;help&gt;</span>
  <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&quot;help&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;shell&gt;</span>help<span class="nt">&lt;/shell&gt;</span>
  <span class="nt">&lt;/action&gt;</span>
  <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&quot;edit&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;shell&gt;</span>edit main.c<span class="nt">&lt;/shell&gt;</span>
  <span class="nt">&lt;/action&gt;</span>
<span class="nt">&lt;/help&gt;</span>
</pre></div>
</div>
<p>By default, commands are written in the GPS shell language.  However, you
can specify the language through the <code class="file docutils literal"><span class="pre">lang</span></code> attribute, whose
default value is &#8220;shell&#8221;. You can also specify &#8220;python&#8221;.</p>
<p>When programming with the GPS shell, execute multiple commands by
separating them with semicolons. Therefore, the following example adds a
menu that lists all the files used by the current file in a
<span class="guilabel">Project</span> browser:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;current_file_uses&gt;</span>
  <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&quot;current file uses&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;shell</span> <span class="na">lang=</span><span class="s">&quot;shell&quot;</span><span class="nt">&gt;</span>File %f<span class="nt">&lt;/shell&gt;</span>
    <span class="nt">&lt;shell</span> <span class="na">lang=</span><span class="s">&quot;shell&quot;</span><span class="nt">&gt;</span>File.uses %1<span class="nt">&lt;/shell&gt;</span>
  <span class="nt">&lt;/action&gt;</span>
<span class="nt">&lt;/current_file_uses&gt;</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;description&gt;</span></code></p>
<p id="index-19">A description of the command, which is used in the graphical editor for
the key manager. See <a class="reference internal" href="#the-key-shortcuts-editor"><span class="std std-ref">The Key Shortcuts Editor</span></a>.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;filter&gt;</span></code>, <code class="file docutils literal"><span class="pre">&lt;filter_and&gt;</span></code>, <code class="file docutils literal"><span class="pre">&lt;filter_or&gt;</span></code></p>
<p id="index-20">The context in which the action can be executed. See
<a class="reference internal" href="#filtering-actions"><span class="std std-ref">Filtering actions</span></a>.</p>
</li>
</ul>
<p>You can mix both shell commands and external commands. For example, the
following command opens an :program`xterm` (on Unix systems only) in the
current directory, which depends on the context:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;xterm_directory&gt;</span>
  <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&quot;xterm in current directory&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;shell</span> <span class="na">lang=</span><span class="s">&quot;shell&quot;</span><span class="nt">&gt;</span>cd %d<span class="nt">&lt;/shell&gt;</span>
    <span class="nt">&lt;external&gt;</span>xterm<span class="nt">&lt;/external&gt;</span>
  <span class="nt">&lt;/action&gt;</span>
<span class="nt">&lt;/xterm_directory&gt;</span>
</pre></div>
</div>
<p>As you can see in some of the examples above, some special strings are
expanded by GPS just prior to executing the command, for example &#8220;%f&#8221; and
&#8220;%d&#8221;.  See below for a full list.</p>
<p>More information on chaining commands is provided in <a class="reference internal" href="#chaining-commands"><span class="std std-ref">Chaining commands</span></a>.</p>
<p>Some actions are also predefined in GPS itself. This includes, for example,
aliases expansion and manipulating MDI windows. You can display all known
actions (both predefined and the ones you defined in your own customization
files) by opening the key shortcut editor using the <span class="menuselection">Edit ‣
Preferences...</span> menu.</p>
</div>
<div class="section" id="macro-arguments">
<span id="id7"></span><h3>15.5.3. Macro arguments<a class="headerlink" href="#macro-arguments" title="Permalink to this headline">¶</a></h3>
<span class="target" id="index-21"></span><span class="target" id="index-22"></span><p id="index-23">You use macro arguments to pass parameters to shell or external commands in
any actions you define. Macro arguments are special parameters that are
transformed every time the command is executed.  The macro arguments below
are provided by GPS.  The equivalent Python code is given for some
arguments.  This code is useful when you are writing a full python script.</p>
<ul>
<li><p class="first"><code class="file docutils literal"><span class="pre">%a</span></code></p>
<p>If the user clicked inside the <span class="guilabel">Locations</span> view, name of
the current line&#8217;s category.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%builder</span></code></p>
<p>Replaced by the default builder configured in GPS.  This can be
<strong class="program">gnatmake</strong> if your project contains only Ada code, or
<strong class="program">gprbuild</strong> for non-Ada or multi-language projects.  This macro
is only available in commands defined in the <span class="guilabel">Build Manager</span>
and <span class="guilabel">Build Launcher</span> dialogs.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%c</span></code></p>
<p>The column number on which the user clicked.  Python equivalent:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">GPS</span><span class="o">.</span><span class="n">current_context</span><span class="p">()</span><span class="o">.</span><span class="n">column</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%d</span></code></p>
<p>Current directory.  Python equivalent:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">GPS</span><span class="o">.</span><span class="n">current_context</span><span class="p">()</span><span class="o">.</span><span class="n">directory</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%dk</span></code></p>
<p>Krunched name of the current directory.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%e</span></code></p>
<p>Name of the entity the user clicked on.  Python equivalent:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">GPS</span><span class="o">.</span><span class="n">current_context</span><span class="p">()</span><span class="o">.</span><span class="n">entity</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%ef</span></code></p>
<p>Name of the entity the user clicked on, possibly followed by &#8220;(best
guess)&#8221; if there is an ambiguity, which may, for example, be due to
cross-reference information not being up-to-date.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%E</span></code></p>
<p>Full path to the executable name corresponding to the target.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%ek</span></code></p>
<p>Krunched name of the entity the user clicked on.  Like <code class="file docutils literal"><span class="pre">%e</span></code>, except
long names are shorted as in <code class="file docutils literal"><span class="pre">%fk</span></code>.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%eL</span></code></p>
<p>Either an empty string or <code class="file docutils literal"><span class="pre">-eL</span></code>, depending on whether the
<span class="guilabel">Fast Project Loading</span> preference if set.  <code class="file docutils literal"><span class="pre">-eL</span></code> is used
by GNAT tools to specify whether symbolic links should be followed when
parsing projects.  This macro is only available in commands defined in
the <span class="guilabel">Build Manager</span> and the <span class="guilabel">Build Launcher</span> dialogs.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%external</span></code></p>
<p>Command line specified in the <span class="menuselection">External Commands ‣
Execute command</span> preference.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%f</span></code></p>
<p>Base name of the currently selected file.  Python equivalent:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os.path</span>
<span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span> <span class="p">(</span><span class="n">GPS</span><span class="o">.</span><span class="n">current_context</span><span class="p">()</span><span class="o">.</span><span class="n">file</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="p">())</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%F</span></code></p>
<p>Absolute name of the currently opened file.  Python equivalent:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">GPS</span><span class="o">.</span><span class="n">current_context</span><span class="p">()</span><span class="o">.</span><span class="n">file</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%fd</span></code></p>
<p>Absolute path for the directory that contains the current file.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%fk</span></code></p>
<p>Krunched base name of the currently selected file.  This is the same as
<code class="file docutils literal"><span class="pre">%f</span></code> except that long names are shortened with some letters
replaced by &#8220;[...]&#8221;.  Use this in menu labels to keep the menus narrow.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%fp</span></code></p>
<p>Base name of the currently selected file. If the file is not part of
the project tree or no file is selected, generate an error in the
<span class="guilabel">Messages</span> view.  This macro is only available in commands
defined in the <span class="guilabel">Build Manager</span> and <span class="guilabel">Build
Launcher</span> dialogs.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%gnatmake</span></code></p>
<p>The <strong class="program">gnatmake</strong> executable configured in your project file.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%gprbuild</span></code></p>
<p>The <strong class="program">gprbuild</strong> command line configured in your project file.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%gprclean</span></code></p>
<p>Default cleaner configured in GPS.  This can be, for example,
<strong class="command">gnat clean</strong> or <strong class="command">gprclean</strong>.  This macro is only
available in commands defined in the <span class="guilabel">Build Manager</span> and
<span class="guilabel">Build Launcher</span> dialogs.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%GPS</span></code></p>
<p>GPS&#8217;s home directory (i.e., the <code class="file docutils literal"><span class="pre">.gps</span></code> directory in which GPS
stores its configuration files).</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%i</span></code></p>
<p>If the user clicked inside the <span class="guilabel">Project</span> view, name of the
parent project, i.e., the one that is importing the one clicked on.
With this definition of parent project, a given project may have
multiple parents, but the one here is the one from the
<span class="guilabel">Project</span> view..</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%l</span></code></p>
<p>Number of the line in which the user clicked.  Python equivalent:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">GPS</span><span class="o">.</span><span class="n">current_context</span><span class="p">()</span><span class="o">.</span><span class="n">line</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%o</span></code></p>
<p>Object directory of the current project.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%O</span></code></p>
<p>Object directory of the root project.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%system_bin_dir</span></code></p>
<p>The directory containing the GPS executable.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%p</span></code></p>
<p>Name of the current project (not the project file). The <code class="file docutils literal"><span class="pre">.gpr</span></code>
extension is not included and the casing is the one in the project
file not that of the file name itself.  If the current context is an
editor, the name of the project to which the source file belongs.
Python equivalent:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">GPS</span><span class="o">.</span><span class="n">current_context</span><span class="p">()</span><span class="o">.</span><span class="n">project</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%P</span></code></p>
<p>Name of root project.  Python equivalent:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">GPS</span><span class="o">.</span><span class="n">Project</span><span class="o">.</span><span class="n">root</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%Pb</span></code></p>
<p>Basename of the root project file.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%Pl</span></code></p>
<p>Name of the root project converted to lower case.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%pp</span></code></p>
<p>Current project file pathname. If a file is selected, the project
file to which the source file belongs.  Python equivalent:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">GPS</span><span class="o">.</span><span class="n">current_context</span><span class="p">()</span><span class="o">.</span><span class="n">project</span><span class="p">()</span><span class="o">.</span><span class="n">file</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%PP</span></code></p>
<p>Root project pathname.  Python equivalent:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">GPS</span><span class="o">.</span><span class="n">Project</span><span class="o">.</span><span class="n">root</span><span class="p">()</span><span class="o">.</span><span class="n">file</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%pps</span></code></p>
<p>Similar to <code class="file docutils literal"><span class="pre">%pp</span></code>, except it returns the project name prepended
with <strong class="command">-P</strong> or an empty string if there is no project file
selected and the current source file does not belong to any
project. This is intended mostly for use with the GNAT command line
tools.  GPS quotes the project name if it contains spaces.  Python
equivalent:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">GPS</span><span class="o">.</span><span class="n">current_context</span><span class="p">()</span><span class="o">.</span><span class="n">project</span><span class="p">():</span>
   <span class="k">return</span> <span class="s2">&quot;-P&quot;</span> <span class="o">&amp;</span> <span class="n">GPS</span><span class="o">.</span><span class="n">current_context</span><span class="p">()</span><span class="o">.</span><span class="n">project</span><span class="p">()</span><span class="o">.</span><span class="n">file</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%PPs</span></code></p>
<p>Similar to :;file:<cite>%PP</cite>, except it returns the project name
prepended with <strong class="command">-P</strong>, or an empty string if the root project
is the default project.  This is intended mostly for use with the
GNAT command line tools.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%(p|P)[r](d|s)[f]</span></code></p>
<p>Replaced by the list of sources or directories of a project. This list is
space-separated with all names surrounded by double quotes for proper
handling of spaces in directories or file names.  The first letter
specifies the project and successive letters which files are in the list
and related options:</p>
<ul>
<li><p class="first"><code class="file docutils literal"><span class="pre">P</span></code></p>
<blockquote>
<div><p>root project.</p>
</div></blockquote>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">p</span></code></p>
<p>The selected project or the root project if project is selected.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">r</span></code></p>
<p>Recurse through the projects, including all subprojects.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">d</span></code></p>
<p>List source directories.  Python equivalent:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">GPS</span><span class="o">.</span><span class="n">current_context</span><span class="p">()</span><span class="o">.</span><span class="n">project</span><span class="p">()</span><span class="o">.</span><span class="n">source_dirs</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">s</span></code></p>
<p>List source files.  Python equivalent:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">GPS</span><span class="o">.</span><span class="n">current_context</span><span class="p">()</span><span class="o">.</span><span class="n">project</span><span class="p">()</span><span class="o">.</span><span class="n">sources</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">f</span></code></p>
<p>Write the list into a file and replace the parameter with the name of
the file. This file is never deleted by GPS; you must do so manually in
the plugin when you no longer need it.</p>
</li>
</ul>
<p>Examples:</p>
<ul>
<li><p class="first"><code class="file docutils literal"><span class="pre">%Ps</span></code></p>
<p>List of source files in the root project.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%prs</span></code></p>
<p>List of files in the current project and all imported sub projects,
recursively.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%prdf</span></code></p>
<p>Name of a file containing a list of source directories in the current
project and all imported sub projects, recursively.</p>
</li>
</ul>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%s</span></code></p>
<p>Text selected by the user, if a single line was selected. If multiple
lines are selected, returns the empty string</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%S</span></code></p>
<p>Text selected by the user or the current entity if no selection. If the
entity is part of an expression (&#8220;A.B.C&#8221;), the whole expression is
returned instead of the entity name.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%switches(tool)</span></code></p>
<p>Value of <strong class="command">IDE'Default_Switches (tool)</strong>.  If you have a tool
whose switches are defined via an XML file in GPS, they are stored as
<span class="guilabel">Default_Switches (xxx)</span> in the <span class="guilabel">IDE</span> package, and you
can retrieve them using this macro. The result is a list of switches, or
an empty list if none.</p>
<p>This macro is only available in the commands defined in the <span class="guilabel">Build
Manager</span> and <span class="guilabel">Build Launcher dialogs</span>.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%T</span></code></p>
<p>Subtarget being considered for building.  Depending on the context, this
can correspond to such things as the base filename of a main source or
<code class="file docutils literal"><span class="pre">makefile</span></code> targets.  This macro is only available in the commands
defined in the <span class="guilabel">Build Manager</span> and <span class="guilabel">Build
Launcher</span> dialogs.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%TT</span></code></p>
<p>Like <cite>%TT</cite>, but the full path to main sources rather than the base
filename.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%TP</span></code></p>
<p>Similar to <cite>%TT%</cite>, but returns the name of the project to which the main
belongs.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%python(cmd)</span></code></p>
<p>Executes the python command <cite>cmd</cite>. It should return either a string
(which is inserted as is in the command line), a list of strings (which
are each passed as a separate argument), or a boolean. If it returns
<cite>False</cite>, then the target is not executed at all.</p>
<p>The cmd itself can include other macros, which will be expanded. Not
all macros are expanded though. For instance, a <cite>%python()</cite> cannot
include another <cite>%(python)</cite>, nor any other function-like macros, like
<cite>%vars()</cite> for instance.</p>
<p>The python function should have no side effect if possible, since it
might be called more than once (for instance as part of showing what
the command line will be when GPS display the dialog to let you edit
that command line prior to actual execution).</p>
<p>Due to the way command-line parsing works, it is recommended to
put triple quotes around the whole argument, as in:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">foo</span> <span class="s2">&quot;&quot;&quot;%python(func(&quot;%TT&quot;, 1))&quot;&quot;&quot;</span> <span class="o">-</span><span class="n">bar</span>
<span class="o">-</span><span class="n">foo</span> <span class="s2">&quot;&quot;&quot;%python(&quot;-one&quot; if Choice else &quot;-two&quot;)&quot;&quot;&quot;</span>
</pre></div>
</div>
<p>to make sure the python argument is not split on spaces for instance.
The closing parenthesis must be the last character before the closing
triple quotes.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%attr(Package'Name[,</span><em><span class="pre">default</span></em><span class="pre">])</span></code></p>
<p>Project attribute <strong class="command">Package'Name`L: the attribute :file:`Name</strong>
from the package <code class="file docutils literal"><span class="pre">Package</span></code>. You can omit <code class="file docutils literal"><span class="pre">Package'</span></code> if
<code class="file docutils literal"><span class="pre">Name</span></code> is a top level attribute (e.g. <code class="file docutils literal"><span class="pre">Object_Dir</span></code>).  If the
attribute is not defined in the project, an optional <strong class="command">default</strong>
value is returned, or an empty string if none is specified.</p>
<p>This macro is only available in the commands defined in the
<span class="guilabel">Build Manager</span> and <span class="guilabel">Build Launcher</span> dialogs and only
supports attributes that return a single string, not those returning
lists.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%dirattr(Package'Name[,default])</span></code></p>
<p>Like <code class="file docutils literal"><span class="pre">%attr</span></code>, but the directory part of an attribute value.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%baseattr(Package'Name[,default])</span></code></p>
<p>Like <code class="file docutils literal"><span class="pre">%attr</span></code>, but the base name an attribute value.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%vars</span></code></p>
<p>List of switches of the form <code class="file docutils literal"><em><span class="pre">variable</span></em><span class="pre">=</span><em><span class="pre">value</span></em></code>, where
<strong class="command">variable</strong> is the name of a scenario variable and
<strong class="command">value</strong> its current value, as configured in the
<span class="guilabel">Scenario</span> view. All scenario variables defined in the current
project tree are listed.  You can also use <code class="file docutils literal"><span class="pre">%vars(-D)</span></code> to generate
a list of switches of the form <code class="file docutils literal"><span class="pre">-D</span><em><span class="pre">variable</span></em><span class="pre">=</span><em><span class="pre">value</span></em></code>.  This macro
is only available in the commands defined in the <span class="guilabel">Build
Manager</span> and <span class="guilabel">Build Launcher</span> dialogs.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%X</span></code></p>
<p>List of switches of the form <code class="file docutils literal"><span class="pre">-X</span><em><span class="pre">variable</span></em><span class="pre">=</span><em><span class="pre">value</span></em></code>, where
<strong class="command">variable</strong> is the name of a scenario variable and
<strong class="command">value</strong> its current value, as configured in the
<span class="guilabel">Scenario</span> view. All the scenario variables defined in the
current project tree are listed.  This macro is only available in the
commands defined in the <span class="guilabel">Build Manager</span> and <span class="guilabel">Build
Launcher</span> dialogs.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%target</span></code></p>
<p>The string <code class="file docutils literal"><span class="pre">--target=</span><em><span class="pre">t</span></em></code> where <strong class="command">t</strong> is the build target,
as determined by the current toolchain.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%%</span></code></p>
<p>The literal <code class="kbd docutils literal"><span class="pre">%</span></code> character.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%ts</span></code></p>
<p>The short name for the current window (&#8216;Search&#8217;, &#8216;Project&#8217;, &#8216;Outline&#8217;, or
the base name for the current file).</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%tl</span></code></p>
<p>The long name for the current window (&#8216;Search&#8217;, &#8216;Project&#8217;, &#8216;Outline&#8217; or
the absolute path name for the current file).</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%rbl</span></code></p>
<p>The name of the Remote Build server (defaults to &#8216;localhost&#8217; when no such
server is configured, hence the final &#8216;l&#8217; in the name of the macro).</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%(env:VAR)</span></code></p>
<p>Value of an environment variable with name VAR.</p>
</li>
</ul>
<p>Another type of macros are expanded before commands are executed: they start
with the <code class="kbd docutils literal"><span class="pre">$</span></code> character and represent parameters passed to the action
by its caller. Depending on the context, GPS passes zero, one or many
arguments to an action. You will commonly use these macros when you define
your own VCS system.  Also see the shell function <code class="file docutils literal"><span class="pre">execute_action</span></code>,
which executes an action and passes it arguments.</p>
<p>These macros are the following</p>
<ul>
<li><p class="first"><code class="file docutils literal"><span class="pre">$1,</span> <span class="pre">$2,</span> <span class="pre">...</span> <span class="pre">$</span><em><span class="pre">n</span></em></code></p>
<p>Where <strong class="command">n</strong> is a number. These are the argument with the
corresponding number that was passed to the action.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">$1-,</span> <span class="pre">$2-,</span> <span class="pre">...</span> <span class="pre">$</span><em><span class="pre">n</span></em><span class="pre">-*</span></code></p>
<p>Likewise, but a string concatenating the specified argument and all
subsequent arguments.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">$*</span></code></p>
<p>String concatenating all arguments passed to the action.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">$repeat</span></code></p>
<p>Number of times the action has been consecutively executed.  This is
1 (the first execution of the action) unless the user invoked the
<span class="guilabel">Repeat Next</span> action.</p>
<p>By default, when <span class="guilabel">Repeat Next</span> is invoked by the user, it
repeats the following action the number of times the user
specified. However, in some cases, either for efficiency reasons or for
other technical reasons, you may want to handle the repeat yourself.  Do
this with the following action declaration:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&quot;my_action&quot;</span><span class="nt">&gt;</span>
   <span class="nt">&lt;shell</span> <span class="na">lang=</span><span class="s">&quot;python&quot;</span><span class="nt">&gt;</span>if $repeat==1: my_function($remaining + 1)<span class="nt">&lt;/shell&gt;</span>
<span class="nt">&lt;/action&gt;</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">my_function</span> <span class="p">(</span><span class="n">count</span><span class="p">):</span>
   <span class="sd">&quot;&quot;&quot;Perform an action count times&quot;&quot;&quot;</span>
   <span class="o">...</span>
</pre></div>
</div>
<p>The idea here is to do something only the first time the action is called
(the <strong class="command">if</strong> statement), but pass your shell function the number of
times it should repeat (the <code class="file docutils literal"><span class="pre">$remaining</span></code> parameter).</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">$remaining</span></code></p>
<p>Like $repeat, but indicates the number of times the action remains
to be executed. This is 0 unless the user invoked the
<span class="guilabel">Repeat Next</span> action.</p>
</li>
</ul>
</div>
<div class="section" id="filtering-actions">
<span id="id8"></span><h3>15.5.4. Filtering actions<a class="headerlink" href="#filtering-actions" title="Permalink to this headline">¶</a></h3>
<span class="target" id="index-24"></span><span class="target" id="index-25"></span><p id="index-26">By default, an action can execute in any context in GPS.  When the user
selects the menu or key, GPS executes the action.  You can restrict when
an action is permitted. If the current context does not permit the action,
GPS displays an error message.</p>
<p>You can use one of several types of restrictions:</p>
<ul>
<li><p class="first">Using macro arguments (see <a class="reference internal" href="#macro-arguments"><span class="std std-ref">Macro arguments</span></a>).</p>
<p>If an action uses one of the macro arguments defined in the previous
section, GPS checks that the information is available. If not, it will not
run any of the shell commands or external commands for that action.</p>
<p>For example, if you specified <code class="file docutils literal"><span class="pre">%F</span></code> as a parameter to a command,
GPS checks there is a current file such as a currently selected file
editor or a file node selected inside the <span class="guilabel">Project</span> view.
This filtering is automatic: you do not have to do anything else.</p>
<p>However, the current context may contain more information than you
expect. For example, if a user clicks on a file name in the
<span class="guilabel">Project</span> view, the current context contains a file (and hence
satisfies <code class="file docutils literal"><span class="pre">%F</span></code>) and also a project (and hence satisfies <code class="file docutils literal"><span class="pre">%p</span></code>
and similar macros).</p>
</li>
<li><p class="first">Defining explicit filters</p>
<p>You can also specify explicit restrictions in the customization files by
using the <code class="file docutils literal"><span class="pre">&lt;filter&gt;</span></code>, <code class="file docutils literal"><span class="pre">&lt;filter_and&gt;</span></code> and <code class="file docutils literal"><span class="pre">&lt;filter_or&gt;</span></code>
tags.  Use these tags to further restrict when the command is valid. For
example, you can use them to specify that the command only applies to
Ada files, or only if a source editor is currently selected.</p>
</li>
</ul>
<div class="section" id="the-filters-tags">
<h4>15.5.4.1. The filters tags<a class="headerlink" href="#the-filters-tags" title="Permalink to this headline">¶</a></h4>
<p>You can define filters in one of two places in the customization files:</p>
<ul>
<li><p class="first">At the top level.</p>
<p>You can define named filters at the same level as other tags such as
<code class="file docutils literal"><span class="pre">&lt;action&gt;</span></code>, <code class="file docutils literal"><span class="pre">&lt;menu&gt;</span></code> or <code class="file docutils literal"><span class="pre">&lt;button&gt;</span></code> tags. These are
global filters that can be referenced elsewhere.</p>
</li>
<li><p class="first">As a child of the <code class="file docutils literal"><span class="pre">&lt;action&gt;</span></code> tag.</p>
<p>These filters are anonymous, although they provide exactly the same
capabilities as the ones above. These are intended for simple filters or
filters that you use only once.</p>
</li>
</ul>
<p>There are three different kinds of tags representing filters:</p>
<ul>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;filter&gt;</span></code></p>
<p>A simple filter. This tag has no child tag.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;filter_and&gt;</span></code></p>
<p>All the children of this tag are merged to form a compound filter.
they are each evaluated in turn and if one of them fails, the whole
filter fails.  Children of this tag can be of type <code class="file docutils literal"><span class="pre">&lt;filter&gt;</span></code>,
<code class="file docutils literal"><span class="pre">&lt;filter_and&gt;</span></code> or :file: <cite>&lt;filter_or&gt;</cite>.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;filter_or&gt;</span></code></p>
<p>Like <code class="file docutils literal"><span class="pre">&lt;filter_and&gt;</span></code>, but as soon as one child filter succeeds, the
whole filter succeeds.</p>
</li>
</ul>
<p>If several filter tags are found under an <code class="file docutils literal"><span class="pre">&lt;action&gt;</span></code> tag, they act
as if they were all under a single <code class="file docutils literal"><span class="pre">&lt;filter_or&gt;</span></code> tag.</p>
<p>The <code class="file docutils literal"><span class="pre">&lt;filter&gt;</span></code>, <code class="file docutils literal"><span class="pre">&lt;filter_and&gt;</span></code>, and <code class="file docutils literal"><span class="pre">&lt;filter_or&gt;</span></code> tags
all accept the following common attributes:</p>
<ul>
<li><p class="first"><code class="file docutils literal"><span class="pre">name</span></code> (optional)</p>
<p>Used to create named filters that can be reused, via the <cite>id</cite> attribute,
elsewhere in actions or compound filters.  The name can have any form.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">error</span></code> (optional)</p>
<p>Error message GPS will display if the filter does not match and hence the
action cannot be executed. If you are using the <code class="file docutils literal"><span class="pre">&lt;filter_and&gt;</span></code> or
<code class="file docutils literal"><span class="pre">&lt;filter_or&gt;</span></code> tag, GPS will only display the error message of that
filter.</p>
</li>
</ul>
<p>In addition, the <code class="file docutils literal"><span class="pre">&lt;filter&gt;</span></code> tag has the following specific
attributes:</p>
<ul>
<li><p class="first"><code class="file docutils literal"><span class="pre">id</span></code> (optional)</p>
<p>If this attribute is specified, all other attributes are ignored. Use
this to reference a named filter previously defined. Here is how you can
make an action depend on a named filter:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;test_filter&gt;</span>
  <span class="nt">&lt;filter</span> <span class="na">name=</span><span class="s">&quot;Test filter&quot;</span> <span class="na">language=</span><span class="s">&quot;ada&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&quot;Test action&quot;</span> <span class="nt">&gt;</span>
     <span class="nt">&lt;filter</span> <span class="na">id=</span><span class="s">&quot;Test filter&quot;</span> <span class="nt">/&gt;</span>
     <span class="nt">&lt;shell&gt;</span>pwd<span class="nt">&lt;/shell&gt;</span>
  <span class="nt">&lt;/action&gt;</span>
<span class="nt">&lt;/test_filter&gt;</span>
</pre></div>
</div>
<p>GPS contains a number of predefined filters:</p>
<ul>
<li><p class="first"><code class="file docutils literal"><span class="pre">Source</span> <span class="pre">editor</span></code></p>
<p>Match if the currently selected window in GPS is an editor.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">Explorer_Project_Node</span></code></p>
<p>Match if clicking on a project node in the <span class="guilabel">Project</span> view.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">Explorer_Directory_Node</span></code></p>
<p>Match if clicking on a directory node in the <span class="guilabel">Project</span> view.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">Explorer_File_Node</span></code></p>
<p>Match if clicking on a file node in the <span class="guilabel">Project</span> view.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">Explorer_Entity_Node</span></code></p>
<p>Match if clicking on an entity node in the <span class="guilabel">Project</span> view.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">File</span></code></p>
<p>Match if the current context contains a file (for example the focus is
on a source editor or the focus is on the <span class="guilabel">Project</span> view and
the currently selected line contains file information).</p>
</li>
</ul>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">language</span></code> (optional)</p>
<p>Name of the language that must be associated with the current file in
order for the filter to match. For example, if you specify
<strong class="command">ada</strong>, the user must have an Ada file selected for the action
to execute. GPS determines the language for a file by using several
methods such as looking at file extensions in conjunction with the
naming scheme defined in the project files.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">shell_cmd</span></code> (optional)</p>
<p>Shell command to execute. The output of this command is used to find if
the filter matches: if it returns &#8220;1&#8221; or &#8220;true&#8221;, the filter matches. In
any other case, the filter fails.</p>
<p>Macro arguments (such as <code class="file docutils literal"><span class="pre">%f</span></code> and <cite>%p</cite>) may be used in the text of
the command to execute.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">shell_lang</span></code> (optional)</p>
<p>Which language the command in <code class="file docutils literal"><span class="pre">shell_cmd</span></code> is written.  The default
if that the command is written for the GPS shell.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">module</span></code> (optional)</p>
<p>The filter only matches if the current window was created by this
specific GPS module. For example, if you specify <code class="file docutils literal"><span class="pre">Source_Editor</span></code>,
the filter only matches if the active window is a source editor.</p>
<p>You can obtain the list of module names by typing <strong class="command">lsmod</strong> in
the shell console at the bottom of the GPS window.</p>
<p>This attribute is useful mostly when creating new contextual menus.</p>
</li>
</ul>
<p>When several attributes are specified for a <code class="file docutils literal"><span class="pre">&lt;filter&gt;</span></code> node (which
cannot be combined with <code class="file docutils literal"><span class="pre">id</span></code>), they must all match for the action to
be executed:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="c">&lt;!-- The following filter only matches if the currently selected</span>
<span class="c">     window is a text editor editing an Ada source file --&gt;</span>
<span class="nt">&lt;ada_editor&gt;</span>
  <span class="nt">&lt;filter_and</span> <span class="na">name=</span><span class="s">&quot;Source editor in Ada&quot;</span> <span class="nt">&gt;</span>
    <span class="nt">&lt;filter</span> <span class="na">language=</span><span class="s">&quot;ada&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;filter</span> <span class="na">id=</span><span class="s">&quot;Source editor&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/filter_and&gt;</span>

  <span class="c">&lt;!-- The following action is only executed for such an editor --&gt;</span>

  <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&quot;Test Ada action&quot;</span> <span class="nt">&gt;</span>
     <span class="nt">&lt;filter</span> <span class="na">id=</span><span class="s">&quot;Source editor in Ada&quot;</span> <span class="nt">/&gt;</span>
     <span class="nt">&lt;shell&gt;</span>pwd<span class="nt">&lt;/shell&gt;</span>
  <span class="nt">&lt;/action&gt;</span>

  <span class="c">&lt;!--  An action with an anonymous filter. it is executed if the</span>
<span class="c">        selected file is in Ada even if the file was selected through</span>
<span class="c">        the project view  --&gt;</span>

  <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&quot;Test for Ada files&quot;</span> <span class="nt">&gt;</span>
      <span class="nt">&lt;filter</span> <span class="na">language=</span><span class="s">&quot;ada&quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;shell&gt;</span>pwd<span class="nt">&lt;/shell&gt;</span>
  <span class="nt">&lt;/action&gt;</span>
<span class="nt">&lt;/ada_editor&gt;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="adding-new-menus">
<span id="id9"></span><h3>15.5.5. Adding new menus<a class="headerlink" href="#adding-new-menus" title="Permalink to this headline">¶</a></h3>
<span class="target" id="index-27"></span><span class="target" id="index-28"></span><span class="target" id="index-29"></span><p id="index-30">Actions can be associated with menus, tool bar buttons, and keys, all
using similar syntax.</p>
<p>Each menu item has an associated path, which it behaves like a UNIX path,
except it references menus, starting from the menu bar itself. The first
character of this path must be <code class="kbd docutils literal"><span class="pre">/</span></code>. The last part is the name of the
menu item.  For example, specifying <strong class="command">/Parent1/Parent2/Item</strong> as a
menu path is a reference to a <span class="menuselection">Parent1 ‣ Parent2 -&gt; Item</span>
menu.  If you are creating a new menu item, GPS creates any parent menus
that do not already exist.</p>
<p>You bind a menu item to an action through the <code class="file docutils literal"><span class="pre">&lt;menu&gt;</span></code> and
<code class="file docutils literal"><span class="pre">&lt;submenu&gt;</span></code> tags.  The <code class="file docutils literal"><span class="pre">&lt;menu&gt;</span></code> tag can have the following
attributes:</p>
<ul>
<li><p class="first"><code class="file docutils literal"><span class="pre">action</span></code> (required)</p>
<p>Action to execute when the item is selected by the user. If no
action by this name is defined, GPS does not add a new menu. If the
action name starts with a &#8216;/&#8217;, it represents the absolute path to an
action.</p>
<p>Omit this attribute only when no title is specified for the menu.  Doing
that makes it a separator (see below).</p>
<p>If you associate a filter with the action via the <code class="file docutils literal"><span class="pre">&lt;filter&gt;</span></code>
tag, the menu is grayed out when the filter does not match.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">before</span></code> (optional)</p>
<p>Name of another menu item before which the new menu should be
inserted.  If that item has not been previously created, the new menu
is inserted at the end.  Use this attribute to control precisely
where the item menu is displayed.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">after</span></code> (optional)</p>
<p>Like <code class="file docutils literal"><span class="pre">before</span></code>, but with a lower priority. If specified and
there is no <code class="file docutils literal"><span class="pre">before</span></code> attribute, it specifies an item after
which the new item should be inserted.</p>
</li>
</ul>
<p>The <code class="file docutils literal"><span class="pre">&lt;menu&gt;</span></code> tag should have one XML child called
<code class="file docutils literal"><span class="pre">&lt;title&gt;</span></code>, which specifies the label of the menu. This label is
actually a path to a menu, so you can define submenus.</p>
<p>You can define the accelerator keys for your menus using underscores
in the title to designate the accelerator key. For example, if you
want an accelerator on the first letter in a menu named <code class="file docutils literal"><span class="pre">File</span></code>,
set its title to <code class="file docutils literal"><span class="pre">_File</span></code>.</p>
<p>The <code class="file docutils literal"><span class="pre">&lt;submenu&gt;</span></code> tag
accepts several children, such as <code class="file docutils literal"><span class="pre">&lt;title&gt;</span></code> (which can present at
most once), <code class="file docutils literal"><span class="pre">&lt;submenu&gt;</span></code> (for nested menus), and <code class="file docutils literal"><span class="pre">&lt;menu&gt;</span></code>.</p>
<p><code class="file docutils literal"><span class="pre">&lt;submenu&gt;</span></code> does not accept the <code class="file docutils literal"><span class="pre">action</span></code> attribute.  Use
<code class="file docutils literal"><span class="pre">&lt;menu&gt;</span></code> for clickable items that result in an action and
<code class="file docutils literal"><span class="pre">&lt;submenu&gt;</span></code> to define several menus with the same path.</p>
<p>Specify which menu the new item is added to in one of two ways:</p>
<ul class="simple">
<li>Specify a path in the <code class="file docutils literal"><span class="pre">title</span></code> attribute of <code class="file docutils literal"><span class="pre">&lt;menu&gt;</span></code></li>
<li>Put the <code class="file docutils literal"><span class="pre">&lt;menu&gt;</span></code> as a child of a <code class="file docutils literal"><span class="pre">&lt;submenu&gt;</span></code> node.  This
requires more typing, but allows you to specify the exact location,
at each level, of the parent menu.</li>
</ul>
<p>For example, this adds an item named <code class="file docutils literal"><span class="pre">mymenu</span></code> to the standard
<span class="guilabel">Edit</span> menu:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;test&gt;</span>
  <span class="nt">&lt;submenu&gt;</span>
    <span class="nt">&lt;title&gt;</span>Edit<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;menu</span> <span class="na">action=</span><span class="s">&quot;current file uses&quot;</span><span class="nt">&gt;</span>
       <span class="nt">&lt;title&gt;</span>mymenu<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;/menu&gt;</span>
  <span class="nt">&lt;/submenu&gt;</span>
<span class="nt">&lt;/test&gt;</span>
</pre></div>
</div>
<p>The following has exactly the same effect:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;test&gt;</span>
  <span class="nt">&lt;menu</span> <span class="na">action=</span><span class="s">&quot;current file uses&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;title&gt;</span>Edit/mymenu<span class="nt">&lt;/title&gt;</span>
  <span class="nt">&lt;/menu&gt;</span>
<span class="nt">&lt;/test&gt;</span>
</pre></div>
</div>
<p>The following adds a new item <code class="file docutils literal"><span class="pre">stats</span></code> to the <code class="file docutils literal"><span class="pre">unit</span>
<span class="pre">testing</span></code> submenu in <code class="file docutils literal"><span class="pre">my_tools</span></code>:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;test&gt;</span>
  <span class="nt">&lt;menu</span> <span class="na">action=</span><span class="s">&quot;execute my stats&quot;</span><span class="nt">&gt;</span>
     <span class="nt">&lt;title&gt;</span>/My_Tools/unit testing/stats<span class="nt">&lt;/title&gt;</span>
  <span class="nt">&lt;/menu&gt;</span>
<span class="nt">&lt;/test&gt;</span>
</pre></div>
</div>
<p>The previous method is shorter but less flexible than the following,
where we also create the <code class="file docutils literal"><span class="pre">My_Tools</span></code> menu, if it does not already
exist, to appear after the <span class="guilabel">File</span> menu. This cannot be done
by using only <code class="file docutils literal"><span class="pre">&lt;menu&gt;</span></code> tags. We also insert several items in
that new menu:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;test&gt;</span>
  <span class="nt">&lt;submenu&gt;</span>
    <span class="nt">&lt;title&gt;</span>My_Tools<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;menu</span> <span class="na">action=</span><span class="s">&quot;execute my stats&quot;</span><span class="nt">&gt;</span>
       <span class="nt">&lt;title&gt;</span>unit testing/stats<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;/menu&gt;</span>
    <span class="nt">&lt;menu</span> <span class="na">action=</span><span class="s">&quot;execute my stats2&quot;</span><span class="nt">&gt;</span>
       <span class="nt">&lt;title&gt;</span>unit testing/stats2<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;/menu&gt;</span>
  <span class="nt">&lt;/submenu&gt;</span>
<span class="nt">&lt;/test&gt;</span>
</pre></div>
</div>
<p id="index-31">If you add an item with an empty title or no title at all, GPS inserts
a menu separator. For example, the following example will insert a
separator followed by a <span class="menuselection">File ‣ Custom</span> menu:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;menus&gt;</span>
  <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&quot;execute my stats&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;submenu&gt;</span>
     <span class="nt">&lt;title&gt;</span>File<span class="nt">&lt;/title&gt;</span>
     <span class="nt">&lt;menu&gt;&lt;title/&gt;&lt;/menu&gt;</span>
     <span class="nt">&lt;menu</span> <span class="na">action=</span><span class="s">&quot;execute my stats&quot;</span><span class="nt">&gt;</span>
         <span class="nt">&lt;title&gt;</span>Custom<span class="nt">&lt;/title&gt;</span>
     <span class="nt">&lt;/menu&gt;</span>
  <span class="nt">&lt;/submenu&gt;</span>
<span class="nt">&lt;/menus&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="adding-contextual-menus">
<span id="id10"></span><h3>15.5.6. Adding contextual menus<a class="headerlink" href="#adding-contextual-menus" title="Permalink to this headline">¶</a></h3>
<p id="index-32">You can also add actions as new items in contextual menus anywhere in GPS.
Contextual menus are displayed when the user right clicks and only show
actions relevant to the current context.</p>
<p>Add an item using the <code class="file docutils literal"><span class="pre">&lt;contextual&gt;</span></code> tag, which takes the following
attributes:</p>
<ul>
<li><p class="first"><code class="file docutils literal"><span class="pre">action</span></code> (required)</p>
<p>Name of action to execute, which must be defined elsewhere in one of the
customization files.</p>
<p>If set to an empty string, a separator is inserted in the contextual
menu.  If you specify an item using the <code class="file docutils literal"><span class="pre">before</span></code> or <code class="file docutils literal"><span class="pre">after</span></code>
attribute, the separator is displayed only when the specified item is.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">before</span></code> (optional)</p>
<p>Name of another contextual menu item before which the new item should
appear.  You can find the list of names of predefined contextual menus by
looking at the output of <strong class="command">Contextual.list</strong> in the GPS shell
console. The name of your contextual menu item is the value of the
<code class="file docutils literal"><span class="pre">&lt;title&gt;</span></code> child.</p>
<p>There is no guarantee the new menu item will appear just before the
specified item. For example, it will not if the new item is created before
the specified menu item or if a later contextual menu item also specified
it must be displayed before the same item.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">after</span></code> (optional)</p>
<p>Like <code class="file docutils literal"><span class="pre">before</span></code>, except it indicates the new menu item should appear
after the specified item.</p>
<p>If you specify both <code class="file docutils literal"><span class="pre">after</span></code> and <code class="file docutils literal"><span class="pre">before</span></code>, only
the latter is honored.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">group</span></code> (optional, default <strong class="command">0</strong>)</p>
<p>Allows you to create groups of contextual menus that are put next to each
other. Items with the same group number appear before all items with a
larger group number.</p>
</li>
</ul>
<p>The <code class="file docutils literal"><span class="pre">&lt;contextual&gt;</span></code> tag accepts one child tag, <code class="file docutils literal"><span class="pre">&lt;Title&gt;</span></code>, which
specifies the name of the menu item. If not specified, the menu item uses
the name of the action. The title is the full path to the new menu item,
like in the <code class="file docutils literal"><span class="pre">&lt;menu&gt;</span></code> tag.  You can create submenus by using a title of
the form <strong class="command">Parent1/Parent2/Menu</strong>.  You can use macro arguments in
the title, which are expended based on the current context. See
<a class="reference internal" href="#macro-arguments"><span class="std std-ref">Macro arguments</span></a>.</p>
<p>GPS only displays the new contextual menu item if the filters associated
with the action match the current context.</p>
<p>For example, the following example inserts a new contextual menu item that
displays the name of the current file in the GPS console. This contextual
menu is only displayed in source editors. This contextual menu entry is
followed by a separator line, displayed when the menu item is:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;print&gt;</span>
  <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&quot;print current file name&quot;</span> <span class="nt">&gt;</span>
    <span class="nt">&lt;filter</span> <span class="na">module=</span><span class="s">&quot;Source_Editor&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;shell&gt;</span>echo %f<span class="nt">&lt;/shell&gt;</span>
  <span class="nt">&lt;/action&gt;</span>

  <span class="nt">&lt;contextual</span> <span class="na">action=</span><span class="s">&quot;print current file name&quot;</span> <span class="nt">&gt;</span>
    <span class="nt">&lt;Title&gt;</span>Print Current File Name<span class="nt">&lt;/Title&gt;</span>
  <span class="nt">&lt;/contextual&gt;</span>
  <span class="nt">&lt;contextual</span> <span class="na">action=</span><span class="s">&quot;&quot;</span> <span class="na">after=</span><span class="s">&quot;Print Current File Name&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/print&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="adding-tool-bar-buttons">
<span id="id11"></span><h3>15.5.7. Adding tool bar buttons<a class="headerlink" href="#adding-tool-bar-buttons" title="Permalink to this headline">¶</a></h3>
<span class="target" id="index-33"></span><span class="target" id="index-34"></span><p id="index-35">As an alternative to creating new menu items, you can create new buttons on
the tool bar, by using the <code class="file docutils literal"><span class="pre">&lt;button&gt;</span></code> tag. Like the <code class="file docutils literal"><span class="pre">&lt;menu&gt;</span></code>
tag, it requires an <code class="file docutils literal"><span class="pre">action</span></code> attribute, which specifies what should
be done when the button is pressed. The button is not created if the action
action does not exist.</p>
<span class="target" id="index-36"></span><p id="index-37">This tag accepts one optional attribute, <code class="file docutils literal"><span class="pre">iconname</span></code> which you can use to
override the default image registered for the action or set one if the
action no image. See <a class="reference internal" href="#adding-stock-icons"><span class="std std-ref">Adding custom icons</span></a> for more information on icons.</p>
<p>The following example defines a new button:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;stats&gt;</span>
  <span class="nt">&lt;button</span> <span class="na">action=</span><span class="s">&quot;undo&quot;</span> <span class="nt">/&gt;</span>   <span class="c">&lt;!--  use default icon --&gt;</span>
  <span class="nt">&lt;button</span> <span class="na">action=</span><span class="s">&quot;execute my stats&quot;</span> <span class="na">iconname=</span><span class="s">&#39;my-image&#39;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/stats&gt;</span>
</pre></div>
</div>
<p>Use the <code class="file docutils literal"><span class="pre">&lt;button&gt;</span></code> tag to create a simple button that the user can
press to start an action. GPS also supports another type of button, a combo
box, from which the user can choose among a list of choices.  Create a
combo box with the <code class="file docutils literal"><span class="pre">&lt;entry&gt;</span></code> tag, which accepts the following
attributes:</p>
<ul>
<li><p class="first"><code class="file docutils literal"><span class="pre">id</span></code> (required)</p>
<p>Unique id for this combo box, used later on to refer it, specifically
from the scripting languages. It can be any string.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">label</span></code> (default)</p>
<p>Text of a label to display on the left of the combo box. If not
specified, no text is displayed</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">on-changed</span></code> (default)</p>
<p>Name of a GPS action to execute whenever the user selects a new value in
the combo box. This action is called with two parameters: the unique id
of the combo box and the newly selected text.</p>
</li>
</ul>
<p>It also accepts any number of <cite>&lt;choice&gt;</cite> tags, each of which defines one
value the user can choose from. These tags accept one optional attribute,
<code class="file docutils literal"><span class="pre">on-selected</span></code>, which is the name of a GPS action to call when that
value is selected:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&quot;animal_changed&quot;</span><span class="nt">&gt;</span>
   <span class="nt">&lt;shell&gt;</span>echo A new animal was selected in combo $1: animal is $2<span class="nt">&lt;/shell&gt;</span>
<span class="nt">&lt;/action&gt;</span>
<span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&quot;gnu-selected&quot;</span><span class="nt">&gt;</span>
   <span class="nt">&lt;shell&gt;</span>echo Congratulations on choosing a Gnu<span class="nt">&lt;/shell&gt;</span>
<span class="nt">&lt;/action&gt;</span>
<span class="nt">&lt;entry</span> <span class="na">id=</span><span class="s">&quot;foo&quot;</span> <span class="na">label=</span><span class="s">&quot;Animal&quot;</span> <span class="na">on-changed=</span><span class="s">&quot;animal_changed&quot;</span><span class="nt">&gt;</span>
   <span class="nt">&lt;choice&gt;</span>Elephant<span class="nt">&lt;/choice&gt;</span>
   <span class="nt">&lt;choice</span> <span class="na">on-selected=</span><span class="s">&quot;gnu-selected&quot;</span><span class="nt">&gt;</span>Gnu<span class="nt">&lt;/choice&gt;</span>
<span class="nt">&lt;/entry&gt;</span>
</pre></div>
</div>
<p>GPS provides a more convenient interface for Python, the
<code class="file docutils literal"><span class="pre">GPS.Toolbar</span></code> class, which provides the same flexibility as above,
but also gives you dynamic control over the entry and allows placement of
buttons at arbitrary positions in the toolbar. See the Python
documentation.</p>
</div>
<div class="section" id="binding-actions-to-keys">
<span id="id12"></span><h3>15.5.8. Binding actions to keys<a class="headerlink" href="#binding-actions-to-keys" title="Permalink to this headline">¶</a></h3>
<span class="target" id="index-38"></span><p id="index-39">All actions can be bound to specific key shortcuts through the
<code class="file docutils literal"><span class="pre">&lt;key&gt;</span></code> tag. This tag has two different forms:</p>
<ul>
<li><p class="first"><cite>&lt;key load=&#8217;file.xml&#8217;/&gt;</cite> tells GPS to load the given key theme (either
from the GPS predefined directory or from the user&#8217;s own directory.</p>
</li>
<li><p class="first"><cite>&lt;key action=&#8217;name&#8217; exclusive=&#8217;true&#8217;&gt;shortcut&lt;/key&gt;</cite>
It requires one <code class="file docutils literal"><span class="pre">action</span></code> attribute to specify what to do when the key
is pressed. The name of the action can start with a &#8216;/&#8217; to indicate that a
menu should be executed instead of a user-defined action (although it is
preferred to bind to an actual action).  If the action is specified as an
empty string, the key is no longer bound to any action.</p>
<p>This tag does not contain any child tags. Instead, its text contents
specifies the keyboard shortcut. The name of the key can be prefixed by
any combination of the following:</p>
<ul class="simple">
<li><strong class="command">control-</strong> is the control key on the keyboard;</li>
<li><strong class="command">alt-</strong> is the alt key on the keyboard (left or right) or the
option key on OSX;</li>
<li><strong class="command">shift-</strong> is the shift key. It should not be necessary if you
want to point to symbols for which shift would be necessary, so for
instance on an US keyboard, <strong class="command">shift-%</strong> and <strong class="command">%</strong> are
the same);</li>
<li><strong class="command">cmd-</strong> is the command key on OSX, or the alt key on other
keyboards;</li>
<li><strong class="command">primary-</strong> is the command key on OSX, or the control key on
other keyboards.</li>
</ul>
<p>You can also define multi-key bindings similar to Emacs&#8217; by separating
them by a space. For example, <strong class="command">control-x control-k</strong> means the user
should press <code class="kbd docutils literal"><span class="pre">Ctrl-x</span></code>, followed by a <code class="kbd docutils literal"><span class="pre">Ctrl-k</span></code> to activate
the corresponding action. This only works if the first key is not already
bound to an action. If it is, you must first unbind it by passing an empty
action to <code class="file docutils literal"><span class="pre">&lt;key&gt;</span></code>.</p>
<p>This XML node has one optional attribute <strong class="command">exclusive</strong>. When this
is set to <cite>true</cite>, the shortcut will no longer be used for any action that
might be already using it. If you set it to <cite>false</cite>, multiple actions will
be bound to the same shortcut. The first one for which the filter applies
(i.e. the current context is right for the action) will be executed.</p>
</li>
</ul>
<p>Use an empty string as the key binding if you wish to deactivate a
preexisting binding. The second example below deactivates the standard
binding:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;keys&gt;</span>
  <span class="nt">&lt;key</span> <span class="na">action=</span><span class="s">&quot;expand alias&quot;</span><span class="nt">&gt;</span>control-o<span class="nt">&lt;/key&gt;</span>
  <span class="nt">&lt;key</span> <span class="na">action=</span><span class="s">&quot;Jump to matching delimiter&quot;</span> <span class="nt">/&gt;</span>

  <span class="c">&lt;!--  Bind a key to a menu --&gt;</span>
  <span class="nt">&lt;key</span> <span class="na">action=</span><span class="s">&quot;/Window/Close&quot;</span><span class="nt">&gt;</span>control-x control-w<span class="nt">&lt;/key&gt;</span>
<span class="nt">&lt;/key&gt;</span>
</pre></div>
</div>
<p>If you bind multiple actions to the same key binding, they are executed
sequentially, followed by any menu for which this key is an accelerator.</p>
<p>When GPS processes a <code class="file docutils literal"><span class="pre">&lt;key&gt;</span></code> tag, it does the following:</p>
<ul class="simple">
<li>Removes all actions bound to that key if <cite>exclusive</cite> is true.  This
ensures that any action
previously associated with it, either by default in GPS or in some other
XML file, is no longer executed. This removal is not done when loading
key themes (i.e. XML files from <code class="file docutils literal"><span class="pre">$HOME/.gps/key_themes</span></code> directory),
so it is possible to bind an action to multiple key bindings as part of
a key theme.</li>
<li>Adds the new key to the list of shortcuts that can execute the
action. Any existing shortcut for the action is preserved, allowing
multiple shortcuts for the action.</li>
</ul>
</div>
<div class="section" id="configuring-preferences">
<span id="preferences-support-in-custom-files"></span><h3>15.5.9. Configuring preferences<a class="headerlink" href="#configuring-preferences" title="Permalink to this headline">¶</a></h3>
<div class="section" id="creating-new-preferences">
<h4>15.5.9.1. Creating new preferences<a class="headerlink" href="#creating-new-preferences" title="Permalink to this headline">¶</a></h4>
<p id="index-40">GPS contains a number of predefined preferences to configure its
behavior and appearance, which are all customizable through the
<span class="menuselection">Edit ‣ Preferences...</span> menu.</p>
<p>You can add preferences for your extension modules through the usual GPS
customization files.  Preferences are different from project attributes
(see <a class="reference internal" href="#defining-project-attributes"><span class="std std-ref">Defining project attributes</span></a>); the latter varies depending on
which project is loaded by the user, while preferences are always set to
the same value independent of what project is loaded.</p>
<p>You create your own preferences with the <code class="file docutils literal"><span class="pre">&lt;preference&gt;</span></code> tag, which
accepts the following attributes:</p>
<ul>
<li><p class="first"><code class="file docutils literal"><span class="pre">name</span></code> (required)</p>
<p>Name of the preference, used both when the preference is saved by GPS in
the <code class="file docutils literal"><span class="pre">$HOME/.gps/preferences</span></code> file and to query the value of a
preference interactively through the <code class="file docutils literal"><span class="pre">GPS.Preference</span></code> class in the
GPS shell or Python. These names cannot contain spaces or underscore
characters: use minus signs instead of the latter.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">page</span></code> (optional, default <strong class="command">General</strong>)</p>
<p>Name of the page in the preferences editor where the preference are
edited. If the page does not already exist, GPS automatically creates
it. If this is the empty string, the preference is not editable
interactively. Use this to save a value from one session of GPS to the
next without allowing the user to change it. Subpages are referenced by
separating pages name with slashes (<code class="kbd docutils literal"><span class="pre">/</span></code>).</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">default</span></code> (optional, default depends on type of the preference)</p>
<p>Default value of the preference. If not specified, this is 0 for integer
preferences, the empty string for string preferences, True for boolean
preferences, and the first possible choice for choice preferences.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">tip</span></code> (optional)</p>
<p>Text of the tooltip that appears in the preferences editor dialog.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">label</span></code> (required)</p>
<p>Name of the preference as it appears in the preferences editor dialog</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">minimum</span></code> (optional, default <strong class="command">0</strong>),
<code class="file docutils literal"><span class="pre">maximum</span></code> (default <strong class="command">10</strong>)</p>
<p>Minimum and maximum values for integer preferences.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">type</span></code> (required)</p>
<p>Type of the preference.  Must be one of:</p>
<ul>
<li><p class="first"><strong class="command">boolean</strong></p>
</li>
<li><p class="first"><strong class="command">integer</strong></p>
</li>
<li><p class="first"><strong class="command">string</strong></p>
</li>
<li><p class="first"><strong class="command">font</strong></p>
</li>
<li><p class="first"><strong class="command">color</strong></p>
<p>A color name, in the format of a named color such as &#8220;yellow&#8221;, or a
string like &#8220;#RRGGBB&#8221;, where RR is the red component, GG is the green
component, and BB is the blue component.</p>
</li>
<li><p class="first"><strong class="command">choices</strong></p>
<p>The preference is a string whose value is chosen among a static list of
possible values, each of which is defined in by a <code class="file docutils literal"><span class="pre">&lt;choice&gt;</span></code>
child of the <code class="file docutils literal"><span class="pre">&lt;preference&gt;</span></code> node.</p>
</li>
</ul>
</li>
</ul>
<p>Here is an example that defines a few new preferences:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="nt">&lt;custom&gt;</span>
   <span class="nt">&lt;preference</span> <span class="na">name=</span><span class="s">&quot;my-int&quot;</span>
               <span class="na">page=</span><span class="s">&quot;Editor&quot;</span>
               <span class="na">label=</span><span class="s">&quot;My Integer&quot;</span>
               <span class="na">default=</span><span class="s">&quot;30&quot;</span>
               <span class="na">minimum=</span><span class="s">&quot;20&quot;</span>
               <span class="na">maximum=</span><span class="s">&quot;35&quot;</span>
               <span class="na">page=</span><span class="s">&quot;Manu&quot;</span>
               <span class="na">type=</span><span class="s">&quot;integer&quot;</span> <span class="nt">/&gt;</span>

   <span class="nt">&lt;preference</span> <span class="na">name=</span><span class="s">&quot;my-enum&quot;</span>
               <span class="na">page=</span><span class="s">&quot;Editor:Fonts &amp;amp; Colors&quot;</span>
               <span class="na">label=</span><span class="s">&quot;My Enum&quot;</span>
               <span class="na">default=</span><span class="s">&quot;1&quot;</span>
               <span class="na">type=</span><span class="s">&quot;choices&quot;</span> <span class="nt">&gt;</span>
     <span class="nt">&lt;choice&gt;</span>Choice1<span class="nt">&lt;/choice&gt;</span>
     <span class="nt">&lt;choice&gt;</span>Choice2<span class="nt">&lt;/choice&gt;</span>  <span class="c">&lt;!--  The default choice --&gt;</span>
     <span class="nt">&lt;choice&gt;</span>Choice3<span class="nt">&lt;/choice&gt;</span>
   <span class="nt">&lt;/preference&gt;</span>
<span class="nt">&lt;/custom&gt;</span>
</pre></div>
</div>
<p>The values of the above preferences can be queried in the scripting languages:</p>
<ul>
<li><p class="first">GPS shell:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">Preference</span> <span class="s2">&quot;my-enum&quot;</span>
<span class="n">Preference</span><span class="o">.</span><span class="n">get</span> <span class="o">%</span><span class="mi">1</span>
</pre></div>
</div>
</li>
<li><p class="first">Python:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">val</span> <span class="o">=</span> <span class="n">GPS</span><span class="o">.</span><span class="n">Preference</span> <span class="p">(</span><span class="s2">&quot;my-enum&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span> <span class="p">()</span>
<span class="n">val2</span> <span class="o">=</span> <span class="n">GPS</span><span class="o">.</span><span class="n">Preference</span> <span class="p">(</span><span class="s2">&quot;my-int&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span> <span class="p">()</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="setting-preferences-values">
<h4>15.5.9.2. Setting preferences values<a class="headerlink" href="#setting-preferences-values" title="Permalink to this headline">¶</a></h4>
<p id="index-41">You can force specific default values for the preferences in the
customization files through the <code class="file docutils literal"><span class="pre">&lt;pref&gt;</span></code> tag. This is the same tag
used by GPS itself when it saves the preferences edited via the preferences
dialog.</p>
<p>This tag requires one attribute, <code class="file docutils literal"><span class="pre">name</span></code>, the name of the
preference for which you are setting a default value.  These names are
defined when the preference is registered in GPS.  You can find them by
looking at the <code class="file docutils literal"><span class="pre">$HOME/.gps/preferences</span></code> file for each user or by
looking at one of the predefined GPS themes.</p>
<p>It accepts no child tags, but the value of the <code class="file docutils literal"><span class="pre">&lt;pref&gt;</span></code> tag defines
the default value of the preference, which is used unless the user has
overridden it in his own preferences file.</p>
<p>Any setting you defined in the customization files is overridden by a
specification of that preference in the user&#8217;s preferences file.</p>
<p>The <code class="file docutils literal"><span class="pre">&lt;pref&gt;</span></code> tag is mostly intended for use in themes (see
<a class="reference internal" href="#creating-themes"><span class="std std-ref">Creating themes</span></a>).</p>
</div>
</div>
<div class="section" id="creating-themes">
<span id="id13"></span><h3>15.5.10. Creating themes<a class="headerlink" href="#creating-themes" title="Permalink to this headline">¶</a></h3>
<span class="target" id="index-42"></span><p id="index-43">You can create your own themes and share them between users and then
selectively choose which themes each user want to activate through the
preferences dialog.</p>
<p>You create new themes in the customization files using the
<code class="file docutils literal"><span class="pre">&lt;theme&gt;</span></code> tag.</p>
<p>This tag accepts the following attributes:</p>
<ul>
<li><p class="first"><code class="file docutils literal"><span class="pre">name</span></code> (required)</p>
<p>Name of the theme as it appears in the preferences dialog</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">description</span></code> (optional)</p>
<p>This text should explain what the theme does. It appears in the
preferences dialog when the user selects that theme.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">category</span></code> (optional, default <strong class="command">General</strong>)</p>
<p>Name of the category in which the theme should be presented in the
preferences dialog. Categories are currently only used to organize
themes graphically. GPS creates a category automatically if you
choose one that has not previously been created.</p>
</li>
</ul>
<p>This tag accepts any other customization tags including setting preferences
(<code class="file docutils literal"><span class="pre">&lt;pref&gt;</span></code>), defining key bindings (<code class="file docutils literal"><span class="pre">&lt;key</span></code>), and defining menus
(<code class="file docutils literal"><span class="pre">&lt;menu&gt;</span></code>).</p>
<p>If you define the same theme in multiple locations (either multiple times
in the same customization file or in different files), the customizations
in each are merged. The first definition of the theme seen by GPS sets the
description and category for the theme.</p>
<p>All child tags of the theme are executed when the user activates the theme
in the preferences dialog. There is no strict ordering of the child tags.
The default order is the same as for the customization files themselves:
first the predefined themes of GPS, then the ones defined in customization
files found through the <code class="file docutils literal"><span class="pre">GPS_CUSTOM_PATH</span></code> directories, and finally
the ones defined in files found in the user&#8217;s own GPS directory.</p>
<p>Here is an example of a theme:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;my-plugin&gt;</span>
   <span class="nt">&lt;theme</span> <span class="na">name=</span><span class="s">&quot;my theme&quot;</span> <span class="na">description=</span><span class="s">&quot;Create a new menu&quot;</span><span class="nt">&gt;</span>
       <span class="nt">&lt;menu</span> <span class="na">action=</span><span class="s">&quot;my action&quot;</span><span class="nt">&gt;&lt;title&gt;</span>/Edit/My Theme Menu<span class="nt">&lt;/title&gt;&lt;/menu&gt;</span>
   <span class="nt">&lt;/theme&gt;</span>
<span class="nt">&lt;/my-plugin&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="defining-new-search-patterns">
<span id="id14"></span><h3>15.5.11. Defining new search patterns<a class="headerlink" href="#defining-new-search-patterns" title="Permalink to this headline">¶</a></h3>
<span class="target" id="index-44"></span><p id="index-45">The search dialog contains a number of predefined search patterns for Ada,
C, and C++. These are generally complex regular expressions, presented in
the dialog with a more descriptive name. For example, <span class="guilabel">Ada
assignment</span>.</p>
<p>Define your own search patterns in the customization files using the
<code class="file docutils literal"><span class="pre">&lt;vsearch-pattern&gt;</span></code> tag. This tag can have the following child tags:</p>
<ul>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;name&gt;</span></code></p>
<p>String displayed in the search dialog to represent the new pattern. This
is the text the user sees (instead of the often hard-to-understand
regular expression)</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;regexp&gt;</span></code></p>
<p>Regular expression to use when the pattern is selected by the user. Be
careful to protect reserved XML characters such as <code class="kbd docutils literal"><span class="pre">&lt;</span></code> and
replace them by their equivalent expansion (<strong class="command">&amp;lt;</strong> in that
case).</p>
<p>This tag accepts one optional attribute, <code class="file docutils literal"><span class="pre">case-sensitive</span></code> a
boolean that specifies whether the search should distinguish lower
case and upper case letters.  The default is <strong class="command">false</strong>.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;string&gt;</span></code></p>
<p>A constant string that should be searched.  Provide either
<code class="file docutils literal"><span class="pre">&lt;regexp&gt;</span></code> or <code class="file docutils literal"><span class="pre">&lt;string&gt;</span></code>, but not both. If both are provided,
the first <code class="file docutils literal"><span class="pre">&lt;regexp&gt;</span></code> child found is used.  The tag accepts the same
optional attribute <code class="file docutils literal"><span class="pre">case-sensitive</span></code> as above.</p>
</li>
</ul>
<p>Here is a short example, showing how the <span class="guilabel">Ada assignment</span> pattern is
defined:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;search&gt;</span>
  <span class="nt">&lt;vsearch-pattern&gt;</span>
    <span class="nt">&lt;name&gt;</span>Ada: assignment<span class="nt">&lt;/name&gt;</span>
    <span class="nt">&lt;regexp</span> <span class="na">case-sensitive=</span><span class="s">&quot;false&quot;</span><span class="nt">&gt;</span>\\b(\\w+)\\s*:=<span class="nt">&lt;/regexp&gt;</span>
  <span class="nt">&lt;/vsearch-pattern&gt;</span>
<span class="nt">&lt;/search&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="defining-custom-highlighters">
<span id="id15"></span><h3>15.5.12. Defining custom highlighters<a class="headerlink" href="#defining-custom-highlighters" title="Permalink to this headline">¶</a></h3>
<span class="target" id="module-highlighter.interface"><span id="index-46"></span></span><p>The mechanism here described allows any user to add syntax highlighting to GPS
for any language in a declarative domain specific language.</p>
<div class="section" id="tutorial-add-support-for-python-highlighting-in-gps">
<h4>15.5.12.1. Tutorial: Add support for python highlighting in GPS<a class="headerlink" href="#tutorial-add-support-for-python-highlighting-in-gps" title="Permalink to this headline">¶</a></h4>
<p>In this short tutorial, we will walk through the steps needed to create a
small plugin for GPS that will allow it to highlight python code.</p>
<p>The idea of the whole API is for the user to declare matchings in a
declarative way, specifying the matcher via a classic regular expression
syntax, and taking the appropriate action depending on the kind of the
matcher. There are basically two types of matches:</p>
<ul class="simple">
<li>Simple matchers will just apply a tag to the matched text region. This
will be useful to highlight keywords or number expressions in source,
for example.</li>
<li>Region matchers will change the set of matchers to the one specified in
the region definition. That way, you can do more complex highlighters in
which some simple matchers will work only in some context.</li>
</ul>
<p>In addition to that, you have a set of helpers that will simplify common
patterns based on those two primitives, or make some additional things
possible. See the full API doc below for more details.</p>
<p><strong>IMPORTANT NOTE</strong>: As you will see, the way you register an highlighter is by
specifying the language it applies to in the call to register_highlighter. If
you want to highlight a language that is not yet known to GPS, you have to
register a new language. The way to do that is detailled in the
<a class="reference internal" href="#adding-support-for-new-languages"><span class="std std-ref">Adding support for new languages</span></a> section.</p>
<div class="section" id="first-step-creating-a-dumb-highlighter">
<h5>15.5.12.1.1. First step, creating a dumb highlighter<a class="headerlink" href="#first-step-creating-a-dumb-highlighter" title="Permalink to this headline">¶</a></h5>
<p>As a first step, we will just create an highlighter that highlights the
self symbol in python, as a simple hello world.:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span>from highlighter.common import *

register_highlighter(
    language=&quot;python&quot;,
    spec=(
        # Match self
        simple(&quot;self&quot;, tag=tag_keyword),
    )
)
</pre></div>
</div>
<p>As we can see, the first step to register a new highlighter is to call the
<a class="reference internal" href="#highlighter.interface.register_highlighter" title="highlighter.interface.register_highlighter"><code class="xref py py-func docutils literal"><span class="pre">register_highlighter()</span></code></a> function, giving the name of the language and
the spec of the language as parameters.</p>
<p>The spec parameter is a tuple of matchers. In this case we have only one,
a simple matcher, as described above, which will match the &#8220;self&#8221; regexp,
and apply the &#8220;keyword&#8221; tag everytime it matches.</p>
<p>The tag parameter is the name of the tag that will be used to highlight matches
. GPS has a number of built-in tags for highlighting, that are all defined in
the <code class="xref py py-mod docutils literal"><span class="pre">highlighter.common</span></code> module. They may not be sufficient, so the
user has the possibility of creating new styles, a capability that we will talk
about later on.</p>
</div>
<div class="section" id="second-step-discovering-our-first-helper">
<h5>15.5.12.1.2. Second step, discovering our first helper<a class="headerlink" href="#second-step-discovering-our-first-helper" title="Permalink to this headline">¶</a></h5>
<p>Highlighting just self is a good first step, but we would like to be a
little more pervasive in our highlighting of keywords. Fortunately for us,
python has a way to dynamically get all the language&#8217;s keywords, by doing:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span>from keywords import kwlist
</pre></div>
</div>
<p>By combining that with the <a class="reference internal" href="#highlighter.interface.words" title="highlighter.interface.words"><code class="xref py py-func docutils literal"><span class="pre">words()</span></code></a> helper, we can easily create a
matcher for every python keyword:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span>register_highlighter(
    language=&quot;python&quot;,
    spec=(
        # Match keywords
        words(kwlist, tag=&quot;keyword&quot;),
    )
)
</pre></div>
</div>
<p>The <a class="reference internal" href="#highlighter.interface.words" title="highlighter.interface.words"><code class="xref py py-func docutils literal"><span class="pre">words()</span></code></a> helper just creates a simple matcher for a list of words.
<code class="code docutils literal"><span class="pre">words([&quot;a&quot;,</span> <span class="pre">&quot;b&quot;,</span> <span class="pre">&quot;c&quot;],</span> <span class="pre">tag=&quot;foo&quot;)</span></code> is equivalent to <code class="code docutils literal"><span class="pre">simple(</span>
<span class="pre">&quot;a|b|c&quot;,</span> <span class="pre">tag=&quot;foo&quot;)</span></code>.</p>
</div>
<div class="section" id="third-step-highlighting-strings-literals-in-a-clever-way">
<h5>15.5.12.1.3. Third step, highlighting strings literals in a clever way<a class="headerlink" href="#third-step-highlighting-strings-literals-in-a-clever-way" title="Permalink to this headline">¶</a></h5>
<p>Next, we&#8217;re gonna want to highlight some literals. Let&#8217;s start by strings,
because they are hard and interresting. A string is a literal that starts
with  a &#8221; or a &#8216; character, and ends with the same character, but one needs
to be  careful because there are several corner cases:</p>
<ul class="simple">
<li>If an escaped string delimiter occurs in the string (&#8221; in a &#8221; string for
example), it should <em>not</em> end the string !</li>
<li>In python, strings delimited by &#8221; or &#8216; are single line strings. It means
that the match needs to be terminated at the end of the line</li>
<li>BUT, if the last character of the line is a backslash, the string actually
continues on the next line !</li>
</ul>
<p>Additionally, some editors are nice enough to highlight escaped chars in a
specific colors inside string literals. Since we want our highlighter to be
cutting edge, we will add this requirement to the list. Here is the
region declaration for this problem, for the case of single quoted strings:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span>string_region = region(
    r&quot;&#39;&quot;, r&quot;&#39;|[^\]$&quot;, tag=&quot;string&quot;,
    highlighter=(
        simple(r&quot;\.&quot;, tag=tag_string_escapes),
    )
)
</pre></div>
</div>
<p>Here are the important points:</p>
<ul class="simple">
<li>The first parameter is the regular expression delimiting the beginning of
the region, in this case a simple quote.</li>
<li>The second parameter is the regular expression delimiting the end of the
region, in this case, either a simple quote, either an end of line anchor
($). This way, a string will be terminated after a new line.</li>
<li>The way both line continuations and escaped quotes are handled is actually
very simple: The simple matcher declared inside the region&#8217;s highlighter
will match any character preceded by a backslash, including newlines. An
important point to understand is that, when inside a region, the matcher
for ending the region has the lowest priority of all. In this case,
it means the simple matcher will consume both quotes and new lines if they
are preceded by a backslash, and so they won&#8217;t be available for the ending
matcher anymore.</li>
</ul>
</div>
<div class="section" id="creating-custom-style-tags">
<h5>15.5.12.1.4. Creating custom style tags<a class="headerlink" href="#creating-custom-style-tags" title="Permalink to this headline">¶</a></h5>
<p>If the style tags predefined in the <code class="xref py py-mod docutils literal"><span class="pre">highlighter.common</span></code> module are not
enough, you can define new ones with the <a class="reference internal" href="#highlighter.interface.new_style" title="highlighter.interface.new_style"><code class="xref py py-func docutils literal"><span class="pre">new_style()</span></code></a> function.</p>
<p>When you define a new style via this function, a corresponding preference will
be created in the GPS preferences, so that the user can change the color later.</p>
<p>The tag_string_escapes common tag is defined with this function this way:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span>tag_string_escapes = new_style(lang=&quot;General&quot;, name=&quot;string_escapes&quot;,
                               foreground_colors=(&#39;#875162&#39;, &#39;#DA7495&#39;))
</pre></div>
</div>
<p>The first parameter is the name of the language for which this applies, or
&#8220;General&#8221; if this can potentially apply to several languages. This will be used
by GPS to choose which preference category will be used for the corresponding
preference.</p>
<p>The second parameter is the name of the style.</p>
<p>The third parameter is the colors that will be used by default for this style.
The first color is the one used for light themes, the second color is the one
used for dark themes.</p>
</div>
<div class="section" id="going-further">
<h5>15.5.12.1.5. Going further<a class="headerlink" href="#going-further" title="Permalink to this headline">¶</a></h5>
<p>All the details of the engine are not yet documented, but if while creating
your highlighter you find yourself stuck, don&#8217;t hesitate to look at the C or
Python highlighters, in the c_highlighter and python_highlighter modules that
are shipped with your version of GPS. Those are complete real world examples
that are used by GPS to highlight files in those languages.</p>
</div>
</div>
<div class="section" id="api-documentation">
<h4>15.5.12.2. API Documentation<a class="headerlink" href="#api-documentation" title="Permalink to this headline">¶</a></h4>
<dl class="function">
<dt id="highlighter.interface.existing_style">
<code class="descclassname">highlighter.interface.</code><code class="descname">existing_style</code><span class="sig-paren">(</span><em>pref_name</em>, <em>name=''</em>, <em>prio=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#highlighter.interface.existing_style" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a new style to apply when a matcher succeeds, using an existing
style as a basis. This probably should not be used directly, but one
should use one of the existing styles declared in
<code class="xref py py-func docutils literal"><span class="pre">Highlighter.common()</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pref_name</strong> (<em>string</em>) &#8211; The name of the preference to bind to the style</li>
<li><strong>name</strong> (<em>string</em>) &#8211; The name of the style, used for the underlying gtk tag</li>
<li><strong>prio</strong> (<em>int</em>) &#8211; The priority of the style compared to others. Higher
priority styles will take precedence over lower priority ones.
-1 means default priority: tags added last have precedence.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">highlighter.engine.Style</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="highlighter.interface.new_style">
<code class="descclassname">highlighter.interface.</code><code class="descname">new_style</code><span class="sig-paren">(</span><em>lang</em>, <em>name</em>, <em>label</em>, <em>doc</em>, <em>foreground_colors</em>, <em>background_colors=('transparent'</em>, <em>'transparent')</em>, <em>font_style='default'</em>, <em>prio=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#highlighter.interface.new_style" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a new style to apply when a matcher successfully matches a
portion of text. A style is the conflation of</p>
<ul class="simple">
<li>An editor tag with corresponding text style</li>
<li>A user preference that will be added to the corresponding language page</li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>lang</strong> (<em>string</em>) &#8211; The language for which this style will be applicable
. This is used to automatically store the preference associated with
this style in the right preferences subcategory.</li>
<li><strong>name</strong> (<em>string</em>) &#8211; The name of the style, used to identify it.</li>
<li><strong>label</strong> (<em>string</em>) &#8211; The label that will be shown in the preferences
dialog for this style.</li>
<li><strong>doc</strong> (<em>string</em>) &#8211; The documentation that will be shown in the preferences
dialog for this style.</li>
<li><strong>foreground_colors</strong> (<em>string</em><em>, </em><em>string</em>) &#8211; The foreground colors of the style, expressed as
a tuple of two CSS-like strings, for example (&#8220;#224488&#8221;, &#8220;#FF6677&#8221;). The
first color is used for light themes, the second is used for dark themes</li>
<li><strong>background_colors</strong> (<em>string</em><em>, </em><em>string</em>) &#8211; The background colors of the style.</li>
<li><strong>font_style</strong> (<em>string</em>) &#8211; : The style of the font, one of &#8220;default&#8221;,
&#8220;normal&#8221;, &#8220;bold&#8221;, &#8220;italic&#8221; or &#8220;bold_italic&#8221;</li>
<li><strong>prio</strong> &#8211; The priority of the style. This determines which style will
prevail if two styles are applied to the same portion of text. See
<code class="xref py py-func docutils literal"><span class="pre">Highlighter.region()</span></code>
-1 means default priority: tags added last have precedence.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">highlighter.engine.Style</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="highlighter.interface.region">
<code class="descclassname">highlighter.interface.</code><code class="descname">region</code><span class="sig-paren">(</span><em>start_re</em>, <em>end_re</em>, <em>tag=None</em>, <em>name=''</em>, <em>highlighter=()</em>, <em>matchall=True</em>, <em>igncase=False</em><span class="sig-paren">)</span><a class="headerlink" href="#highlighter.interface.region" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a matcher for a region, which can contain a whole specific
highlighter</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>start_re</strong> (<em>string</em>) &#8211; The regexp used to match the start of the region</li>
<li><strong>end_re</strong> (<em>string</em>) &#8211; The regexp used to match the end of the region</li>
<li><strong>tag</strong> (<em>highlighter.engine.Style</em>) &#8211; The Tag which will be used to
highlight the whole region. Beware, if you plan to apply other tags to
elements inside the region, they must have an higher priority than this
one !</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">RegionMatcher</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="highlighter.interface.region_ref">
<code class="descclassname">highlighter.interface.</code><code class="descname">region_ref</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="headerlink" href="#highlighter.interface.region_ref" title="Permalink to this definition">¶</a></dt>
<dd><p>Used to reference a region that already exists. The main and only use
for this is to define recursive regions, eg. region that can occur
inside themselves or inside their own sub regions. See  the tutorial for a
concrete use case.</p>
<p>The returned region reference will behave exactly the same as the
original region inside the highlighter.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong> &#8211; The name of the region.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">RegionRef</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="highlighter.interface.region_template">
<code class="descclassname">highlighter.interface.</code><code class="descname">region_template</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#highlighter.interface.region_template" title="Permalink to this definition">¶</a></dt>
<dd><p>Used to partially construct a region, if you want to define for example,
several regions having the same sub highlighter and tag, but not the
same start and end regular expressions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>args</strong> &#8211; Positional params to pass to region</li>
<li><strong>kwargs</strong> &#8211; Keyword params to pass to region</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A partially constructed region</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="highlighter.interface.register_highlighter">
<code class="descclassname">highlighter.interface.</code><code class="descname">register_highlighter</code><span class="sig-paren">(</span><em>language</em>, <em>spec</em>, <em>igncase=False</em><span class="sig-paren">)</span><a class="headerlink" href="#highlighter.interface.register_highlighter" title="Permalink to this definition">¶</a></dt>
<dd><p>Used to register the declaration of an highlighter. See the tutorial for
more information</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>language</strong> (<em>string</em>) &#8211; The language to be used as a filter for the
highlighter.</li>
<li><strong>spec</strong> (<em>tuple</em>) &#8211; The spec of the highlighter.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="highlighter.interface.search_for_capturing_groups">
<code class="descclassname">highlighter.interface.</code><code class="descname">search_for_capturing_groups</code><span class="sig-paren">(</span><em>regexp_string</em><span class="sig-paren">)</span><a class="headerlink" href="#highlighter.interface.search_for_capturing_groups" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of matches for capturing groups in a regular expression.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>regexp_string</strong> (<em>str</em>) &#8211; The regular expression we want to analyze.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="highlighter.interface.simple">
<code class="descclassname">highlighter.interface.</code><code class="descname">simple</code><span class="sig-paren">(</span><em>regexp_string</em>, <em>tag</em><span class="sig-paren">)</span><a class="headerlink" href="#highlighter.interface.simple" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a simple matcher for a regexp string.
Raises an exception if capturing groups are present in the
regular expression (not supported by the engine).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>regexp_string</strong> (<em>str</em>) &#8211; The regular expression for this matcher</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">SimpleMatcher</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="highlighter.interface.words">
<code class="descclassname">highlighter.interface.</code><code class="descname">words</code><span class="sig-paren">(</span><em>words_list</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#highlighter.interface.words" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a matcher for a list of words</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>words_list</strong> (<em>str|list</em><em>[</em><em>str</em><em>]</em><em></em>) &#8211; The list of words, either as a string of &#8220;|&#8221;
separated words, or as a list of strings.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">SimpleMatcher</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
<div class="section" id="adding-support-for-new-languages">
<span id="id16"></span><h3>15.5.13. Adding support for new languages<a class="headerlink" href="#adding-support-for-new-languages" title="Permalink to this headline">¶</a></h3>
<p id="index-47">You have two ways of defining a new language in GPS:</p>
<ul class="simple">
<li>Basic support from registering languages in Python is provided.</li>
<li>If the support provided in Python is not enough, more extensive support is
provided via the XML interface. With time all capabilities will be provided
in the Python interface, and the XML facility will be deprecated.</li>
</ul>
<div class="section" id="adding-support-for-a-new-language-via-the-python-interface">
<h4>15.5.13.1. Adding support for a new language via the Python interface<a class="headerlink" href="#adding-support-for-a-new-language-via-the-python-interface" title="Permalink to this headline">¶</a></h4>
<p>You can register a new language in Python via the class <a class="reference internal" href="GPS.html#GPS.Language" title="GPS.Language"><code class="xref py py-class docutils literal"><span class="pre">GPS.Language</span></code></a>.
The first step is to define a new subclass of GPS.Language, the second is to
register it via a call to <code class="docutils literal"><span class="pre">GPS.Language.register</span></code>. Here is an example</p>
<div class="code python highlight-xml"><div class="highlight"><pre><span></span>class JavaLang(GPS.Language):
    def __init__(self):
        pass

GPS.Language.register(JavaLang(), &quot;java&quot;, &quot;.java&quot;, &quot;&quot;, &quot;&quot;, INDENTATION_SIMPLE)
</pre></div>
</div>
<p>The class is provided to provide the possibility of future further user
customization for a specific language.</p>
<p>For the moment, the support is rudimentary. This is mostly useful if you want
to then register an highlighter for the language in question via the new
highlighters API, see <a class="reference internal" href="#defining-custom-highlighters"><span class="std std-ref">Defining custom highlighters</span></a>.</p>
</div>
<div class="section" id="adding-support-for-a-new-language-via-the-xml-interface">
<h4>15.5.13.2. Adding support for a new language via the XML interface<a class="headerlink" href="#adding-support-for-a-new-language-via-the-xml-interface" title="Permalink to this headline">¶</a></h4>
<p>Define new languages in a custom file by using the <code class="file docutils literal"><span class="pre">&lt;Language&gt;</span></code>
tag. Defining languages gives GPS the ability to perform language-specific
operations such as highlighting the syntax of a file, exploring a file
using the <span class="guilabel">Project</span> view, and finding files associated with that
language.</p>
<p><strong>NOTE</strong>: The highlighting of syntax via the mechanisms described here are
deprecated. See <a class="reference internal" href="#defining-custom-highlighters"><span class="std std-ref">Defining custom highlighters</span></a> for the current way to
highlight custom languages.</p>
<p>The following child tags are available:</p>
<ul>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;Name&gt;</span></code></p>
<p>Short string giving the name of the language.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;Parent&gt;</span></code></p>
<p>Optional name of language that provides default values for all properties
not explicitly set.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;Spec_Suffix&gt;</span></code></p>
<p>String identifying the filetype (including the &#8216;.&#8217; character) of spec
(definition) files for this language.  If the language does not have the
notion of spec or definition file, you should use the <code class="file docutils literal"><span class="pre">&lt;Extension&gt;</span></code>
tag instead.  Only one such tag is permitted for each language.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;Body_Suffix&gt;</span></code></p>
<p>String identifying the filetype of body (implementation) files for this
language.  Only one such tag is permitted for each language.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;Obj_Suffix&gt;</span></code></p>
<p>String identifying the extension for object files for this language.
For example, it is <code class="file docutils literal"><span class="pre">.o</span></code> for C or Ada and <code class="file docutils literal"><span class="pre">.pyc</span></code> for
Python.  The default is <strong class="command">-</strong>, which indicates there are no
object files.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;Extension&gt;</span></code></p>
<p>String identifying one of the valid filetypes for this language.
You can specify several such children.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;Keywords&gt;</span></code></p>
<p>Regular expression for recognizing and highlighting keywords.  You can
specify multiple such tags, which will all be concatenated into a single
regular expression. If the regular expression needs to match characters
other than letters and underscore, you must also edit the
<code class="file docutils literal"><span class="pre">&lt;Wordchars&gt;</span></code> tag. If you specified a parent language, you can
append to the parent <code class="file docutils literal"><span class="pre">&lt;Keywords&gt;</span></code> by providing a <code class="file docutils literal"><span class="pre">mode</span></code>
attribute set to <strong class="command">append</strong> (the default for <code class="file docutils literal"><span class="pre">mode</span></code> is
<strong class="command">override</strong>, where the <code class="file docutils literal"><span class="pre">&lt;Keywords&gt;</span></code> definition replaces the
one from the parent).</p>
<p>You can find the full grammar for regular expression in the spec of the
file <code class="file docutils literal"><span class="pre">g-regpat.ads</span></code> in the GNAT run time.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;Wordchars&gt;</span></code></p>
<p>Most languages have keywords that only contain letters, digits, and
underscore characters.  If you want to also include other special
characters (for example <code class="kbd docutils literal"><span class="pre">&lt;</span></code> and <code class="kbd docutils literal"><span class="pre">&gt;</span></code> in XML), use this tag.  The
value of this tag is a string consisting of all the special characters
that may be present in keywords. You need not include letters, digits or
underscores.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;Context&gt;</span></code></p>
<p>Information that GPS uses to determine the syntax of a file for
highlighting purposes.  The following child tags are defined:</p>
<ul>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;Comment_Start&gt;</span></code>, <code class="file docutils literal"><span class="pre">&lt;Comment</span> <span class="pre">End&gt;</span></code></p>
<p>Strings that determine the start and end of a multiple-line comment.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;New_Line_Comment_Start&gt;</span></code></p>
<p>A regular expression defining the beginning of a single line comment
that ends at the next end of line. This regular expression may contain
multiple possibilities, such as <strong class="command">;|#</strong> for comments starting
after a semicolon or after the pound sign. If you specified a parent
language, you can append to the parent&#8217;s
<code class="file docutils literal"><span class="pre">&lt;New_Line_Comment_Start&gt;</span></code> by including a <code class="file docutils literal"><span class="pre">mode</span></code> attribute
with a value of <strong class="command">append</strong> (the default is <strong class="command">override</strong>,
meaning the <code class="file docutils literal"><span class="pre">&lt;New_Line_Comment_Start&gt;</span></code> definition replaces the
one in the parent).</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;String_Delimiter&gt;</span></code></p>
<p>Character defining the string delimiter.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;Quote_Character&gt;</span></code></p>
<p>Character defining the quote (also called escape) character, used to
include the string delimited inside a string (<code class="kbd docutils literal"><span class="pre">\</span></code> in C).</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;Constant_Character&gt;</span></code></p>
<p>Character defining the beginning of a character literal, in languages
that support such literals (e.g., C).</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;Can_Indent&gt;</span></code></p>
<p>Boolean indicating whether indentation is enabled. The indentation
mechanism is the same for all languages: the number of spaces at the
beginning of the current line is used when indenting the next line.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;Syntax_Highlighting&gt;</span></code></p>
<p>Boolean indicating whether the language syntax should be highlighted
and colorized.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;Case_Sensitive&gt;</span></code></p>
<p>Boolean indicating whether the language (in particular the identifiers
and keywords) is case sensitive.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;Accurate_Xref&gt;</span></code></p>
<p>Boolean indicating whether cross reference information for this
language is fully accurate or whether it is either an approximation or
not present). Default is <strong class="command">False</strong>.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;Use_Semicolon&gt;</span></code></p>
<p>Boolean indicating whether semicolons are expected in sources and can
be used as a delimiter for syntax highlighting purposes. Default is
<strong class="command">False</strong>.</p>
</li>
</ul>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;Categories&gt;</span></code></p>
<p>Optional tag to describe the categories supported by the
<span class="guilabel">Project</span> view. This tag contains a list of <code class="file docutils literal"><span class="pre">&lt;Category&gt;</span></code>
tags, each describing the characteristics of a single category, with the
following child tags:</p>
<ul>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;Name&gt;</span></code></p>
<p>Name of the category, either one of the predefined categories or a new
name, in which case GPS will create a new category.</p>
<p>The predefined categories are <strong class="command">package</strong>, <strong class="command">namespace</strong>,
<strong class="command">procedure</strong>, <strong class="command">function</strong>, <strong class="command">task</strong>,
<strong class="command">method</strong>, <strong class="command">constructor</strong>, <strong class="command">destructor</strong>,
<strong class="command">protected</strong>, <strong class="command">entry</strong>, <strong class="command">class</strong>,
<strong class="command">structure</strong>, <strong class="command">union</strong>, <strong class="command">type</strong>,
<strong class="command">subtype</strong>, <strong class="command">variable</strong>, <strong class="command">local_variable</strong>,
<strong class="command">representation_clause</strong>, <strong class="command">with</strong>, <strong class="command">use</strong>,
<strong class="command">include</strong>, <strong class="command">loop_statement</strong>,
<strong class="command">case_statement</strong>, <strong class="command">if_statement</strong>,
<strong class="command">select_statement</strong>, <strong class="command">accept_statement</strong>,
<strong class="command">declare_block</strong>, <strong class="command">simple_block</strong>, and
<strong class="command">exception_handler</strong>.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;Pattern&gt;</span></code></p>
<p>Regular expression to select a language category.  Like
<code class="file docutils literal"><span class="pre">&lt;Keywords&gt;</span></code> tags, if you specify multiple <code class="file docutils literal"><span class="pre">&lt;Pattern&gt;</span></code>
tags, GPS will concatenate them into a single regular expression.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;Index&gt;</span></code></p>
<p>Index of the subexpression in the pattern that extracts the name of the
entity in this category.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;End_Index&gt;</span></code></p>
<p>Optional tag providing the index of the subexpression used to start the
next search.  The default is the end of the pattern.</p>
</li>
</ul>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;Project_Field&gt;</span></code></p>
<p>Information about the tools used to support this language. The name of
these tools is stored in the project files so you can specify only a
limited number of tools.  This tag is currently only used by the project
properties and wizard and not by other components of GPS.</p>
<p>This tag two attributes:</p>
<ul>
<li><p class="first"><code class="file docutils literal"><span class="pre">Name</span></code></p>
<p>Name of the attribute in the project file. Currently, you can only
specify <strong class="command">compiler_command</strong>.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">Index</span></code></p>
<p>If present, specifies the index to use for the attribute in the project
file. The line defining this attribute looks like:</p>
<div class="highlight-ada"><div class="highlight"><pre><span></span><span class="kr">for</span> <span class="n">Name</span> <span class="p">(</span><span class="s">&quot;Index&quot;</span><span class="p">)</span> <span class="kn">use</span> <span class="s">&quot;value&quot;</span><span class="p">;</span>
</pre></div>
</div>
<p>e.g:</p>
<div class="highlight-ada"><div class="highlight"><pre><span></span><span class="kr">for</span> <span class="n">Compiler_Command</span> <span class="p">(</span><span class="s">&quot;my_language&quot;</span><span class="p">)</span> <span class="kn">use</span> <span class="s">&quot;my_compiler&quot;</span><span class="p">;</span>
</pre></div>
</div>
<p>The value of the index should be either the empty string or the
name of the language.</p>
</li>
</ul>
<p>The value of this attribute is the string to use in the project
properties editor when editing this project field.</p>
</li>
</ul>
<p>here is an example of a language definition for the GPS project files:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="nt">&lt;Custom&gt;</span>
  <span class="nt">&lt;Language&gt;</span>
    <span class="nt">&lt;Name&gt;</span>Project File<span class="nt">&lt;/Name&gt;</span>
    <span class="nt">&lt;Spec_Suffix&gt;</span>.gpr<span class="nt">&lt;/Spec_Suffix&gt;</span>
    <span class="nt">&lt;Keywords&gt;</span>^(case|e(nd|xte(nds|rnal))|for|is|<span class="nt">&lt;/Keywords&gt;</span>
    <span class="nt">&lt;Keywords&gt;</span>limited|null|others|<span class="nt">&lt;/Keywords&gt;</span>
    <span class="nt">&lt;Keywords&gt;</span>p(ackage|roject)|renames|type|use|w(hen|ith))\\b<span class="nt">&lt;/Keywords&gt;</span>

    <span class="nt">&lt;Context&gt;</span>
      <span class="nt">&lt;New_Line_Comment_Start&gt;</span>--<span class="nt">&lt;/New_Line_Comment_Start&gt;</span>
      <span class="nt">&lt;String_Delimiter&gt;</span><span class="ni">&amp;quot;</span><span class="nt">&lt;/String_Delimiter&gt;</span>
      <span class="nt">&lt;Constant_Character&gt;</span><span class="ni">&amp;apos;</span><span class="nt">&lt;/Constant_Character&gt;</span>
      <span class="nt">&lt;Can_Indent&gt;</span>True<span class="nt">&lt;/Can_Indent&gt;</span>
      <span class="nt">&lt;Syntax_Highlighting&gt;</span>True<span class="nt">&lt;/Syntax_Highlighting&gt;</span>
      <span class="nt">&lt;Case_Sensitive&gt;</span>False<span class="nt">&lt;/Case_Sensitive&gt;</span>
    <span class="nt">&lt;/Context&gt;</span>

    <span class="nt">&lt;Categories&gt;</span>
      <span class="nt">&lt;Category&gt;</span>
        <span class="nt">&lt;Name&gt;</span>package<span class="nt">&lt;/Name&gt;</span>
        <span class="nt">&lt;Pattern&gt;</span>^[ \\t]*package[ \\t]+((\\w|\\.)+)<span class="nt">&lt;/Pattern&gt;</span>
        <span class="nt">&lt;Index&gt;</span>1<span class="nt">&lt;/Index&gt;</span>
      <span class="nt">&lt;/Category&gt;</span>
      <span class="nt">&lt;Category&gt;</span>
        <span class="nt">&lt;Name&gt;</span>type<span class="nt">&lt;/Name&gt;</span>
        <span class="nt">&lt;Pattern&gt;</span>^[ \\t]*type[ \\t]+(\\w+)<span class="nt">&lt;/Pattern&gt;</span>
        <span class="nt">&lt;Index&gt;</span>1<span class="nt">&lt;/Index&gt;</span>
      <span class="nt">&lt;/Category&gt;</span>
    <span class="nt">&lt;/Categories&gt;</span>
  <span class="nt">&lt;/Language&gt;</span>
<span class="nt">&lt;/Custom&gt;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="defining-text-aliases">
<span id="id17"></span><h3>15.5.14. Defining text aliases<a class="headerlink" href="#defining-text-aliases" title="Permalink to this headline">¶</a></h3>
<span class="target" id="index-48"></span><p id="index-49">GPS provides a mechanism known as &#8220;aliases&#8221;.  The user can define
these using the <span class="menuselection">Code-&gt;Aliases</span> menu.</p>
<p>Each alias has a name, generally a short string of characters.  When you
type that string in any textual entry in GPS (usually a source editor, but
also entry fields anywhere, such as in a file selector) and press the
special activation key (by default <code class="kbd docutils literal"><span class="pre">Ctrl-o</span></code>, but controlled by a
preference), GPS replaces the string by the text you have associated with it.</p>
<p>Alias names can contain any character except newline but must start with a
letter. GPS looks backward to the start of the word before the current
cursor position, and if the characters between there and the cursor
position is an alias name (using a case insensitive comparison), it expands
the alias.</p>
<img alt="_images/aliases.jpg" id="index-50" src="_images/aliases.jpg" />
<p>The alias editor is divided into three main parts. The left shows the list
of currently defined aliases. Clicking on any of them displays its
replacement text. If you click a second time, GPS displays a text entry
allowing you to rename that alias. A checkbox at the bottom determines
whether the editor displays read-only aliases (i.e., system-wide aliases).</p>
<p>The second part displays the expansion text for the alias, at the bottom
right corner. This text can span multiple lines and contain macros, which
are displayed in a different color. You can insert these macros either by
typing their symbols (as shown below) or by right-clicking in the editor
and selecting the entity in the contextual menu.</p>
<p>The alias editor supports the following macros:</p>
<ul>
<li><p class="first"><code class="file docutils literal"><span class="pre">%_</span></code></p>
<p>Position in the replacement text where the cursor is placed.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%</span><em><span class="pre">name</span></em></code></p>
<p>Name of a parameter. <strong class="command">name</strong> can contain any characters except
closing parenthesis. See below for more information on parameters.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%D</span></code></p>
<p>Current date, in ISO format. The year is displayed first, then the month
and day.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%H</span></code></p>
<p>Current time (hour, minutes, and seconds).</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%O</span></code></p>
<p>For recursive aliases expansion. This macro expands the text before it in
the current replacement of the parameters and possibly other recursive
expansions. This is similar to pressing <code class="kbd docutils literal"><span class="pre">Ctrl-o</span></code> in the expansion of
the alias.</p>
<p>You cannot expand an alias recursively when already expanding that
alias. If the alias expansion for, e.g., <strong class="command">procedure</strong> contains
<strong class="command">procedure%O</strong>, the inner procedure is not expanded.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%%</span></code></p>
<p>A percent sign.</p>
</li>
</ul>
<p>The remaining macros are only expanded if the alias is being expanded in a
source editor:</p>
<ul>
<li><p class="first"><code class="file docutils literal"><span class="pre">%l</span></code></p>
<p>Line on which the cursor is when pressing <code class="kbd docutils literal"><span class="pre">Ctrl-o</span></code>.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%c</span></code></p>
<p>Like <code class="file docutils literal"><span class="pre">%l</span></code>, except the current column.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%f</span></code></p>
<p>Name of current file (its base name only, not including directory).</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%d</span></code></p>
<p>Directory containing current file.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%p</span></code></p>
<p>Base name of the project file referencing the current file.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">%P</span></code></p>
<p>Like <code class="file docutils literal"><span class="pre">%p</span></code>, but the full name of the project file (directory and
base name).</p>
</li>
</ul>
<p>GPS preserves the indentation of the alias when it is expanded. All lines
are indented the same as the alias name. You can override this default
behavior by selecting the checkbox <span class="guilabel">Indent source editor after
expansion</span>.  In that case, GPS replaces the name of the alias by its
expansion and then recomputes the position of each line with its internal
indentation engine as if the text had been inserted manually.</p>
<p>The third part of the alias editor, the top right corner, lists the
parameters for the currently selected alias.  Whenever you insert a
<code class="file docutils literal"><span class="pre">%</span><em><span class="pre">name</span></em></code> string in the expansion text, GPS detects new, changed, or
deleted parameter references and updates the list of parameters to show the
current list.</p>
<p>Each parameter has three attributes:</p>
<ul>
<li><p class="first"><code class="file docutils literal"><span class="pre">name</span></code></p>
<p>The name you use in the expansion text of the alias in the <code class="file docutils literal"><span class="pre">%</span><em><span class="pre">name</span></em></code>
macro.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">Environment</span></code></p>
<p>Whether the default value of the parameter comes from the list of
environment variables set before GPS was started.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">default</span> <span class="pre">value</span></code></p>
<p>Instead of getting the default value from the environment variable, you
can also specify a fixed value.  Clicking on the initial value of the
currently selected variable opens a text entry which you can use to edit
this default value.</p>
</li>
</ul>
<p>When an alias that contains parameters is expanded, GPS first displays a
dialog to ask for the value of the parameters. You can interactively enter
this value, which replaces all corresponding <code class="file docutils literal"><span class="pre">%</span><em><span class="pre">name</span></em></code> entities in
the expanded text.</p>
</div>
<div class="section" id="alias-files">
<h3>15.5.15. Alias files<a class="headerlink" href="#alias-files" title="Permalink to this headline">¶</a></h3>
<p>Customization files can also contain alias definitions that can be used to
create project or system- wide aliases. All customization files are parsed
to look for aliases definitions.  All customization files are treated as
read-only by GPS and therefore cannot be edited through its graphical
interface.  You can override some of the aliases in your own custom files.
The system files are loaded first and aliases defined there can be
overridden by the user-defined file.  There is one specific files which must
contain only aliases definitions: <code class="file docutils literal"><span class="pre">$HOME/.gps/aliases</span></code>. Whenever you
edit aliases graphically or create new ones, they are stored in this file,
which is the only one GPS ever modifies automatically.</p>
<p>These files are standard XML customization files.  The XML tag to use is
<code class="file docutils literal"><span class="pre">&lt;alias&gt;</span></code>, one per new alias.  The following example contains a
standalone customization file, though you may wish to merge the
<code class="file docutils literal"><span class="pre">&lt;alias&gt;</span></code> tag into any other customization file.</p>
<p>The following child tags are supported:</p>
<ul>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;alias&gt;</span></code></p>
<p>Indicates the start of a new alias. It has one mandatory attribute,
<code class="file docutils literal"><span class="pre">name</span></code>, the text to type before pressing <code class="kbd docutils literal"><span class="pre">Ctrl-o</span></code>, and
one optional attribute, <code class="file docutils literal"><span class="pre">indent</span></code>, which, if set to <strong class="command">true</strong>
tells GPS to recompute the indentation of the newly inserted paragraph
after the expansion.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;param&gt;</span></code></p>
<p>One per alias parameter. It has one mandatory attribute, <code class="file docutils literal"><span class="pre">name</span></code>,
the name in <code class="file docutils literal"><span class="pre">%{name)</span></code> in the alias expansion text, and two optional
attributes: <code class="file docutils literal"><span class="pre">environment</span></code>, indicating whether or not the default
value must be read from the environment variables and <code class="file docutils literal"><span class="pre">description</span></code>,
a string that is displayed when asking the parameter&#8217;s value while
expanding the alias.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;text&gt;</span></code></p>
<p>Replacement text, possibly multiple lines.</p>
</li>
</ul>
<p>Here is an example of an alias definition in a configuration file:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="nt">&lt;Aliases&gt;</span>
  <span class="nt">&lt;alias</span> <span class="na">name=</span><span class="s">&quot;proc&quot;</span> <span class="nt">&gt;</span>
    <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">&quot;p&quot;</span> <span class="nt">&gt;</span>Proc1<span class="nt">&lt;/param&gt;</span>
    <span class="nt">&lt;param</span> <span class="na">environment=</span><span class="s">&quot;true&quot;</span> <span class="na">name=</span><span class="s">&quot;env&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;text&gt;</span>procedure %(p) is
%(env)%_
end %(p);<span class="nt">&lt;/text&gt;</span>
  <span class="nt">&lt;/alias&gt;</span>
<span class="nt">&lt;/Aliases&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="defining-project-attributes">
<span id="id18"></span><h3>15.5.16. Defining project attributes<a class="headerlink" href="#defining-project-attributes" title="Permalink to this headline">¶</a></h3>
<span class="target" id="index-51"></span><p id="index-52">Project files are required by GPS and store various pieces of
information related to the current set of source files, including how
to find the source files and how the files should be compile or
manipulated through various tools.</p>
<p>The default set of attributes used by GPS in a project file is limited to
those attributes used by tools packaged with GPS or GNAT.  If you are
delivering your own tools, you may want to store similar information in the
project files, since they are a very convenient location to associate
specific settings with a given set of source files.</p>
<p>GPS lets you manipulate the contents of projects through XML customization
files and script commands. You can add your own typed attributes into the
projects and have them saved automatically when the user saves the project
and reloaded automatically when GPS reloads the project.</p>
<div class="section" id="declaring-the-new-attributes">
<h4>15.5.16.1. Declaring the new attributes<a class="headerlink" href="#declaring-the-new-attributes" title="Permalink to this headline">¶</a></h4>
<p>You can declare new project attributes in two ways: either using the
advanced XML tags below or the <code class="file docutils literal"><span class="pre">&lt;tool&gt;</span></code> tag (see
<a class="reference internal" href="#defining-tool-switches"><span class="std std-ref">Defining tool switches</span></a>).</p>
<p>The customization files support the file:<cite>&lt;project_attribute&gt;</cite> tag, used to
declare attributes GPS should support in a project file.  Attributes that
are not supported by GPS are not accessible through the GPS scripting
languages and generate warnings in the <span class="guilabel">Messages</span> window.</p>
<p>Each project attributes has a type typed and can either have a single value
or have a set of values (a list). Each value can be a free-form string, a
file name, a directory name, or a value extracted from a list of preset
values.</p>
<p>Attributes declared in these customization files are also graphically
editable through the project properties dialog or the project wizard. When
you define an attribute, you need to specify how it is presented to the GPS
user.</p>
<p>The <code class="file docutils literal"><span class="pre">&lt;project_attribute&gt;</span></code> tag accepts the following attributes:</p>
<ul>
<li><p class="first"><code class="file docutils literal"><span class="pre">package</span></code> (string)</p>
<p>Package in the project file containing the attribute.  Good practice
suggests that one such package should be used for each tool.  These
packages provide namespaces so that attributes with the same name but for
different tools do not conflict with each other.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">name</span></code> (string, required)</p>
<p>Name of the attribute. A string with no space that represents a valid Ada
identifier (typically starting with a letter and be followed by a set of
letters, digits or underscores).  This is an internal name used when
saving the attribute in a project file.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">editor_page</span></code> (string, default <strong class="command">General</strong>)</p>
<p>Name of the page in the <span class="guilabel">Project Properties</span> editor dialog in
which the attribute is presented. If no such page exists, GPS creates
one. If the page already exists, the attribute is appended to the bottom
of those already on the page.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">editor_section</span></code> (string)</p>
<p>Name of the section, if any, inside the editor page where the attribute
is displayed. These sections are surrounded by frames, the title of which
is given by the this attribute.  If not present, the attribute is put in
an untitled section.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">label</span></code> (string, default: name of the attribute)</p>
<p>Textual label displayed to the left of the attribute in the graphical
editor used to identify the attribute. However, it can be set to the
empty string if the attribute is in a named section of its own, since the
title of the section may be good enough.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">description</span></code> (string)</p>
<p>Help message describing the role of the attribute, displayed as a tooltip
if the user hovers over the attribute.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">list</span></code> (boolean, default <strong class="command">false</strong>)</p>
<p>If <strong class="command">true</strong>, the project attribute contains a list of values, as
opposed to a single value. An example is the list of source directories
in standard projects.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">ordered</span></code> (boolean, default <strong class="command">false</strong>)</p>
<p>Only relevant if the project attribute contains a list of values, when it
indicates whether the order of the values is relevant.  In most cases,
it is not.  However, the order of source directories, for example,
matters since it also indicates where GPS searches for the source files,
and it stops at the first match.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">omit_if_default</span></code> (boolean, default <strong class="command">true</strong>)</p>
<p>Whether the project attribute should be set explicitly in the project if
the user left it with its default value.  Enable this to keep the project
files as simple as possible if all the tools using this attribute know
about the default value. Otherwise, set it <strong class="command">false</strong> to always
emit the definition of the project attribute.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">base_name_only</span></code> (boolean, default <strong class="command">false</strong>)</p>
<p>If the case of attributes that are a file or directory name, whether the
base name (<strong class="command">true</strong>) or the full path (<strong class="command">false</strong>) is
stored. In most cases, the full path is best. However, since GPS looks
for source files in the list of directories the list of source files, for
example, should only contain base names. This also increases the
portability of project files.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">case_sensitive_index</span></code> (<strong class="command">true</strong>, <strong class="command">false</strong> (default),
or <strong class="command">file</strong>)</p>
<p>Only relevant for project attributes that are indexed on another
attribute (see below for more information on indexed attributes). It
indicates whether two indexes that differ only by their casing are
considered the same. For example, if the index is the name of one of the
languages supported by GPS, the index is case insensitive since &#8220;Ada&#8221; is
the same as &#8220;C&#8221;.</p>
<p>The value <strong class="command">file</strong> indicates that the case sensitivity is the same
as the filesystem of the local host. Use that value when the index is
a filename.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">hide_in</span></code> (string)</p>
<p>Context in which GPS will not allow graphical editing of this attribute.
GPS provides three such contexts (<strong class="command">wizard</strong>,
<strong class="command">library_wizard</strong>, and <strong class="command">properties</strong> corresponding to the
project creation wizards and the project properties editor). If any of
those contexts are specified, GPS will not display the widget to edit this
attribute.  Use this to keep the graphical interface simple.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">disable_if_not_set</span></code> (boolean, default <strong class="command">false</strong>)</p>
<p>If <strong class="command">true</strong>, the field to edit this attribute is grayed out if the
attribute is not explicitly set in the project. In most cases, you will not
specify this, since the default value of the attribute can populate that
field.  However, when the value of the attribute is automatically
computed depending on other attributes, you cannot specify the default
value in the XML file, and it might be simpler to gray out the field. A
checkbox is displayed next to the attribute so the user can choose to
enable the field and add the attribute to the project.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">disable</span></code> (space-separated list of attribute names)</p>
<p>List of attribute whose fields should be grayed out if this attribute is
specified. This only works if both the current attribute and the
referenced attributes all have their <code class="file docutils literal"><span class="pre">disable_if_not_set</span></code> attribute
set <strong class="command">true</strong>.  Use this to create mutually exclusive attributes.</p>
</li>
</ul>
</div>
<div class="section" id="declaring-the-type-of-the-new-attributes">
<h4>15.5.16.2. Declaring the type of the new attributes<a class="headerlink" href="#declaring-the-type-of-the-new-attributes" title="Permalink to this headline">¶</a></h4>
<p>The type of the project attribute is specified by child tags of
<code class="file docutils literal"><span class="pre">&lt;project_attribute&gt;</span></code>. The following tags are recognized:</p>
<ul id="index-53">
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;string&gt;</span></code></p>
<p>Attribute is composed of a single string or a list of strings. This tag
accepts the following XML attributes:</p>
<ul>
<li><p class="first"><code class="file docutils literal"><span class="pre">default</span></code> (string)</p>
<p>Default value of the attribute. If the attribute&#8217;s type is a file or
directory, the default value is normalized: an absolute path is
generated based on the project&#8217;s location, with <strong class="command">&quot;.&quot;</strong>
representing the project&#8217;s directory.  As a special case, if
<code class="file docutils literal"><span class="pre">default</span></code> is surrounded by parenthesis, no normalization is done
so you can on test whether the user is still using the default value.</p>
<p>Another special case is when you specify <strong class="command">project source
files</strong>, which is replaced by the known list of source files for the
project.  However, this does not work from the project wizard, since the
list of source files has not been computed yet.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">type</span></code> (empty string (default), <strong class="command">file</strong>,
<strong class="command">directory</strong>, or <strong class="command">unit</strong>)</p>
<p>What the string represents. In the default case, any value is valid.
For <strong class="command">file</strong>, it should be a file name, although no check is
done to ensure the file actually exists.  Similarly,
<strong class="command">directory</strong> tells GPS to expect a directory. For
<strong class="command">units</strong>, GPS should expect the name of one of the project&#8217;s
units.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">filter</span></code> (<strong class="command">none</strong>, <strong class="command">project</strong>,
<strong class="command">extending_project</strong>, <strong class="command">all_projects</strong>)</p>
<p>Ignored for all types except <strong class="command">file</strong>, where it further
specifies what type of files should be specified by this attribute. If
<strong class="command">none</strong>, any file is valid. If <strong class="command">all_projects</strong>, files from
all projects in the project tree are valid. If <strong class="command">project</strong>, only
files from the selected project are valid. If <strong class="command">extended_project</strong>,
only the files from the project extended by the current project can be
specified. This attribute is not shown if the current project is not an
extension project.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">allow_empty</span></code> (boolean, default <strong class="command">True</strong>)</p>
<p>Whether the value for this attribute can be an empty string. If not and
the user does not specify a value, GPS will display an error message in
the project properties editor and project wizard.</p>
</li>
</ul>
</li>
<li id="index-54"><p class="first"><code class="file docutils literal"><span class="pre">&lt;choice&gt;</span></code></p>
<p>One of the valid values for the attribute.  Use multiple occurrences of
this tag to provide a static list of such values.  If combined with a
<code class="file docutils literal"><span class="pre">&lt;string&gt;</span></code> tag, indicates that the attribute can be any string,
although a set of possible values is provided to the user.  This tag
accepts one optional XML attribute, <code class="file docutils literal"><span class="pre">default</span></code>, a boolean which
indicates whether this value is the default.  If several <code class="file docutils literal"><span class="pre">details</span></code>
attributes are present the default value of the attribute is a list, as
opposed to a single value.</p>
</li>
<li id="index-55"><p class="first"><code class="file docutils literal"><span class="pre">&lt;shell&gt;</span></code></p>
<p>GPS scripting command to execute to get a list of valid values for the
attribute.  Like the <code class="file docutils literal"><span class="pre">&lt;choice&gt;</span></code> tag, this can be combined with a
<code class="file docutils literal"><span class="pre">&lt;string&gt;</span></code> tag to indicate that the list of values returned by the
scripting command is only a set of possible values, but that any valid
is valid.</p>
<p>The <code class="file docutils literal"><span class="pre">&lt;shell&gt;</span></code> tag accepts two attributes:</p>
<ul>
<li><p class="first"><code class="file docutils literal"><span class="pre">lang</span></code> (string, default <strong class="command">shell</strong>)</p>
<p>Scripting language in which the command is written. The only other
possible value is <strong class="command">python</strong>.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">default</span></code> (string)</p>
<p>Default value of the attribute if the user has not specified one.</p>
</li>
</ul>
</li>
</ul>
<span class="target" id="index-56"></span><span class="target" id="index-57"></span><span class="target" id="index-58"></span><p id="index-59">Sometimes either the type of the project attribute or its default value
depends on what the attribute applies to. The project file supports this in
the form of indexed project attributes. This, for example, is used to
specify the name of the executable generated when compiling each of the
main files in the project (e.g., the executable for <code class="file docutils literal"><span class="pre">gps.adb</span></code> is
<code class="file docutils literal"><span class="pre">gps.exe</span></code> and the one for <code class="file docutils literal"><span class="pre">main.c</span></code> is <code class="file docutils literal"><span class="pre">myapp.exe</span></code>).</p>
<p>You can also declare such attributes in XML files. In such cases, the
<code class="file docutils literal"><span class="pre">&lt;project_attribute&gt;</span></code> tag should have one <code class="file docutils literal"><span class="pre">&lt;index&gt;</span></code> child, and
zero or more <code class="file docutils literal"><span class="pre">&lt;specialized_index&gt;</span></code> children.  Each of these two tags
in turn accepts one of the already mentioned <code class="file docutils literal"><span class="pre">&lt;string&gt;</span></code>,
<code class="file docutils literal"><span class="pre">&lt;choice&gt;</span></code>, or <code class="file docutils literal"><span class="pre">&lt;shell&gt;</span></code> tags as children.</p>
<p>The <code class="file docutils literal"><span class="pre">&lt;index&gt;</span></code> tag specifies what other project attribute is used to
index the current one. In the example given above for the executable names,
the index is the attribute containing the list of main files for the
project.</p>
<p>It accepts the following XML attributes:</p>
<ul>
<li><p class="first"><code class="file docutils literal"><span class="pre">attribute</span></code> (string, required)</p>
<p>Name of the other attribute, which must be declared elsewhere in the
customization files and whose type must be a list of values.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">package</span></code> (string)</p>
<p>Package in which the index project attribute is defined. This is used to
uniquely identify attributes with the same name.</p>
</li>
</ul>
<p>Use the <code class="file docutils literal"><span class="pre">&lt;specialized_index&gt;</span></code> tag to override the default type of the
attribute for specific values of the index. For example, project files
contain an attribute specifying the name of the compiler for each language,
which is indexed on the project attribute specifying the language used for
each source file. Its default value depends on the language
(<strong class="program">gnatmake</strong> for Ada, <strong class="program">gcc</strong> for C, etc.). This attribute
requires one XML attribute, <code class="file docutils literal"><span class="pre">value</span></code>, which is the value of the
attribute for which the type is overridden.</p>
<p>Almost all the standard project attributes are defined through an XML file,
<code class="file docutils literal"><span class="pre">projects.xml</span></code>, which is part of the GPS installation. Examine this
file for advanced examples on declaring project attributes.</p>
</div>
<div class="section" id="examples">
<h4>15.5.16.3. Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h4>
<p>The following declares three attributes, each with a single string as their
value. This string represents a file in the first case and a directory in
the last two:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="nt">&lt;custom&gt;</span>
  <span class="nt">&lt;project_attribute</span>

      <span class="na">name=</span><span class="s">&quot;Single1&quot;</span>
      <span class="na">package=</span><span class="s">&quot;Test&quot;</span>
      <span class="na">editor_page=</span><span class="s">&quot;Tests single&quot;</span>
      <span class="na">editor_section=</span><span class="s">&quot;Single&quot;</span>
      <span class="na">description=</span><span class="s">&quot;Any string&quot;</span><span class="nt">&gt;</span>

     <span class="nt">&lt;string</span> <span class="na">default=</span><span class="s">&quot;Default value&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/project_attribute&gt;</span>

  <span class="nt">&lt;project_attribute</span>
      <span class="na">name=</span><span class="s">&quot;File1&quot;</span>
      <span class="na">package=</span><span class="s">&quot;Test&quot;</span>
      <span class="na">editor_page=</span><span class="s">&quot;Tests single&quot;</span>
      <span class="na">editor_section=</span><span class="s">&quot;Single&quot;</span>
      <span class="na">description=</span><span class="s">&quot;Any file&quot;</span> <span class="nt">&gt;</span>

      <span class="nt">&lt;string</span> <span class="na">type=</span><span class="s">&quot;file&quot;</span> <span class="na">default=</span><span class="s">&quot;/my/file&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/project_attribute&gt;</span>

  <span class="nt">&lt;project_attribute</span>
      <span class="na">name=</span><span class="s">&quot;Directory1&quot;</span>
      <span class="na">package=</span><span class="s">&quot;Test&quot;</span>
      <span class="na">editor_page=</span><span class="s">&quot;Tests single&quot;</span>
      <span class="na">editor_section=</span><span class="s">&quot;Single&quot;</span>
      <span class="na">description=</span><span class="s">&quot;Any directory&quot;</span> <span class="nt">&gt;</span>

      <span class="nt">&lt;string</span> <span class="na">type=</span><span class="s">&quot;directory&quot;</span> <span class="na">default=</span><span class="s">&quot;/my/directory/&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/project_attribute&gt;</span>
<span class="nt">&lt;/custom&gt;</span>
</pre></div>
</div>
<p>The following declares an attribute whose value is a string. However, it
provides list of predefined possible values as an help for the user. If the
<code class="file docutils literal"><span class="pre">&lt;string&gt;</span></code> tag was not specified, the attribute&#8217;s value could only be
one of the three possible choices:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;custom&gt;</span>
  <span class="nt">&lt;project_attribute</span>
      <span class="na">name=</span><span class="s">&quot;Static2&quot;</span>
      <span class="na">package=</span><span class="s">&quot;Test&quot;</span>
      <span class="na">editor_page=</span><span class="s">&quot;Tests single&quot;</span>
      <span class="na">editor_section=</span><span class="s">&quot;Single&quot;</span>
      <span class="na">description=</span><span class="s">&quot;Choice from static list (or any string)&quot;</span> <span class="nt">&gt;</span>

      <span class="nt">&lt;choice&gt;</span>Choice1<span class="nt">&lt;/choice&gt;</span>
      <span class="nt">&lt;choice</span> <span class="na">default=</span><span class="s">&quot;true&quot;</span> <span class="nt">&gt;</span>Choice2<span class="nt">&lt;/choice&gt;</span>
      <span class="nt">&lt;choice&gt;</span>Choice3<span class="nt">&lt;/choice&gt;</span>
      <span class="nt">&lt;string</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/project_attribute&gt;</span>
<span class="nt">&lt;/custom&gt;</span>
</pre></div>
</div>
<p>The following declares an attribute whose value is one of the languages
currently supported by GPS. Since this list of languages is only known when
GPS is executed, the example uses a script command to query this list:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;custom&gt;</span>
 <span class="nt">&lt;project_attribute</span>
      <span class="na">name=</span><span class="s">&quot;Dynamic1&quot;</span>
      <span class="na">package=</span><span class="s">&quot;Test&quot;</span>
      <span class="na">editor_page=</span><span class="s">&quot;Tests single&quot;</span>
      <span class="na">editor_section=</span><span class="s">&quot;Single&quot;</span>
      <span class="na">description=</span><span class="s">&quot;Choice from dynamic list&quot;</span> <span class="nt">&gt;</span>

      <span class="nt">&lt;shell</span> <span class="na">default=</span><span class="s">&quot;C&quot;</span> <span class="nt">&gt;</span>supported_languages<span class="nt">&lt;/shell&gt;</span>
  <span class="nt">&lt;/project_attribute&gt;</span>
<span class="nt">&lt;/custom&gt;</span>
</pre></div>
</div>
<p>The following declares an attribute whose value is a set of file names. The
order of files in this list matters to the tools using this attribute:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;custom&gt;</span>
 <span class="nt">&lt;project_attribute</span>
      <span class="na">name=</span><span class="s">&quot;File_List1&quot;</span>
      <span class="na">package=</span><span class="s">&quot;Test&quot;</span>
      <span class="na">editor_page=</span><span class="s">&quot;Tests list&quot;</span>
      <span class="na">editor_section=</span><span class="s">&quot;Lists&quot;</span>
      <span class="na">list=</span><span class="s">&quot;true&quot;</span>
      <span class="na">ordered=</span><span class="s">&quot;true&quot;</span>
      <span class="na">description=</span><span class="s">&quot;List of any file&quot;</span> <span class="nt">&gt;</span>

      <span class="nt">&lt;string</span> <span class="na">type=</span><span class="s">&quot;file&quot;</span> <span class="na">default=</span><span class="s">&quot;Default file&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/project_attribute&gt;</span>
<span class="nt">&lt;/custom&gt;</span>
</pre></div>
</div>
<p>The following declares an attribute whose value is a set of predefined
values. By default, two such values are selected, unless the user overrides
the default:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;custom&gt;</span>
  <span class="nt">&lt;project_attribute</span>
      <span class="na">name=</span><span class="s">&quot;Static_List1&quot;</span>
      <span class="na">package=</span><span class="s">&quot;Test&quot;</span>
      <span class="na">editor_page=</span><span class="s">&quot;Tests list&quot;</span>
      <span class="na">editor_section=</span><span class="s">&quot;Lists&quot;</span>
      <span class="na">list=</span><span class="s">&quot;true&quot;</span>
      <span class="na">description=</span><span class="s">&quot;Any set of values from a static list&quot;</span> <span class="nt">&gt;</span>

      <span class="nt">&lt;choice&gt;</span>Choice1<span class="nt">&lt;/choice&gt;</span>
      <span class="nt">&lt;choice</span> <span class="na">default=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;</span>Choice2<span class="nt">&lt;/choice&gt;</span>
      <span class="nt">&lt;choice</span> <span class="na">default=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;</span>Choice3<span class="nt">&lt;/choice&gt;</span>
  <span class="nt">&lt;/project_attribute&gt;</span>
<span class="nt">&lt;/custom&gt;</span>
</pre></div>
</div>
<p>The following declares an attribute whose value is a string. However, the
value is specific to each language (it could, for example, be the name of a
compiler to use for that language). This is an indexed attribute, with two
default values, one for Ada and one for C. All other languages have no
default value:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;custom&gt;</span>
  <span class="nt">&lt;project_attribute</span>
      <span class="na">name=</span><span class="s">&quot;Compiler_Name&quot;</span>
      <span class="na">package=</span><span class="s">&quot;Test&quot;</span>
      <span class="na">editor_page=</span><span class="s">&quot;Tests indexed&quot;</span>
      <span class="na">editor_section=</span><span class="s">&quot;Single&quot;</span><span class="nt">&gt;</span>

      <span class="nt">&lt;index</span> <span class="na">attribute=</span><span class="s">&quot;languages&quot;</span> <span class="na">package=</span><span class="s">&quot;&quot;</span><span class="nt">&gt;</span>
         <span class="nt">&lt;string</span> <span class="na">default=</span><span class="s">&quot;&quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;/index&gt;</span>
      <span class="nt">&lt;specialized_index</span> <span class="na">value=</span><span class="s">&quot;Ada&quot;</span> <span class="nt">&gt;</span>
         <span class="nt">&lt;string</span> <span class="na">default=</span><span class="s">&quot;gnatmake&quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;/specialized_index&gt;</span>
      <span class="nt">&lt;specialized_index</span> <span class="na">value=</span><span class="s">&quot;C&quot;</span> <span class="nt">&gt;</span>
         <span class="nt">&lt;string</span> <span class="na">default=</span><span class="s">&quot;gcc&quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;/specialized_index&gt;</span>
  <span class="nt">&lt;/project_attribute&gt;</span>
<span class="nt">&lt;/custom&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="accessing-project-attributes">
<h4>15.5.16.4. Accessing project attributes<a class="headerlink" href="#accessing-project-attributes" title="Permalink to this headline">¶</a></h4>
<p>Attributes you define are accessible from the GPS scripting languages like
all the standard attributes, see <a class="reference internal" href="#querying-project-switches"><span class="std std-ref">Querying project switches</span></a>.</p>
<p>For example, you can access the <strong class="command">Compiler_Name</strong> attribute we
created above with a python command similar to:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">GPS</span><span class="o">.</span><span class="n">Project</span><span class="o">.</span><span class="n">root</span><span class="p">()</span><span class="o">.</span><span class="n">get_attribute_as_string</span> <span class="p">(</span><span class="s2">&quot;Compiler_Name&quot;</span><span class="p">,</span> <span class="s2">&quot;Test&quot;</span><span class="p">,</span> <span class="s2">&quot;Ada&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>You can also access the list of main files for the project, for
example, by calling:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">GPS</span><span class="o">.</span><span class="n">Project</span><span class="o">.</span><span class="n">root</span><span class="p">()</span><span class="o">.</span><span class="n">get_attribute_as_list</span> <span class="p">(</span><span class="s2">&quot;main&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="adding-casing-exceptions">
<span id="id19"></span><h3>15.5.17. Adding casing exceptions<a class="headerlink" href="#adding-casing-exceptions" title="Permalink to this headline">¶</a></h3>
<span class="target" id="index-60"></span><p>You can use the customization files to declare a set of case exceptions by
using the <code class="file docutils literal"><span class="pre">&lt;case_exceptions&gt;</span></code> tag.  Put each exception in child tag
of <code class="file docutils literal"><span class="pre">&lt;word&gt;</span></code> or <code class="file docutils literal"><span class="pre">&lt;substring&gt;</span></code>.  GPS uses these exceptions to
determine the case of identifiers and keywords when editing case
insensitive languages (except if corresponding case is set to
<strong class="command">Unchanged</strong>). Here is an example:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;exceptions&gt;</span>
  <span class="nt">&lt;case_exceptions&gt;</span>
     <span class="nt">&lt;word&gt;</span>GNAT<span class="nt">&lt;/word&gt;</span>
     <span class="nt">&lt;word&gt;</span>OS_Lib<span class="nt">&lt;/word&gt;</span>
     <span class="nt">&lt;substring&gt;</span>IO<span class="nt">&lt;/substring&gt;</span>
  <span class="nt">&lt;/case_exceptions&gt;</span>
<span class="nt">&lt;/exceptions&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="adding-documentation">
<span id="id20"></span><h3>15.5.18. Adding documentation<a class="headerlink" href="#adding-documentation" title="Permalink to this headline">¶</a></h3>
<p id="index-62">You can add new documentation to GPS in various ways.  You can create
a new menu, through a <code class="file docutils literal"><span class="pre">&lt;menu&gt;</span></code> tag in a configuration file,
associated with an action that either spawns an external web browser
or calls the function <code class="xref py py-func docutils literal"><span class="pre">GPS.Help.browse()</span></code>.  However, this will not
show the documentation in the <span class="menuselection">Help ‣ Contents</span> menu,
which is where people expect to find it.  To do both, use the
<code class="file docutils literal"><span class="pre">&lt;documentation_file&gt;</span></code> tag. These tags are usually found in a
<code class="file docutils literal"><span class="pre">gps_index.xml</span></code> file, but are permitted in any customization
file.</p>
<p>Your documentation files can contain the usual HTML links.  In addition,
GPS treats links starting with &#8216;%&#8217; specially and considers them as script
commands to execute instead of files to display. The following examples show
how to insert a link that, which clicked by the user, opens a file in GPS:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;%shell:Editor.editor g-os_lib.ads&quot;</span><span class="nt">&gt;</span>Open runtime file<span class="nt">&lt;/a&gt;</span>
</pre></div>
</div>
<p>The first token after &#8216;%&#8217; is the name of the language; the command to
execute is after the &#8216;:&#8217; character.</p>
<p>The <code class="file docutils literal"><span class="pre">&lt;documentation_file&gt;</span></code> tag accepts the following child tags:</p>
<ul>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;name&gt;</span></code></p>
<p>Name of the file, either an absolute filename or a filename relative to
one of the directories in <code class="file docutils literal"><span class="pre">GPS_DOC_PATH</span></code>.  If this child is
omitted, you must specify a <code class="file docutils literal"><span class="pre">&lt;shell&gt;</span></code> child.  The name can contain
a reference to a specific anchor in the HTML file, using the standard
HTML syntax:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;name&gt;</span>file#anchor<span class="nt">&lt;/name&gt;</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;shell&gt;</span></code></p>
<p>Name of a shell command to execute to get the name of the HTML file. This
command could create the HTML file dynamically or download it locally
using some special mechanism.  This child accepts one attribute,
<code class="file docutils literal"><span class="pre">lang</span></code>, the name of the language in which the command is written</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;descr&gt;</span></code></p>
<p>Description for this help file, which appears as a tool tip for the menu
item.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;category&gt;</span></code></p>
<p>Used in the <span class="menuselection">Help ‣ Contents</span> menu to organize all
documentation files.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;menu&gt;</span></code></p>
<p>Full path to the menu. See <a class="reference internal" href="#adding-new-menus"><span class="std std-ref">Adding new menus</span></a>.  If not set, GPS
does not display a menu item for this file, although it still appears
in the <span class="menuselection">Help-&gt;Contents</span> menu</p>
<p>This tag accepts two attributes, <code class="file docutils literal"><span class="pre">before</span></code> and <code class="file docutils literal"><span class="pre">after</span></code>, that
control the position of the menu item.  If the new menu is inserted in a
submenu, the attribute controls the deeper nesting.  Parent menus are
created as needed, but if you wish to control their display order, create
them first with a <code class="file docutils literal"><span class="pre">&lt;submenu&gt;</span></code> tag.</p>
</li>
</ul>
<p>The following example creates a new entry <span class="guilabel">item</span> in the
<span class="guilabel">Help</span> menu, that displays <code class="file docutils literal"><span class="pre">file.html</span></code> (searched for in the
<code class="file docutils literal"><span class="pre">GPS_DOC_PATH</span></code> path):</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="nt">&lt;index&gt;</span>
   <span class="nt">&lt;documentation_file&gt;</span>
      <span class="nt">&lt;name&gt;</span>file.html<span class="nt">&lt;/name&gt;</span>
      <span class="nt">&lt;descr&gt;</span>Tooltip text<span class="nt">&lt;/descr&gt;</span>
      <span class="nt">&lt;category&gt;</span>name<span class="nt">&lt;/category&gt;</span>
      <span class="nt">&lt;menu&gt;</span>/Help/item<span class="nt">&lt;/menu&gt;</span>
   <span class="nt">&lt;/documentation_file&gt;</span>
<span class="nt">&lt;/index&gt;</span>
</pre></div>
</div>
<p id="index-63">The directories given by the <code class="file docutils literal"><span class="pre">GPS_DOC_PATH</span></code> environment variable are
searched for the HTML documentation files. However, you can also use the
<code class="file docutils literal"><span class="pre">&lt;doc_path&gt;</span></code> XML node to define additional directories to search.
Such a directory is relative to the installation directory of GPS.  For
example:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="nt">&lt;GPS&gt;</span>
   <span class="nt">&lt;doc_path&gt;</span>doc/application/<span class="nt">&lt;/doc_path&gt;</span>
<span class="nt">&lt;/GPS&gt;</span>
</pre></div>
</div>
<p>adds the directory <code class="file docutils literal"><span class="pre">&lt;prefix&gt;/doc/application</span></code> to the search path
for documentation.</p>
<p>You can also add such a directory via Python, as in:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">GPS</span><span class="o">.</span><span class="n">HTML</span><span class="o">.</span><span class="n">add_doc_directory</span> <span class="p">(</span><span class="s1">&#39;doc/application&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="adding-custom-icons">
<span id="adding-stock-icons"></span><h3>15.5.19. Adding custom icons<a class="headerlink" href="#adding-custom-icons" title="Permalink to this headline">¶</a></h3>
<p>You can also provide custom icons to be used throughout GPS in places such as
buttons, menus and toolbars.</p>
<p>Images must be either in the PNG or SVG format. The latter (scalable vector
graphic) is preferred, since the image will always display sharply whatever
size is used on the screen. GPS itself always uses SVG icons.</p>
<p id="index-64">The images are searched in multiple base directories:</p>
<blockquote>
<div><ul class="simple">
<li>Any directory mentioned in the environment variable GPS_CUSTOM_PATH.</li>
<li><code class="file docutils literal"><span class="pre">HOME/.gps/icons</span></code></li>
<li><code class="file docutils literal"><span class="pre">&lt;gps_install&gt;/share/gps/icons</span></code></li>
</ul>
</div></blockquote>
<p>In all these cases, icons can be in either the directory itself, or in
subdirectories named <code class="file docutils literal"><span class="pre">hicolor/48x48/apps</span></code>, with the following
conventions:</p>
<blockquote>
<div><ul class="simple">
<li><code class="file docutils literal"><span class="pre">hicolor</span></code> is the name of the icon theme. The default is
&#8216;hicolor&#8217;, and that cannot be changed from GPS itself.</li>
<li><code class="file docutils literal"><span class="pre">48x48</span></code> is the size of the icon.
This is only relevant to PNG images, in case you want to provide
multiple sizes for the image. The directory name should match the
size of the icon, and GPS will automatically select the most
appropriate format when it needs to display the image. For SVG
images, can you instead choose a subdirectory named
<code class="file docutils literal"><span class="pre">hicolor/scalable/16x16</span></code>, where the final size does not
matter since these images can always be resized to any size.</li>
</ul>
</div></blockquote>
<p>Icons are referenced with the basename of the file (no directory info)
with no extension. gtk+ will automatically try a number of variants
like <code class="file docutils literal"><span class="pre">name.svg</span></code>, <code class="file docutils literal"><span class="pre">name.png</span></code>, <code class="file docutils literal"><span class="pre">name-rtl.svg</span></code>,
<code class="file docutils literal"><span class="pre">name-symbolic.svg</span></code>, ...</p>
<p>If you name your icon <code class="file docutils literal"><span class="pre">name-symbolic.svg</span></code>, GPS will automatically
change the foreground and background colors to match the selected color
theme by the user (dark or light). But these icons are only displayed
in grayscale.</p>
<p>As shown in the example above, you should prefix the icon with a unique
name, here <code class="file docutils literal"><span class="pre">my-vcs-</span></code>, to make sure predefined icons do not
get overridden by your icons.</p>
<p>So for instance, if you have put a file <code class="file docutils literal"><span class="pre">mylogo.png</span></code> in
<code class="file docutils literal"><span class="pre">/dir/plug-ins/</span></code>, then you should do the following:</p>
<blockquote>
<div><ul class="simple">
<li>set <cite>GPS_CUSTOM_PATH</cite> to include &#8216;/dir/plug-ins/&#8217;</li>
<li>use <cite>iconname=&#8221;mylogo&#8221;</cite> in your plug-in</li>
</ul>
</div></blockquote>
<p>Further information about icons could be found in a separate document -
<a class="reference external" href="http://www.freedesktop.org/wiki/Specifications/icon-theme-spec/">Icon Theme Specification</a>.</p>
</div>
<div class="section" id="customizing-remote-programming">
<span id="remote-programming-customization"></span><h3>15.5.20. Customizing Remote Programming<a class="headerlink" href="#customizing-remote-programming" title="Permalink to this headline">¶</a></h3>
<p id="index-65">There are two parts to specifying the configuration of remote programming
functionality: the configuration of the tools (remote connection tools,
shells, and rsync parameters) and the servers.</p>
<p>The first part (see <a class="reference internal" href="#defining-a-remote-connection-tool"><span class="std std-ref">Defining a remote connection tool</span></a>,
<a class="reference internal" href="#defining-a-shell"><span class="std std-ref">Defining a shell</span></a>, and <a class="reference internal" href="#configuring-rsync-usage"><span class="std std-ref">Configuring rsync usage</span></a>) is performed by
a pre-installed file in the plugins directory called
<code class="file docutils literal"><span class="pre">protocols.xml</span></code>.</p>
<p>The second part (see <a class="reference internal" href="#defining-a-remote-server"><span class="std std-ref">Defining a remote server</span></a> and
<a class="reference internal" href="#defining-a-remote-path-translation"><span class="std std-ref">Defining a remote path translation</span></a>) creates a <code class="file docutils literal"><span class="pre">remote.xml</span></code>
file in the user&#8217;s <code class="file docutils literal"><span class="pre">gps</span></code> directory when the user has configured them
(see <a class="reference internal" href="remote.html#setup-the-remote-servers"><span class="std std-ref">Setup the remote servers</span></a>). System-wide servers can be also
installed.</p>
<div class="section" id="defining-a-remote-connection-tool">
<span id="id21"></span><h4>15.5.20.1. Defining a remote connection tool<a class="headerlink" href="#defining-a-remote-connection-tool" title="Permalink to this headline">¶</a></h4>
<p id="index-66">A remote connection tool is responsible for making a connection to a remote
machine.  GPS already defines several remote access tools: <strong class="program">ssh</strong>,
<strong class="program">rsh</strong>, <strong class="program">telnet</strong>, and <strong class="program">plink</strong>. You can add support
other tools using the tag <code class="file docutils literal"><span class="pre">&lt;remote_connection_config&gt;</span></code>, which
requires a <code class="file docutils literal"><span class="pre">name</span></code> attribute giving the name of the tool. This name
need not necessarily correspond to the command used to launch the tool.</p>
<p>The following child tags are defined:</p>
<ul>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;start_command&gt;</span></code> (required)</p>
<p>The command used to launch the tool.  This tag supports the
<code class="file docutils literal"><span class="pre">use_pipes</span></code> attribute, which selects on Windows the manner in which
GPS launches the remote tools and accepts the following values:</p>
<ul>
<li><p class="first"><strong class="command">true</strong></p>
<p>Use pipes to launch the tool.</p>
</li>
<li><p class="first"><strong class="command">false</strong> (default)</p>
<p>Use a tty emulation, a bit slower but allows password prompt
retrieval with some tools.</p>
</li>
</ul>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;start_command_common_arg&gt;</span></code></p>
<p>Arguments provided to the tool. This string can contain the
following macros, which are replaced by the following strings:</p>
<ul class="simple">
<li><strong class="command">%C</strong>: Command executed on the remote host (normally the shell
command).</li>
<li><strong class="command">%h</strong>: Remote host name.</li>
<li><strong class="command">%U</strong>: Value of <code class="file docutils literal"><span class="pre">&lt;fstart_command_user_args&gt;</span></code>, if specified.</li>
<li><strong class="command">%u</strong>: User name.</li>
</ul>
<p>If you have not included either <strong class="command">%u</strong> or <strong class="command">%U</strong> in the
string and the user specifies a username in the remote connection
configuration, GPS places the value of <code class="file docutils literal"><span class="pre">&lt;start_command_user_args&gt;</span></code>
at the beginning of the arguments.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;start_command_user_args&gt;</span></code></p>
<p>Arguments used to define a specific user during connection. <strong class="command">%u</strong>
is replaced by the user name.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;send_interrupt&gt;</span></code></p>
<p>Character sequence to send to the connection tool to interrupt the remote
application. If not specified, an Interrupt signal is sent directly to the
tool.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;user_prompt_ptrn&gt;</span></code>, <code class="file docutils literal"><span class="pre">&lt;password_prompt_ptrn&gt;</span></code>,
<code class="file docutils literal"><span class="pre">&lt;passphrase_prompt_ptrn&gt;</span></code></p>
<p>Regular expressions to detect username, password, and passphrase prompts,
respectively, sent by the connection tool. If not specified,
appropriate defaults are used.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;extra_ptrn&gt;</span></code></p>
<p>Used to handle prompts from the connection tool other than for username,
password or passphrase.  The <code class="file docutils literal"><span class="pre">auto_answer</span></code> attribute selects
whether GPS provides an answer to this prompt or asks the user. If
<strong class="command">true</strong>, a <code class="file docutils literal"><span class="pre">&lt;answer&gt;</span></code> child is required.  Its value is the
answer to be supplied by GPS. If <strong class="command">false</strong>, a <code class="file docutils literal"><span class="pre">&lt;question&gt;</span></code>
child is required.  Its value is used by GPS to ask the user a question.
Provide this child once for every prompt that must be handled.</p>
</li>
</ul>
</div>
<div class="section" id="defining-a-shell">
<span id="id22"></span><h4>15.5.20.2. Defining a shell<a class="headerlink" href="#defining-a-shell" title="Permalink to this headline">¶</a></h4>
<p id="index-67">GPS already defines several shells: <strong class="program">sh</strong>, <strong class="program">bash</strong>,
<strong class="program">csh</strong>, <strong class="program">tcsh</strong>, and, on Windows, <code class="file docutils literal"><span class="pre">cmd.exe</span></code>). You can
add other shells by using the <code class="file docutils literal"><span class="pre">&lt;remote_shell_config&gt;</span></code> tag which has
one required attribute, <code class="file docutils literal"><span class="pre">name</span></code>, denoting the name of the shell. This
name need not be same as the command used to launch the shell.</p>
<p>The following child tags are defined:</p>
<ul>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;start_command&gt;</span></code> (require)</p>
<p>Command used to launch the shell.  Put any required arguments here,
separated by spaces.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;generic_prompt&gt;</span></code> (optional)</p>
<p>Regular expression used to identify a prompt after the initial
connection. If not set, a default value is used.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;gps_prompt&gt;</span></code> (required)</p>
<p>Regular expression used to identify a prompt after the initial setup is
performed. If not set, a default value is used.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;filesystem&gt;</span></code> (required)</p>
<p>Either <strong class="command">unix</strong> or <strong class="command">windows</strong>, representing the filesystem
used by the shell.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;init_commands&gt;</span></code> (optional)</p>
<p>Contains <code class="file docutils literal"><span class="pre">&lt;cmd&gt;</span></code> children, each containing a command to initialize
a new session.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;exit_commands&gt;</span></code> (optional)</p>
<p>Like <code class="file docutils literal"><span class="pre">&lt;init_commands&gt;</span></code>, but each <code class="file docutils literal"><span class="pre">&lt;cmd&gt;</span></code> child contains a
command to exit a session.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;no_echo_command&gt;</span></code> (optional)</p>
<p>Command used to tell the remote shell to suppress echo.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;cd_command&gt;</span></code> (require)</p>
<p>Command to change directories. <strong class="command">%d</strong> is replaced by the
directory&#8217;s full name.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;get_status_command&gt;</span></code> (required)</p>
<p>Command used to retrieve the status of the last command launched.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;get_status_ptrn&gt;</span></code> (mandatory)</p>
<p>Regular expression used to retrieve the status returned by
<code class="file docutils literal"><span class="pre">&lt;get_status_command&gt;</span></code>. You must include a single pair of
parentheses; that subexpression identifies the status.</p>
</li>
</ul>
</div>
<div class="section" id="configuring-rsync-usage">
<span id="id23"></span><h4>15.5.20.3. Configuring <strong class="command">rsync</strong> usage<a class="headerlink" href="#configuring-rsync-usage" title="Permalink to this headline">¶</a></h4>
<p id="index-68">GPS includes native support for the <strong class="command">rsync</strong> tool to synchronize
paths during remote programming operations.</p>
<p>By default, GPS uses the <strong class="command">--rsh=ssh</strong> option if <strong class="program">ssh</strong> is
the connection tool used for the server. It also uses the <strong class="command">-L</strong>
switch when transferring files to a Windows local host.</p>
<p>You can define additional arguments to rsync by using the
<code class="file docutils literal"><span class="pre">&lt;rsync_configuration&gt;</span></code> tag, which accepts <code class="file docutils literal"><span class="pre">&lt;arguments&gt;</span></code> tags
as children, each containing additional arguments to pass to
<strong class="program">rsync</strong>.</p>
</div>
<div class="section" id="defining-a-remote-server">
<span id="id24"></span><h4>15.5.20.4. Defining a remote server<a class="headerlink" href="#defining-a-remote-server" title="Permalink to this headline">¶</a></h4>
<span class="target" id="index-69"></span><p id="index-70">Users can define remote servers, as described in
<a class="reference internal" href="remote.html#setup-the-remote-servers"><span class="std std-ref">Setup the remote servers</span></a>.  Doing this creates a <code class="file docutils literal"><span class="pre">remote.xml</span></code>
file in the user&#8217;s <code class="file docutils literal"><span class="pre">gps</span></code> directory, which can be installed in any
plugins directory to set the values system-wide.  The tag used in this file
is <code class="file docutils literal"><span class="pre">&lt;remote_machine_descriptor&gt;</span></code> for each remote server.  You can
also write this tag manually.  Its attributes are:</p>
<ul>
<li><p class="first"><code class="file docutils literal"><span class="pre">nickname</span></code> (required)</p>
<p>Uniquely identifies the server.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">network_name</span></code> (required)</p>
<p>Server&#8217;s network name or IP address.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">remote_access</span></code> (required)</p>
<p>Name of the remote access tool used to access the server.  These tools
are defined in <a class="reference internal" href="#defining-a-remote-connection-tool"><span class="std std-ref">Defining a remote connection tool</span></a>.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">remote_shell</span></code> (required)</p>
<p>Name of the shell used to access the server. See <a class="reference internal" href="#defining-a-shell"><span class="std std-ref">Defining a shell</span></a>.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">remote_sync</span></code> (required)</p>
<p>Remote file synchronization tool used to synchronize files between the
local host and the server. Must be <strong class="command">rsync</strong>.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">debug_console</span></code> (optional)</p>
<p>Boolean that indicates whether GPS displays a debug console during the
connection with a remote host. Default is <strong class="command">false</strong>.</p>
</li>
</ul>
<p>The optionally child tags for this tag are:</p>
<ul>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;extra_init_commands&gt;</span></code></p>
<p>Contains <code class="file docutils literal"><span class="pre">&lt;cmd&gt;</span></code> children whose values are used to set
server-specific initialization commands.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">max_nb_connections</span></code></p>
<p>Positive number representing the maximum number of simultaneous
connections GPS is permitted to launch.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">timeout</span></code></p>
<p>Positive number representing a timeout value (in ms) for every action
performed on the remote host.</p>
</li>
</ul>
</div>
<div class="section" id="defining-a-remote-path-translation">
<span id="id25"></span><h4>15.5.20.5. Defining a remote path translation<a class="headerlink" href="#defining-a-remote-path-translation" title="Permalink to this headline">¶</a></h4>
<span class="target" id="index-71"></span><span class="target" id="index-72"></span><p id="index-73">The user can also define a remote path translation, as described in
<a class="reference internal" href="remote.html#setup-the-remote-servers"><span class="std std-ref">Setup the remote servers</span></a>.  Each remote paths translations
corresponds to one <code class="file docutils literal"><span class="pre">&lt;remote_path_config&gt;</span></code> tag, which has one required
attribute, <code class="file docutils literal"><span class="pre">server_name</span></code>, the server name that uses this path
translation, and contains child <code class="file docutils literal"><span class="pre">&lt;remote_path_config&gt;</span></code> tags, that have
the following required attributes:</p>
<ul>
<li><p class="first"><code class="file docutils literal"><span class="pre">local_path</span></code></p>
<p>Absolute local path, written using local filesystem syntax.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">remote_path</span></code></p>
<p>Absolute remote path, written using remote filesystem syntax.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">sync</span></code></p>
<p>Synchronization mechanism used for the paths (see
<a class="reference internal" href="remote.html#path-settings"><span class="std std-ref">Path settings</span></a>). Must be one of <strong class="command">NEVER</strong>,
<strong class="command">ONCE_TO_LOCAL</strong>, <strong class="command">ONCE_TO_REMOTE</strong>, or <strong class="command">ALWAYS</strong>.</p>
</li>
</ul>
</div>
</div>
<div class="section" id="customizing-build-targets-and-models">
<span id="id26"></span><h3>15.5.21. Customizing Build Targets and Models<a class="headerlink" href="#customizing-build-targets-and-models" title="Permalink to this headline">¶</a></h3>
<p>You can customize the information displayed in
<a class="reference internal" href="compilation.html#the-target-configuration-editor"><span class="std std-ref">The Target Configuration Editor</span></a> and in the <span class="guilabel">Mode
selection</span> via the XML configuration files.</p>
<div class="section" id="defining-new-target-models">
<span id="id27"></span><h4>15.5.21.1. Defining new Target Models<a class="headerlink" href="#defining-new-target-models" title="Permalink to this headline">¶</a></h4>
<p id="index-74">Define a model with a <code class="file docutils literal"><span class="pre">target-model</span></code> tag, which has one attribute,
<code class="file docutils literal"><span class="pre">name</span></code>, containing the name of the model, and which supports the
following child tags:</p>
<ul>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;iconname&gt;</span></code> (required)</p>
<p>Name of the icon associated by default with targets of this model.
See <a class="reference internal" href="#adding-stock-icons"><span class="std std-ref">Adding custom icons</span></a>.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;description&gt;</span></code> (required)</p>
<p>One-line description of what the model supports.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;server&gt;</span></code> (default <strong class="command">Build Server</strong>)</p>
<p>Server used for launching targets of this model. See
<a class="reference internal" href="remote.html#remote-operations"><span class="std std-ref">Remote operations</span></a>.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;is-run&gt;</span></code> (default <strong class="command">False</strong>)</p>
<p>Whether targets of this model correspond to the launching of an
executable instead of performing a build. GPS launches such targets
using an interactive console and does not parse their output for errors.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;uses-shell&gt;</span></code> (default <strong class="command">False</strong>)</p>
<p>Whether GPS should launch targets of this model with the shell pointed to
by the <code class="file docutils literal"><span class="pre">SHELL</span></code> environment variable.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;uses-python&gt;</span></code> (default <strong class="command">False</strong>)</p>
<p>When this is set to :command`True`, launch a Python command rather than an
external process. In this case, the arguments in the command line
are first process using the macro replacement mechanism, and then
concatenated to form the string which is interpreted. For instance the
following:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;command-line&gt;</span>
   <span class="nt">&lt;arg&gt;</span>GPS.Console(&quot;Messages&quot;).write(&quot;<span class="nt">&lt;/arg&gt;</span>
   <span class="nt">&lt;arg&gt;</span>%PP<span class="nt">&lt;/arg&gt;</span>
   <span class="nt">&lt;arg&gt;</span>&quot;)<span class="nt">&lt;/arg&gt;</span>
<span class="nt">&lt;/command-line&gt;</span>
</pre></div>
</div>
<p>Is interpreted as:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">GPS</span><span class="o">.</span><span class="n">Console</span><span class="p">(</span><span class="s2">&quot;Messages&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&lt;full path to the project&gt;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;command-line&gt;</span></code> (required)</p>
<p>Contains <code class="file docutils literal"><span class="pre">&lt;arg&gt;</span></code> child tags, each containing an argument of the
default command line for this model, beginning with the executable name.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;persistent-history&gt;</span></code> (default <strong class="command">True</strong>)</p>
<p>Whether GPS should keep command line history over GPS sessions. If set to
False, GPS provide history of command lines during current session only and
will reset command line to default value after restart.</p>
</li>
</ul>
<ul>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;switches&gt;</span></code></p>
<p>Description of the switches.  (See <a class="reference internal" href="#defining-tool-switches"><span class="std std-ref">Defining tool switches</span></a>):</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
   <span class="nt">&lt;my_model&gt;</span>
   <span class="nt">&lt;target-model</span> <span class="na">name=</span><span class="s">&quot;gprclean&quot;</span> <span class="na">category=</span><span class="s">&quot;&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;description&gt;</span>Clean compilation artifacts with gprclean<span class="nt">&lt;/description&gt;</span>
      <span class="nt">&lt;command-line&gt;</span>
         <span class="nt">&lt;arg&gt;</span>gprclean<span class="nt">&lt;/arg&gt;</span>
         <span class="nt">&lt;arg&gt;</span>-P%PP<span class="nt">&lt;/arg&gt;</span>
         <span class="nt">&lt;arg&gt;</span>%X<span class="nt">&lt;/arg&gt;</span>
      <span class="nt">&lt;/command-line&gt;</span>
      <span class="nt">&lt;icon&gt;</span>gps-clean<span class="nt">&lt;/icon&gt;</span>
      <span class="nt">&lt;switches</span> <span class="na">command=</span><span class="s">&quot;%(tool_name)s&quot;</span> <span class="na">columns=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>
         <span class="nt">&lt;check</span> <span class="na">label=</span><span class="s">&quot;Clean recursively&quot;</span> <span class="na">switch=</span><span class="s">&quot;-r&quot;</span>
                <span class="na">tip=</span><span class="s">&quot;Clean all projects recursively&quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;/switches&gt;</span>
   <span class="nt">&lt;/target-model&gt;</span>
<span class="nt">&lt;/my_model&gt;</span>
</pre></div>
</div>
<p>Additionally, switches defined for target models accept a <code class="file docutils literal"><span class="pre">filter</span></code>
attribute, allowing you to define when a switch is relevant or
not (e.g: switch only defined for newer versions of the executable to
launch).</p>
<p>The  <code class="file docutils literal"><span class="pre">filter</span></code> attribute accepts any named filter: predefined ones
or custom filters defined in XML via the
<a class="reference internal" href="#filtering-actions"><span class="std std-ref">&lt;filter&gt;</span></a> tag.</p>
<p>Here is a simple example showing how to define filters for target model
switches:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;GPS&gt;</span>
   <span class="c">&lt;!-- filter checking that the tool&#39;s version supports the switch</span>
<span class="c">        by calling a python function that actually verifies it --&gt;</span>
   <span class="nt">&lt;filter</span> <span class="na">name=</span><span class="s">&quot;Is_My_Tool_Version_Supported&quot;</span> <span class="na">shell_lang=</span><span class="s">&quot;python&quot;</span>
       <span class="na">shell_cmd=</span><span class="s">&quot;check_my_tool_version(GPS.current_context())&quot;</span><span class="nt">/&gt;</span>

   <span class="nt">&lt;my_model&gt;</span>
      <span class="nt">&lt;target-model</span> <span class="na">name=</span><span class="s">&quot;my_tool&quot;</span> <span class="na">category=</span><span class="s">&quot;&quot;</span><span class="nt">&gt;</span>
         <span class="nt">&lt;description&gt;</span>Model for targets based on &#39;my_tool&#39;<span class="nt">&lt;/description&gt;</span>
         <span class="nt">&lt;command-line&gt;</span>
            <span class="nt">&lt;arg&gt;</span>my_tool<span class="nt">&lt;/arg&gt;</span>
         <span class="nt">&lt;/command-line&gt;</span>
         <span class="nt">&lt;switches</span> <span class="na">command=</span><span class="s">&quot;%(tool_name)s&quot;</span> <span class="na">columns=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;check</span> <span class="na">label=</span><span class="s">&quot;version specific switch&quot;</span>
                   <span class="na">switch=</span><span class="s">&quot;--version-specific-switch&quot;</span>
                   <span class="na">tip=</span><span class="s">&quot;This switch is only supported by newer versions&quot;</span>
                   <span class="na">filter=</span><span class="s">&quot;Is_My_Tool_Version_Supported&quot;</span><span class="nt">/&gt;</span>
         <span class="nt">&lt;/switches&gt;</span>
      <span class="nt">&lt;/target-model&gt;</span>
   <span class="nt">&lt;/my_model&gt;</span>
<span class="nt">&lt;/GPS&gt;</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="defining-new-targets">
<span id="id28"></span><h4>15.5.21.2. Defining new Targets<a class="headerlink" href="#defining-new-targets" title="Permalink to this headline">¶</a></h4>
<p id="index-75">Define targets with a <code class="file docutils literal"><span class="pre">&lt;target&gt;</span></code> tag, which has three attributes:</p>
<ul>
<li><p class="first"><code class="file docutils literal"><span class="pre">name</span></code></p>
<p>Name of the target. It must be a unique name.  Underscores are
interpreted as menu mnemonics. If you want an actual underscore, use a
double underscore.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">category</span></code></p>
<p>Category containing the target for purposes of ordering the tree in the
<span class="guilabel">Target Configuration Dialog</span> and <span class="guilabel">Build</span> menus.
Underscores are interpreted as menu mnemonics. If you want an actual
underscore, use a double underscore.  If the string begins and ends with
an underscore, GPS places the menu for the target in the top level
<span class="guilabel">Build</span> menu.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">messages_category</span></code></p>
<p>Name of category to organize messages in the <span class="guilabel">Locations</span> view.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">model</span></code></p>
<p>Name of the initial model that this target inherits.</p>
</li>
</ul>
<p>This tag accepts the following child tags:</p>
<ul>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;iconname&gt;</span></code></p>
<p>Name of the icon associated by default with targets of this model.
See <a class="reference internal" href="#adding-stock-icons"><span class="std std-ref">Adding custom icons</span></a>.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;in-toolbar&gt;</span></code> (default <strong class="command">False</strong>)</p>
<p>Whether the target has an associated icon in the toolbar.</p>
</li>
<li><p class="first">file:<cite>&lt;in-menu&gt;</cite> (default <strong class="command">True</strong>)</p>
<p>Whether the target has an associated entry in the <span class="guilabel">Build</span> menu.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;in-contextual-menus-for-projects&gt;</span></code> (default <strong class="command">False</strong>)</p>
<p>Whether the target has an associated entry in the contextual menu for
projects.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;in-contextual-menus-for-files&gt;</span></code></p>
<p>Likewise, but for files.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;visible&gt;</span></code> (default <strong class="command">True</strong>)</p>
<p>Whether the target is initially visible in GPS.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;read-only&gt;</span></code> (default <strong class="command">False</strong>)</p>
<p>Whether the user can remove the target.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;target-type&gt;</span></code></p>
<p>If present, a string indicating whether the target represents a simple
target (empty) or a family of targets. The name is a parameter passed to
the <strong class="command">compute_build_targets</strong> hook. If set to <strong class="command">main</strong>, a
new subtarget is created for each main source defined in the project.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;launch-mode&gt;</span></code> (default <strong class="command">MANUALLY</strong>)</p>
<p>How GPS should launch the target. Possible values are
<strong class="command">MANUALLY</strong>, <strong class="command">MANUALLY_WITH_DIALOG</strong>,
<strong class="command">MANUALLY_WITH_NO_DIALOG</strong>, and <strong class="command">ON_FILE_SAVE</strong>.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;server&gt;</span></code> (default <strong class="command">Build_Server</strong>)</p>
<p>Server used for launching Target. See <a class="reference internal" href="remote.html#remote-operations"><span class="std std-ref">Remote operations</span></a>.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;command-line&gt;</span></code></p>
<p>Contains a number of <cite>&lt;arg&gt;</cite> nodes, each with an argument of the default
command line for this target, beginning with the name of the executable:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;my_target&gt;</span>
   <span class="nt">&lt;target</span> <span class="na">model=</span><span class="s">&quot;gprclean&quot;</span> <span class="na">category=</span><span class="s">&quot;C_lean&quot;</span> <span class="na">name=</span><span class="s">&quot;Clean _All&quot;</span><span class="nt">&gt;</span>
       <span class="nt">&lt;in-toolbar&gt;</span>TRUE<span class="nt">&lt;/in-toolbar&gt;</span>
       <span class="nt">&lt;icon&gt;</span>gps-clean<span class="nt">&lt;/icon&gt;</span>
       <span class="nt">&lt;launch-mode&gt;</span>MANUALLY_WITH_DIALOG<span class="nt">&lt;/launch-mode&gt;</span>
       <span class="nt">&lt;read-only&gt;</span>TRUE<span class="nt">&lt;/read-only&gt;</span>
       <span class="nt">&lt;command-line&gt;</span>
          <span class="nt">&lt;arg&gt;</span>%gprclean<span class="nt">&lt;/arg&gt;</span>
          <span class="nt">&lt;arg&gt;</span>-r<span class="nt">&lt;/arg&gt;</span>
          <span class="nt">&lt;arg&gt;</span>%eL<span class="nt">&lt;/arg&gt;</span>
          <span class="nt">&lt;arg&gt;</span>-P%PP<span class="nt">&lt;/arg&gt;</span>
          <span class="nt">&lt;arg&gt;</span>%X<span class="nt">&lt;/arg&gt;</span>
       <span class="nt">&lt;/command-line&gt;</span>
  <span class="nt">&lt;/target&gt;</span>
<span class="nt">&lt;/my_target&gt;</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;output-parsers&gt;</span></code></p>
<p>Optional list of output filters. See <a class="reference internal" href="#processing-targets-output"><span class="std std-ref">Processing Target&#8217;s Output</span></a>
for details.</p>
</li>
</ul>
</div>
<div class="section" id="processing-target-s-output">
<span id="processing-targets-output"></span><h4>15.5.21.3. Processing Target&#8217;s Output<a class="headerlink" href="#processing-target-s-output" title="Permalink to this headline">¶</a></h4>
<p>You can filter output produced by a target&#8217;s run by using custom code.  The
list of filters already provided by GPS is shown below.  By default, each
is executed during each run of a target.</p>
<ul>
<li><p class="first"><code class="file docutils literal"><span class="pre">output_chopper</span></code></p>
<p>Breaks output stream to pieces. Each of the piece contains one or more
line of output and an end of line.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">utf_converter</span></code></p>
<p>Converts the stream to UTF-8 encoding if output is not in UTF-8.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">progress_parser</span></code></p>
<p>Drives GPS&#8217;s progress bar by looking for progress messages in the output
stream.  It excludes such messages from the stream.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">console_writer</span></code></p>
<p>Populates the GPS console with output from the stream.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">location_parser</span></code></p>
<p>Looks for special patterns in output to extract messages associated with
processed files and locations and sends such messages to
<span class="guilabel">Location</span> view (see <a class="reference internal" href="main_window.html#the-locations-view"><span class="std std-ref">The Locations View</span></a>).</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">text_splitter</span></code></p>
<p>Splits output into separate lines to simplify further processing.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">output_collector</span></code></p>
<p>Aggregates output and associates it with the build target.  As result,
the output is available for scripting (see <a class="reference internal" href="GPS.html#GPS.get_build_output" title="GPS.get_build_output"><code class="xref py py-func docutils literal"><span class="pre">GPS.get_build_output()</span></code></a>)
after the build completes:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">text</span> <span class="o">=</span> <span class="n">GPS</span><span class="o">.</span><span class="n">get_build_output</span><span class="p">(</span><span class="o">&lt;</span><span class="n">name</span> <span class="n">of</span> <span class="n">your</span> <span class="n">target</span><span class="o">&gt;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">elaboration_cycles</span></code></p>
<p>Detects the <strong class="program">gnatbind</strong> report about circles in elaboration
dependencies and draws them in the <span class="guilabel">Elaboration Circularities</span>
browser (see <a class="reference internal" href="main_window.html#elaboration-cycles-browser"><span class="std std-ref">The Elaboration Circularities browser</span></a>).</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">end_of_build</span></code></p>
<p>Cleans up internal data after a build run.</p>
</li>
</ul>
<p>See <a class="reference internal" href="GPS.html#GPS.OutputParserWrapper" title="GPS.OutputParserWrapper"><code class="xref py py-class docutils literal"><span class="pre">GPS.OutputParserWrapper</span></code></a> for examples of writing custom filter.</p>
</div>
<div class="section" id="defining-new-modes">
<span id="id29"></span><h4>15.5.21.4. Defining new Modes<a class="headerlink" href="#defining-new-modes" title="Permalink to this headline">¶</a></h4>
<p id="index-76">Define modes with a <code class="file docutils literal"><span class="pre">&lt;builder-mode&gt;</span></code> tag which has one attribute,
<code class="file docutils literal"><span class="pre">name</span></code>, containing the name of the model.  It supports the following
child tags:</p>
<ul>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;description&gt;</span></code></p>
<p>One-line description of what the mode does</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;subdir&gt;</span></code></p>
<p>Optional base name of the subdirectory to create for this mode.  GPS will
substitute the macro arguments <code class="file docutils literal"><span class="pre">%subdir</span></code> in the <code class="file docutils literal"><span class="pre">&lt;extra-args&gt;</span></code>
tags with this value.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;supported-model&gt;</span></code></p>
<p>Name of a model supported by this mode.  You can provide multiple tags,
each corresponding to a supported model and optionally specify a
<code class="file docutils literal"><span class="pre">filter</span></code> attribute corresponding to the switches used for this
mode. By default, all switches are considered.  GPS passes the
<code class="file docutils literal"><span class="pre">&lt;extra-args&gt;</span></code> of the mode matching <code class="file docutils literal"><span class="pre">filter</span></code>
to commands of the supported models.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;extra-args&gt;</span></code></p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">sections</span></code></p>
<p>Optional attribute <code class="file docutils literal"><span class="pre">sections</span></code> contains space-separated list of
switches delimiting a section of a command line (such as
<strong class="command">-bargs -cargs -largs</strong>).  See more details in
<a class="reference internal" href="#defining-tool-switches"><span class="std std-ref">Defining tool switches</span></a>.</p>
<p>List of <code class="file docutils literal"><span class="pre">&lt;arg&gt;</span></code> tags, each containing one extra argument to append
to the command line when launching targets while this mode is active.
Optional attribute <code class="file docutils literal"><span class="pre">section</span></code> sets section of given argument.
Macros are supported in the <cite>&lt;arg&gt;</cite> nodes:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">my_mode</span><span class="o">&gt;</span>
 <span class="o">&lt;</span><span class="n">builder</span><span class="o">-</span><span class="n">mode</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;optimization&quot;</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">description</span><span class="o">&gt;</span><span class="n">Build</span> <span class="k">with</span> <span class="n">code</span> <span class="n">optimization</span> <span class="n">activated</span><span class="o">&lt;/</span><span class="n">description</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">subdir</span><span class="o">&gt;</span><span class="n">optimized_objects</span><span class="o">&lt;/</span><span class="n">subdir</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">supported</span><span class="o">-</span><span class="n">model</span><span class="o">&gt;</span><span class="n">builder</span><span class="o">&lt;/</span><span class="n">supported</span><span class="o">-</span><span class="n">model</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">supported</span><span class="o">-</span><span class="n">model</span><span class="o">&gt;</span><span class="n">gnatmake</span><span class="o">&lt;/</span><span class="n">supported</span><span class="o">-</span><span class="n">model</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">supported</span><span class="o">-</span><span class="n">model</span> <span class="nb">filter</span><span class="o">=</span><span class="s2">&quot;--subdirs=&quot;</span><span class="o">&gt;</span><span class="n">gprclean</span><span class="o">&lt;/</span><span class="n">supported</span><span class="o">-</span><span class="n">model</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">extra</span><span class="o">-</span><span class="n">args</span> <span class="n">sections</span><span class="o">=</span><span class="s2">&quot;-cargs&quot;</span><span class="o">&gt;</span>
     <span class="o">&lt;</span><span class="n">arg</span><span class="o">&gt;--</span><span class="n">subdirs</span><span class="o">=%</span><span class="n">subdir</span><span class="o">&lt;/</span><span class="n">arg</span><span class="o">&gt;</span>
     <span class="o">&lt;</span><span class="n">arg</span> <span class="n">section</span><span class="o">=</span><span class="s2">&quot;-cargs&quot;</span><span class="o">&gt;-</span><span class="n">O2</span><span class="o">&lt;/</span><span class="n">arg</span><span class="o">&gt;</span>
  <span class="o">&lt;/</span><span class="n">extra</span><span class="o">-</span><span class="n">args</span><span class="o">&gt;</span>
 <span class="o">&lt;/</span><span class="n">builder</span><span class="o">-</span><span class="n">mode</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">my_mode</span><span class="o">&gt;</span>
</pre></div>
</div>
</li>
</ul>
</div>
</div>
<div class="section" id="customizing-toolchains">
<span id="toolchains-customization"></span><h3>15.5.22. Customizing Toolchains<a class="headerlink" href="#customizing-toolchains" title="Permalink to this headline">¶</a></h3>
<p>You can customize the list of toolchains and their values presented in the
project editor (see <a class="reference internal" href="projects.html#the-project-wizard"><span class="std std-ref">The Project Wizard</span></a>) with the XML configuration
files.  GPS&#8217;s default list is contained in <code class="file docutils literal"><span class="pre">toolchains.xml</span></code>. You can
add your own toolchain by providing an XML description with the
following tags:</p>
<ul>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;toolchain_default&gt;</span></code></p>
<p>Default names for the different tools used by all toolchains.
The final name used is <code class="file docutils literal"><span class="pre">toolchain_name-default_name</span></code>.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;toolchain&gt;</span></code></p>
<p>Defines a toolchain, with an attribute, <code class="file docutils literal"><span class="pre">name</span></code>, giving the name of
the toolchain, which overrides the default values defined in
<code class="file docutils literal"><span class="pre">&lt;toolchain_default&gt;</span></code>.</p>
</li>
</ul>
<p>Each of the above tags can have the following child tags:</p>
<ul>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;gnat_driver&gt;</span></code></p>
<p>GNAT driver to use.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;gnat_list&gt;</span></code></p>
<p>GNAT list tool to use.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;debugger&gt;</span></code></p>
<p>Debugger to use.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;cpp_filt&gt;</span></code></p>
<p>Reserved.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;compiler&gt;</span></code></p>
<p>Requires a <code class="file docutils literal"><span class="pre">lang</span></code> attribute naming an language and defines the
compiler to use to compile that language.</p>
</li>
</ul>
<p>You can override (including by setting the value to null) any value in the
<code class="file docutils literal"><span class="pre">&lt;toolchain_default&gt;</span></code> tag by providing the same tag withing a
<code class="file docutils literal"><span class="pre">toolchain</span></code> tag.</p>
</div>
</div>
<div class="section" id="adding-support-for-new-tools">
<span id="id30"></span><h2>15.6. Adding support for new tools<a class="headerlink" href="#adding-support-for-new-tools" title="Permalink to this headline">¶</a></h2>
<span class="target" id="index-77"></span><p id="index-78">GPS has built-in support for many external tools.  This list of tools is
frequently enhanced, so if you are planning to use the external tool support
in GPS, check the latest GPS version available.</p>
<p>You can use this feature to support additional tools (in particular,
different compilers). You need to do following to successfully use a tool:</p>
<ul class="simple">
<li>Specify its command line switches.</li>
<li>Pass it the appropriate arguments depending on the current context and
on user input.</li>
<li>Spawn the tool.</li>
<li>Optionally parse its result and act accordingly.</li>
</ul>
<p>Each of these is discussed below. In all cases most of the work can be done
statically through XML customization files.  These files have the same
format as other XML customization files
(<a class="reference internal" href="#customizing-through-xml-and-python-files"><span class="std std-ref">Customizing through XML and Python files</span></a>). Tool descriptions are
found in <code class="file docutils literal"><span class="pre">&lt;tool&gt;</span></code> tags, which accept the following attributes:</p>
<ul>
<li><p class="first"><code class="file docutils literal"><span class="pre">name</span></code> (required)</p>
<p>Name of the tool. This is purely descriptive and appears throughout the
GPS interface whenever this tool is referenced, for example the tabs of
the switch editor.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">package</span></code> (default <strong class="command">ide</strong>)</p>
<p>Which package is used in the project to store information about this
tool, including its switches. You should use the default value unless
you are using one of the predefined packages.</p>
<p>See also <a class="reference internal" href="#defining-project-attributes"><span class="std std-ref">Defining project attributes</span></a> for more information on
defining your own project attributes. Using the XML <code class="file docutils literal"><span class="pre">package</span></code>,
<code class="file docutils literal"><span class="pre">attribute</span></code>, or <code class="file docutils literal"><span class="pre">index</span></code> attributes of <code class="file docutils literal"><span class="pre">&lt;tool&gt;</span></code>
implicitly creates new project attributes as needed.</p>
<p>If <strong class="command">ide</strong> is specified, switches cannot be set for a specific
file, but only at the project level. Support for file-specific switches
currently requires modification of the GPS sources themselves.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">attribute</span></code> (default <strong class="command">default_switches</strong>)</p>
<p>Name of the attribute in the project used to store the switches for the
tool.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">index</span></code> (default is the tool name)</p>
<p>What index is used in the project. This is mostly for internal use by GPS
and indicates which index of the project attribute GPS uses to store the
switches for the tool.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">override</span></code> (default <strong class="command">False</strong>)*</p>
<p>Whether the tool definition can be redefined.  If the tool is defined
several times GPS will display a warning.</p>
</li>
</ul>
<p>This tag supports the following child tags, each described in a separate
section:</p>
<ul class="simple">
<li><a class="reference internal" href="#defining-tool-switches"><span class="std std-ref">&lt;switches&gt;</span></a></li>
<li><a class="reference internal" href="#defining-supported-languages"><span class="std std-ref">&lt;language&gt;</span></a></li>
<li><a class="reference internal" href="#defining-default-command-line"><span class="std std-ref">&lt;initial-cmd-line&gt;</span></a></li>
</ul>
<div class="section" id="defining-supported-languages">
<span id="id31"></span><h3>15.6.1. Defining supported languages<a class="headerlink" href="#defining-supported-languages" title="Permalink to this headline">¶</a></h3>
<p id="index-79">A tool supports one or more languages.  If you do not specify any language,
the tool applies to all languages and the switches editor page is displayed
for all languages.  If at least one language is specified, the switches
editor page will only be displayed if that language is supported by the
project.</p>
<p>Specify the languages that the tool supports using the <code class="file docutils literal"><span class="pre">&lt;tool&gt;</span></code> tag:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;my_tool&gt;</span>
  <span class="nt">&lt;tool</span> <span class="na">name=</span><span class="s">&quot;My Tool&quot;</span> <span class="nt">&gt;</span>
    <span class="nt">&lt;language&gt;</span>Ada<span class="nt">&lt;/language&gt;</span>
    <span class="nt">&lt;language&gt;</span>C<span class="nt">&lt;/language&gt;</span>
  <span class="nt">&lt;/tool&gt;</span>
<span class="nt">&lt;/my_tool&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="defining-the-default-command-line">
<span id="defining-default-command-line"></span><h3>15.6.2. Defining the default command line<a class="headerlink" href="#defining-the-default-command-line" title="Permalink to this headline">¶</a></h3>
<p id="index-80">You can define the command line to be used for a tool when the user is
using the default project and has not overridden the command line in the
project.  Do this with the <code class="file docutils literal"><span class="pre">&lt;initial-cmd-line&gt;</span></code> tag, as a child of
the <code class="file docutils literal"><span class="pre">&lt;tool&gt;</span></code> tag. Its value is the command line to be passed to the
tool.  This command line is parsed in the usual manner and quotes are used
to avoid splitting switches each time a space is encountered:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;my_tool&gt;</span>
  <span class="nt">&lt;tool</span> <span class="na">name=</span><span class="s">&quot;My tool&quot;</span> <span class="nt">&gt;</span>
     <span class="nt">&lt;initial-cmd-line&gt;</span>-a -b -c<span class="nt">&lt;/initial-cmd-line&gt;</span>
  <span class="nt">&lt;/tool&gt;</span>
<span class="nt">&lt;/my_tool&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="defining-tool-switches">
<span id="id32"></span><h3>15.6.3. Defining tool switches<a class="headerlink" href="#defining-tool-switches" title="Permalink to this headline">¶</a></h3>
<p id="index-81">The user must be able to specify which switches are passed to the tool.  If
the tool is only called through custom menus, you can hard-code some or all
of the switches. However, it is usually better to use the project properties
editor so the user can specify project-specific switches.</p>
<p>This is what GPS does by default for Ada, C, and C++. Look at the GPS
installation directory to see how the switches for these languages are
defined in an XML file. These provide extended examples of the use of
customization files.</p>
<p>The switches editor in the project properties editor provides a powerful
interface to the command line, allowing the user to edit the command line
both as text and through GUI widgets.</p>
<p>In customization files, the switches are declared with the
<code class="file docutils literal"><span class="pre">&lt;switches&gt;</span></code> tag, which must be a child of a <code class="file docutils literal"><span class="pre">&lt;tool&gt;</span></code> tag
as described above.  Use this tag to produce the needed GUI widgets to
allow a user to specify the desired switch value.</p>
<p>This tag accepts the following attributes:</p>
<ul>
<li><p class="first"><code class="file docutils literal"><span class="pre">separator</span></code></p>
<p>Default character placed between a switch and its value, for example,
<strong class="command">=</strong> produces <strong class="command">-a=1</strong>. Can override this separately
for each switch. If you want the separator to be a space, you must use
the value <strong class="command">&amp;#32;</strong> instead of a blank since XML parser will
normalize the latter to the empty string when reading the XML file.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">use_scrolled_window</span></code> (default <strong class="command">False</strong>)</p>
<p>Whether boxes of the project editor are placed into scrolled window. This
is particularly useful if the number of displayed switches is large.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">show_command_line</span></code> (default <strong class="command">True</strong>)</p>
<p>If <strong class="command">False</strong>, the command line is not displayed in the project
properties editor.  Use this, for example, if you only want users to edit
the command line through the buttons and other widgets but not directly
as text.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">switch_char</span></code> (Default <strong class="command">-</strong>)</p>
<p>Leading character of command line arguments that are considered to be
switches. Arguments not starting with this character remain unmodified
and do not have graphical widgets associated with them.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">sections</span></code></p>
<p>Space-separated list of switches delimiting a section (such as
<strong class="command">-bargs -cargs -largs</strong>). A section of switches is a set of
switches that are grouped together and preceded by a particular
switch. Sections are always placed at the end of the command line, after
regular switches.</p>
</li>
</ul>
<p>The <code class="file docutils literal"><span class="pre">&lt;switches&gt;</span></code> tag can have any number of child tags, listed below.
Repeat them multiple times if you need several check boxes.  For
consistency, most of these child tags accept the following attributes:</p>
<ul>
<li><p class="first"><code class="file docutils literal"><span class="pre">line</span></code> (default <strong class="command">1</strong>), <code class="file docutils literal"><span class="pre">column</span></code> (default <strong class="command">1</strong>)</p>
<p>This indicates the row or column (respectively) of the frame to contain
the switch.  See the attributes of the same name above.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">label</span></code> (required)</p>
<p>Label displayed in the graphical interface.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">switch</span></code> (required)</p>
<p>Text put in the command line if the switch is selected. This text might
be modified, see the description of <code class="file docutils literal"><span class="pre">&lt;combo&gt;</span></code> and <code class="file docutils literal"><span class="pre">&lt;spin&gt;</span></code>
below.  The value must not contain any spaces.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">switch-off</span></code></p>
<p>Defined in <cite>&lt;check&gt;</cite> tags, where it specified the switch used for
deactivating the relevant feature. Use this for features that are enabled
by default but can be disabled.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">section</span></code></p>
<p>Switch section delimiter (such as <strong class="command">-cargs</strong>). See the
<code class="file docutils literal"><span class="pre">sections</span></code> attribute of the <code class="file docutils literal"><span class="pre">&lt;switches&gt;</span></code> tag for more
information.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">tip</span></code></p>
<p>Tooltip describing the switch more extensively. Tags accepting this
attribute also accept a single child <code class="file docutils literal"><span class="pre">&lt;tip&gt;</span></code> whose value contains
the text to be displayed. The advantage of the latter is that text
formatting is retained.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">before</span></code> (default <strong class="command">false</strong>)</p>
<p>Whether the switch must always be inserted at the beginning of the command
line.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">min</span></code> (default <strong class="command">1</strong>), <code class="file docutils literal"><span class="pre">max</span></code> (default <strong class="command">1</strong>)</p>
<p>Only supported for <code class="file docutils literal"><span class="pre">&lt;spin&gt;</span></code> tags.  Specifies the minimum or
maximum (respectively) value allowed for the switch.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">default</span></code> (default <strong class="command">1</strong>)</p>
<p>Used for <code class="file docutils literal"><span class="pre">&lt;check&gt;</span></code> and <code class="file docutils literal"><span class="pre">&lt;spin&gt;</span></code> tags. See the
description below.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">noswitch</span></code>, <code class="file docutils literal"><span class="pre">nodigit</span></code></p>
<p>Only valid for <code class="file docutils literal"><span class="pre">&lt;combo&gt;</span></code> tags and documented there.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">value</span></code> (required)</p>
<p>Only valid for <cite>&lt;combo-entry&gt;</cite> tags and documented there.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">separator</span></code></p>
<p>Overrides the separator to use between the switch and its value.  See the
description of this attribute for <code class="file docutils literal"><span class="pre">&lt;switches&gt;</span></code>.</p>
</li>
</ul>
<p>Here are the valid children for <code class="file docutils literal"><span class="pre">&lt;switches&gt;</span></code>:</p>
<ul>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;title&gt;</span></code></p>
<p id="index-82">Accepts the <code class="file docutils literal"><span class="pre">line</span></code> and <code class="file docutils literal"><span class="pre">column</span></code> attributes and used to give a
name to a specific frame.  The value of the tag is the title. You need
not specify a name.</p>
<p>Use the <code class="file docutils literal"><span class="pre">line-span</span></code> or <code class="file docutils literal"><span class="pre">column-span</span></code> attribute to specify how
many rows or columns (respectively) the frame should span. The default
for both is <strong class="command">1</strong>.  If is set to <strong class="command">0</strong>, the frame is hidden
from the user. See, for example, the usage in the Ada or C switches
editor.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;check&gt;</span></code></p>
<p id="index-83">Creates a toggle button. When active, the text defined in the switch
attribute is added to the command line. The switch can also be activated
by default (the <code class="file docutils literal"><span class="pre">default</span></code> attribute is <strong class="command">on</strong> or
<strong class="command">true</strong>), in which case, deactivating the switch adds the value
of <code class="file docutils literal"><span class="pre">switch-off</span></code> to the command line.</p>
<p>Accepts the <code class="file docutils literal"><span class="pre">line</span></code>, <code class="file docutils literal"><span class="pre">column</span></code>, <code class="file docutils literal"><span class="pre">label</span></code>, <code class="file docutils literal"><span class="pre">switch</span></code>,
<code class="file docutils literal"><span class="pre">switch-off</span></code>, <code class="file docutils literal"><span class="pre">section</span></code>, <code class="file docutils literal"><span class="pre">default</span></code>, <code class="file docutils literal"><span class="pre">before</span></code>, and
<code class="file docutils literal"><span class="pre">tip</span></code> attributes, and you can specify an optional <code class="file docutils literal"><span class="pre">&lt;tip&gt;</span></code>
child.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;spin&gt;</span></code></p>
<p id="index-84">Adds the contents of the <code class="file docutils literal"><span class="pre">switch</span></code> attribute followed by the current
numeric value of the widget to the command line. One usage is to indicate
indentation length.  If the current value of the widget is equal to the
<code class="file docutils literal"><span class="pre">default</span></code> attribute, nothing is added to the command line.</p>
<p>This tag accepts the <code class="file docutils literal"><span class="pre">line</span></code>, <code class="file docutils literal"><span class="pre">column</span></code>, <code class="file docutils literal"><span class="pre">label</span></code>,
<code class="file docutils literal"><span class="pre">switch</span></code>, <code class="file docutils literal"><span class="pre">section</span></code>, <code class="file docutils literal"><span class="pre">tip</span></code>, <code class="file docutils literal"><span class="pre">min</span></code>, <code class="file docutils literal"><span class="pre">max</span></code>,
<code class="file docutils literal"><span class="pre">separator</span></code>, and <code class="file docutils literal"><span class="pre">default</span></code> attributes and you can specify an
optional <code class="file docutils literal"><span class="pre">&lt;tip&gt;</span></code> child.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;radio&gt;</span></code></p>
<p id="index-85">Groups together any number of children, each of which is associated with
its own switch, allowing only one of the children can be selected at any
given time.</p>
<p>This tag accepts the <code class="file docutils literal"><span class="pre">line</span></code>, <code class="file docutils literal"><span class="pre">column</span></code> , <code class="file docutils literal"><span class="pre">label</span></code>,
<code class="file docutils literal"><span class="pre">switch</span></code>, <code class="file docutils literal"><span class="pre">section</span></code>, <code class="file docutils literal"><span class="pre">before</span></code>, and <code class="file docutils literal"><span class="pre">tip</span></code>
attributes.  Specify an empty value for the <code class="file docutils literal"><span class="pre">switch</span></code> attribute to
indicate the default switch to use in this group of radio buttons.  Each
child must have the tag <code class="file docutils literal"><span class="pre">radio-entry</span></code> or <code class="file docutils literal"><span class="pre">&lt;tip&gt;</span></code>.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;field&gt;</span></code></p>
<p id="index-86">Creates a text field, which can contain any text the user types and be
editable by the user. This text is prefixed by the value of the
<code class="file docutils literal"><span class="pre">switch</span></code> attribute and the separator character. If the user does not
enter any text in the field, nothing is added to the command line.</p>
<p>You can specify an optional <code class="file docutils literal"><span class="pre">&lt;tip&gt;</span></code> child tag.  This tag accepts
the <code class="file docutils literal"><span class="pre">line</span></code>, <code class="file docutils literal"><span class="pre">column</span></code>, <code class="file docutils literal"><span class="pre">label</span></code>, <code class="file docutils literal"><span class="pre">switch</span></code>,
<code class="file docutils literal"><span class="pre">section</span></code>, <code class="file docutils literal"><span class="pre">separator</span></code>, <code class="file docutils literal"><span class="pre">before</span></code>, and <code class="file docutils literal"><span class="pre">tip</span></code>
attributes, and the following additional attributes:</p>
<ul>
<li><p class="first"><code class="file docutils literal"><span class="pre">as-directory</span></code></p>
<p id="index-87">If <strong class="command">true</strong>, an extra <span class="guilabel">Browse</span> button is displayed,
allowing the user to easily select a directory.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">as-file</span></code></p>
<p id="index-88">Like <code class="file docutils literal"><span class="pre">as-directory</span></code>, but opens a dialog to select a file instead
of a directory. If both attributes are <strong class="command">true</strong>, GPS displays
a file selector.</p>
</li>
</ul>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;combo&gt;</span></code></p>
<span class="target" id="index-89"></span><p id="index-90">GPS inserts the text from the <code class="file docutils literal"><span class="pre">switch</span></code> attribute, concatenated
with the text of the <code class="file docutils literal"><span class="pre">value</span></code> attribute for the currently
selected entry, into the command line.  If the value of the current
entry is the same as that of the <code class="file docutils literal"><span class="pre">nodigit</span></code> attribute, only the
text of the <code class="file docutils literal"><span class="pre">switch</span></code> attribute is inserted into the command
line. (This is used, for example, to interpret the gcc switch
<strong class="command">-O</strong> as <strong class="command">-O1</strong>.)  If the value of the current entry
is the same as that of the <code class="file docutils literal"><span class="pre">noswitch</span></code> attribute, nothing is
added to the command line.</p>
<p>This tag accepts the <code class="file docutils literal"><span class="pre">line</span></code>, <code class="file docutils literal"><span class="pre">column</span></code>, <code class="file docutils literal"><span class="pre">label</span></code>,
<code class="file docutils literal"><span class="pre">switch</span></code>, <code class="file docutils literal"><span class="pre">section</span></code>, <code class="file docutils literal"><span class="pre">before</span></code>, <code class="file docutils literal"><span class="pre">tip</span></code>,
<code class="file docutils literal"><span class="pre">noswitch</span></code>, <code class="file docutils literal"><span class="pre">separator</span></code>, and <code class="file docutils literal"><span class="pre">nodigit</span></code> attributes
and any number of <code class="file docutils literal"><span class="pre">combo-entry</span></code> child tags, each of which
accepts the <code class="file docutils literal"><span class="pre">label</span></code> and <code class="file docutils literal"><span class="pre">value</span></code> attribute.  You can also
include an optional <code class="file docutils literal"><span class="pre">&lt;tip&gt;</span></code> child.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;popup&gt;</span></code></p>
<p id="index-91">Displays a button that, when clicked, displays a dialog with some
additional switches. This dialog, like the switches editor itself,
is organized into lines and columns of frames, the number of which
is provided by the <code class="file docutils literal"><span class="pre">lines</span></code> and <code class="file docutils literal"><span class="pre">columns</span></code> attributes.</p>
<p>This tag accepts those attributes as well as the <code class="file docutils literal"><span class="pre">label</span></code> attribute and
any number of child <code class="file docutils literal"><span class="pre">&lt;switch&gt;</span></code> tags.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;dependency&gt;</span></code></p>
<p id="index-92">Describes a relationship between two switches.  For example, when
the <span class="guilabel">Debug Information</span> switch is selected for
<span class="guilabel">Make</span>, we need to force it for the compiler as well.</p>
<p>This tag supports the following additional attributes:</p>
<ul>
<li><p class="first"><code class="file docutils literal"><span class="pre">master-page</span></code>, <code class="file docutils literal"><span class="pre">master-switch</span></code>, <code class="file docutils literal"><span class="pre">master-section</span></code></p>
<p>Define the switch that can force a specific setting for a slave
switch. In our example, they have the values <strong class="command">Make</strong> and
<strong class="command">-g</strong>.  The switch referenced by these attributes must be
of type <code class="file docutils literal"><span class="pre">&lt;check&gt;</span></code> or <code class="file docutils literal"><span class="pre">&lt;field&gt;</span></code>. If it is part of a
section, you must also specify the <code class="file docutils literal"><span class="pre">master-section</span></code>
attribute. If the user selects the check button of the this
switch, GPS forces the selection of the check button for the slave
switch. Likewise, if user sets the field to any value, GPS sets
the slave switch to that same value.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">slave-page</span></code>, <code class="file docutils literal"><span class="pre">slave-switch</span></code>, :file:` slave-section`</p>
<p>Likewise, but designates the slave switch.  In our example, they
have the values <strong class="command">Ada</strong> and <strong class="command">-g</strong>.  The switch
referenced by these attributes must be of type <code class="file docutils literal"><span class="pre">&lt;check&gt;</span></code>
or <code class="file docutils literal"><span class="pre">&lt;field&gt;</span></code>.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">master-status</span></code>, <code class="file docutils literal"><span class="pre">slave-status</span></code></p>
<p>Which state of the master switch forces which state of the slave
switch. In our example, they both have the value <strong class="command">on</strong>:
when the user enables debug information for <strong class="program">make</strong>, GPS
also enables compiler debug information. However, if the user
does not enable debug information for <strong class="program">make</strong>, nothing is
changed for the compiler debug information.  If you specify
<strong class="command">off</strong> for <code class="file docutils literal"><span class="pre">master-status</span></code> and the master switch is
a field, GPS changes the status of the slave when the user does not
specify any value in the master switch&#8217;s field.</p>
</li>
</ul>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;default-value-dependency&gt;</span></code></p>
<p id="index-93">Describes a relationship between two switches, which is slightly
different from the <code class="file docutils literal"><span class="pre">&lt;dependency&gt;</span></code> tag.  This relationship only
affects the default values. For example, when the <strong class="command">-gnatwa</strong>
switch is selected for the Ada compiler, other switches, such as
<strong class="command">-gnatwc</strong> and <strong class="command">-gnatwd</strong>, are enabled by default. But
the user can disable them by specifying, e,g., <strong class="command">-gnatwC</strong> and
<strong class="command">-gnatwD</strong>.</p>
<p>It supports the following additional attributes:</p>
<ul>
<li><p class="first"><code class="file docutils literal"><span class="pre">master-switch</span></code></p>
<p>Switch that triggers the dependency. If that switch is present in the
command line, GPS changes the default status of <code class="file docutils literal"><span class="pre">slave-switch</span></code>.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">slave-switch</span></code></p>
<p>Switch whose default value depends on <code class="file docutils literal"><span class="pre">master-switch</span></code>. This must
be a switch already defined in a <code class="file docutils literal"><span class="pre">&lt;switch&gt;</span></code> tag.  The switch can
match the <code class="file docutils literal"><span class="pre">switch</span></code> or <code class="file docutils literal"><span class="pre">switch-off</span></code> attributes. In the
latter case, the slave-switch default value is disabled if the user
specifies the <code class="file docutils literal"><span class="pre">master-switch</span></code>.</p>
</li>
</ul>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;expansion&gt;</span></code></p>
<span class="target" id="index-94"></span><p id="index-95">Describe how switches are grouped together on the command line to keep it
shorter. It also defines aliases between switches.</p>
<p>It is easier to explain the functioning of this tag with an
example. Specifying the GNAT switch <strong class="command">-gnatyy</strong> is equivalent to
specifying <strong class="command">-gnaty3abcefhiklmnprst</strong>. This is a style check
switch with a number of default values.  But it can also be decomposed it
into several switches, such as <strong class="command">-gnatya</strong> and <strong class="command">-gnatyb</strong>.
Knowing this, GPS can keep the command line length as short as possible,
making it more readable.</p>
<p>Specify the above details in the <code class="file docutils literal"><span class="pre">&lt;expansion&gt;</span></code> tag, which supports
two attributes: <code class="file docutils literal"><span class="pre">switch</span></code> is mandatory and <code class="file docutils literal"><span class="pre">alias</span></code> is
optional. In our example, <code class="file docutils literal"><span class="pre">alias</span></code> contains the text
<strong class="command">-gnatyabcefhiklmnprst</strong>.</p>
<p>This tag works in two ways:</p>
<ul class="simple">
<li>If you do not specify the <code class="file docutils literal"><span class="pre">alias</span></code> attribute, the <code class="file docutils literal"><span class="pre">switch</span></code>
attribute requests GPS to group all switches starting with that prefix.
For example, if you specify <strong class="command">-gnatw</strong> as the value of the
<code class="file docutils literal"><span class="pre">switch</span></code> attribute, if the user selects both the <strong class="command">-gnatwa</strong>
and <strong class="command">-gnatw.b</strong> switches, GPS merges them on the command line as
<strong class="command">-gnatwa.b</strong>.</li>
<li>If you specify the <code class="file docutils literal"><span class="pre">alias</span></code>, GPS views the <code class="file docutils literal"><span class="pre">switch</span></code>
attribute as a shorter way of writing the switch. For example, if
<code class="file docutils literal"><span class="pre">switch</span></code> is <strong class="command">-gnatyy</strong> and <code class="file docutils literal"><span class="pre">alias</span></code> is
&#8220;<strong class="command">-gnaty3abcefhiklmnprst</strong>, then if the user types
<strong class="command">-gnatyy</strong>, it means the whole set of options.</li>
</ul>
<p>You can specify the same <code class="file docutils literal"><span class="pre">switch</span></code> attribute can be used in multiple
<code class="file docutils literal"><span class="pre">&lt;expansion&gt;</span></code> tags nodes if you want to combine their behavior.</p>
<p>For historical reasons, this tag supports <code class="file docutils literal"><span class="pre">&lt;entry&gt;</span></code> child tags, but
these are no longer used.</p>
</li>
</ul>
</div>
<div class="section" id="executing-external-tools">
<span id="id33"></span><h3>15.6.4. Executing external tools<a class="headerlink" href="#executing-external-tools" title="Permalink to this headline">¶</a></h3>
<p>Once the user specified the switches to use for the external tool, it can
be spawned from a menu item or by pressing a key.  Both cases are described
in an XML customization file, as described previously, and both execute
what GPS calls an action, a set of commands defined by an <code class="file docutils literal"><span class="pre">&lt;action&gt;</span></code>
tag.</p>
<div class="section" id="chaining-commands">
<span id="id34"></span><h4>15.6.4.1. Chaining commands<a class="headerlink" href="#chaining-commands" title="Permalink to this headline">¶</a></h4>
<p>The <code class="file docutils literal"><span class="pre">&lt;action&gt;</span></code> tag (see <a class="reference internal" href="#defining-actions"><span class="std std-ref">Defining Actions</span></a>) executes one or more
commands, either internal GPS commands (written in any of the scripting
language supported by GPS) or external commands provided by executables
found on the <code class="file docutils literal"><span class="pre">PATH</span></code>.</p>
<p>You can hard-code the command line for each of these commands in the
customization file or it can be the result of previous commands executed as
part of the same action. As GPS executes each command from the action, it
saves its output on a stack. If a command line contains the construct
<strong class="command">%1</strong>, <strong class="command">%2</strong>, etc., these constructs are replaced
respectively by the result the last command executed, the previous command,
and so on. The replacement is done with the value returned by the command,
not by any output it might have made to some of the consoles in GPS.  Each
time GPS executes a new command, it pushes the previous result on the
stack, so that, for example, the value of <strong class="command">%1</strong> becomes the value
of <strong class="command">%2</strong>.</p>
<p>The result of the previous commands is substituted exactly as is.  However,
if the output is surrounded by quotes, GPS ignores them when a substitution
is done, so you must put them back if needed. This is done because many
scripting languages systematically protect their output with quotes (simple
or double) and these quotes are often undesired when calling further
external commands:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;quotes&gt;</span>
  <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&quot;test quotes&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;shell</span> <span class="na">lang=</span><span class="s">&quot;python&quot;</span><span class="nt">&gt;</span>&#39;-a -b -c&#39;<span class="nt">&lt;/shell&gt;</span>
    <span class="nt">&lt;external&gt;</span> echo with quotes: &quot;%1&quot;<span class="nt">&lt;/external&gt;</span>
    <span class="nt">&lt;external&gt;</span> echo without quotes: %2<span class="nt">&lt;/external&gt;</span>
  <span class="nt">&lt;/action&gt;</span>
<span class="nt">&lt;/quotes&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="saving-open-windows">
<span id="id35"></span><h4>15.6.4.2. Saving open windows<a class="headerlink" href="#saving-open-windows" title="Permalink to this headline">¶</a></h4>
<p id="index-96">Before launching the external tool, you may want to force GPS to save all
open files. Do this using the same command GPS uses before starting a
compilation, <strong class="command">MDI.save_all</strong>, which takes one optional boolean
argument specifying whether GPS displays an interactive dialog for the
user.</p>
<p>This command fails when the user presses cancel, so you can put it in its
own <code class="file docutils literal"><span class="pre">&lt;shell&gt;</span></code> command, as in:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;save_children&gt;</span>
  <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&quot;test save children&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;shell&gt;</span>MDI.save_all 0<span class="nt">&lt;/shell&gt;</span>
    <span class="nt">&lt;external&gt;</span>echo Run unless Cancel was pressed<span class="nt">&lt;/external&gt;</span>
  <span class="nt">&lt;/action&gt;</span>
<span class="nt">&lt;/save_children&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="querying-project-switches">
<span id="id36"></span><h4>15.6.4.3. Querying project switches<a class="headerlink" href="#querying-project-switches" title="Permalink to this headline">¶</a></h4>
<span class="target" id="index-97"></span><span class="target" id="index-98"></span><span class="target" id="index-99"></span><p id="index-100">You can use GPS shell commands to query the default switches set by the
user in the project file. These are <code class="xref py py-func docutils literal"><span class="pre">get_tool_switches_as_string()</span></code>,
<code class="xref py py-func docutils literal"><span class="pre">get_tool_switches_as_list()</span></code>, or, more generally,
<code class="xref py py-func docutils literal"><span class="pre">get_attribute_as_string()</span></code> and <code class="xref py py-func docutils literal"><span class="pre">get_attribute_as_list()</span></code>. The
first two require a unique parameter, the name of the tool as specified in
the <code class="file docutils literal"><span class="pre">&lt;tool&gt;</span></code> tag. This name is case-sensitive.  The last two commands
are more general and can be used to query the status of any attribute in
the project. See their description by typing the following in the GPS shell
console window:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span>help Project.get_attribute_as_string
help Project.get_attribute_as_list
</pre></div>
</div>
<p>The following is a short example on how to query the switches for the tool
<span class="guilabel">Find</span> from the project shown as <a class="reference internal" href="#tool-example"><span class="std std-ref">Tool example</span></a>. It first
creates an object representing the current project, then passes this object
as the first argument of the <code class="xref py py-func docutils literal"><span class="pre">get_tool_switches_as_string()</span></code>
command. The last external command outputs these switches:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;find_switches&gt;</span>
  <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&quot;Get switches for Find&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;shell&gt;</span>Project %p<span class="nt">&lt;/shell&gt;</span>
    <span class="nt">&lt;shell&gt;</span>Project.get_tool_switches_as_string %1 Find <span class="nt">&lt;/shell&gt;</span>
    <span class="nt">&lt;external&gt;</span>echo %1<span class="nt">&lt;/external&gt;</span>
  <span class="nt">&lt;/action&gt;</span>
<span class="nt">&lt;/find_switches&gt;</span>
</pre></div>
</div>
<p>The following example shows how something similar can be done from Python,
in a simpler manner.  This function queries the Ada compiler switches for
the current project and prints them in the <span class="guilabel">Messages</span> view:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;query_switches&gt;</span>
  <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&quot;Query compiler switches&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;shell</span> <span class="na">lang=</span><span class="s">&quot;python&quot;</span><span class="nt">&gt;</span>GPS.Project(&quot;%p&quot;).get_attribute_as_list
      (package=&quot;compiler&quot;,
       attribute=&quot;default_switches&quot;,
       index=&quot;ada&quot;)<span class="nt">&lt;/shell&gt;</span>
    <span class="nt">&lt;external&gt;</span>echo compiler switches= %1<span class="nt">&lt;/external&gt;</span>
  <span class="nt">&lt;/action&gt;</span>
<span class="nt">&lt;/query_switches&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="querying-switches-interactively">
<span id="id37"></span><h4>15.6.4.4. Querying switches interactively<a class="headerlink" href="#querying-switches-interactively" title="Permalink to this headline">¶</a></h4>
<span class="target" id="index-101"></span><p id="index-102">You can also query the arguments for the tool by asking the user
interactively.  The scripting languages provides a number of solutions for
these, which generally have their own native way to read input, possibly by
creating a dialog.  The simplest solution is to often use the predefined
GPS commands:</p>
<ul>
<li><p class="first"><code class="file docutils literal"><span class="pre">yes_no_dialog</span></code></p>
<p>This takes a single argument, a question to display, and presents two
buttons to the user, <span class="guilabel">Yes</span> and <span class="guilabel">No</span>. The result of
this function is the button the user selected, as a boolean value.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">input_dialog</span></code></p>
<p>This function is more general. It takes a minimum of two arguments. The
first argument is a message describing what input is expected from the
user. The second, third, and following arguments each correspond to an
entry line in the dialog, each querying one specific value (as a
string). The result of this function is a list of strings, each
corresponding to these arguments.</p>
<p>From the GPS shell, it is only convenient to query one value at a time,
since it does not have support for lists and would return a concatenation
of the values. However, this function is especially useful in other
scripting languages.</p>
</li>
</ul>
<p>The following is a short example that queries the name of a directory and a
file name and displays each in the <span class="guilabel">Messages</span> view:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;query_file&gt;</span>
  <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&quot;query file and dir&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;shell</span> <span class="na">lang=</span><span class="s">&quot;python&quot;</span><span class="nt">&gt;</span>list=GPS.MDI.input_dialog \\
      (&quot;Please enter directory and file name&quot;, &quot;Directory&quot;, &quot;File&quot;)<span class="nt">&lt;/shell&gt;</span>
    <span class="nt">&lt;shell</span> <span class="na">lang=</span><span class="s">&quot;python&quot;</span><span class="nt">&gt;</span>print (&quot;Dir=&quot; + list[0], &quot;File=&quot; + list[1])<span class="nt">&lt;/shell&gt;</span>
    <span class="nt">&lt;/shell&gt;</span>
  <span class="nt">&lt;/action&gt;</span>
<span class="nt">&lt;/query_file&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="redirecting-the-command-output">
<span id="id38"></span><h4>15.6.4.5. Redirecting the command output<a class="headerlink" href="#redirecting-the-command-output" title="Permalink to this headline">¶</a></h4>
<p id="index-103">By default, GPS sends the output of external commands to the
<span class="guilabel">Messages</span> view.  However, you can exercise finer control using
the <code class="file docutils literal"><span class="pre">output</span></code> attribute of the <code class="file docutils literal"><span class="pre">&lt;external&gt;</span></code> and <code class="file docutils literal"><span class="pre">&lt;shell&gt;</span></code>
tags.  You can also specify this attribute in the <code class="file docutils literal"><span class="pre">&lt;action&gt;</span></code> tag,
where it defines the default value for all <code class="file docutils literal"><span class="pre">&lt;shell&gt;</span></code> and
<code class="file docutils literal"><span class="pre">&lt;external&gt;</span></code> tags.</p>
<p>This attribute is a string.  Specifying an empty string (to override a
specification in the <code class="file docutils literal"><span class="pre">&lt;action&gt;</span></code> tag)` produces the default behavior.
A value of <strong class="command">none</strong> tells GPS to hide the output of the command as
well as the text of the command itself and not show it to the user.  If you
specify any other value, GPS creates a new window with the title given by
the attribute. If such a window already exists, it is cleared before any
command in the chain is executed. The output of the command, as well as the
text of the command itself, are sent to this new window:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;ls&gt;</span>
  <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&quot;ls current directory&quot;</span> <span class="na">output=</span><span class="s">&quot;default output&quot;</span> <span class="nt">&gt;</span>
     <span class="nt">&lt;shell</span> <span class="na">output=</span><span class="s">&quot;Current directory&quot;</span> <span class="nt">&gt;</span>pwd<span class="nt">&lt;/shell&gt;</span>
     <span class="nt">&lt;external</span> <span class="na">output=</span><span class="s">&quot;Current directory contents&quot;</span> <span class="nt">&gt;</span>/bin/ls<span class="nt">&lt;/external&gt;</span>
  <span class="nt">&lt;/action&gt;</span>
<span class="nt">&lt;/ls&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="processing-the-tool-output">
<span id="id39"></span><h4>15.6.4.6. Processing the tool output<a class="headerlink" href="#processing-the-tool-output" title="Permalink to this headline">¶</a></h4>
<p>Once the output of the tool has either been hidden or made visible to the
user in one or more windows, you can do several additional things with this
output, for further integration of the tool in GPS.</p>
<ul>
<li><p class="first">Parsing error messages</p>
<p id="index-104">External tools usually display error messages for the user that are
associated with specific locations in specific files. For example, the
GPS builder itself analyzes the output of <strong class="program">make</strong> using this
information.</p>
<p>You can do this done for your own tools using the shell command
<code class="file docutils literal"><span class="pre">Locations.parse</span></code>, which takes several arguments so that you can
specify your own regular expression to find the file name, line number
and so on in the error message. By default, it is configured to work with
error message of the forms:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span>file:line: message
file:line:column: message
</pre></div>
</div>
<p>Please refer to the online help for this command to get more information (by
typing <cite>help Locations.parse</cite> in the GPS Shell).</p>
<p>Here is a short example showing how to run a make command and send the
errors to the <span class="guilabel">Locations</span> view.</p>
<p>For languages that support it, it is recommended that you quote the
argument with triple quotes (see <a class="reference internal" href="#the-gps-shell"><span class="std std-ref">The GPS Shell</span></a>), so that any
special character such as newlines and quotes in the output of the tool
are not specially interpreted by GPS.  You should also leave a space at
the end, in case the output itself ends with a quote:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;make&gt;</span>
  <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&quot;make example&quot;</span> <span class="nt">&gt;</span>
     <span class="nt">&lt;external&gt;</span>make<span class="nt">&lt;/external&gt;</span>
     <span class="nt">&lt;on-failure&gt;</span>
        <span class="nt">&lt;shell&gt;</span>Locations.parse &quot;&quot;&quot;%1 &quot;&quot;&quot; make_example<span class="nt">&lt;/shell&gt;</span>
     <span class="nt">&lt;/on-failure&gt;</span>
  <span class="nt">&lt;/action&gt;</span>
<span class="nt">&lt;/make&gt;</span>
</pre></div>
</div>
</li>
<li><p class="first">Auto-correcting errors</p>
<p id="index-105">GPS supports automatically correcting errors for some of languages.  You
can get access to this auto-fixing feature through the
<code class="xref py py-func docutils literal"><span class="pre">Codefix.parse()</span></code> shell command, which takes the same arguments as
<code class="xref py py-func docutils literal"><span class="pre">Locations.parse()</span></code>.  This automatically adds pixmaps to the relevant
entries in the <span class="guilabel">Locations</span> view, so you should call
<code class="xref py py-func docutils literal"><span class="pre">Locations.parse()</span></code> before calling this command.</p>
<p>Errors can also be fixed automatically by calling the methods of the
<code class="xref py py-class docutils literal"><span class="pre">Codefix</span></code> class. Several codefix sessions can be active at the same
time, each of which is associated with a specific category. The list of
currently active sessions can be retrieved through the
<code class="xref py py-func docutils literal"><span class="pre">Codefix.sessions()</span></code> command.</p>
<span class="target" id="index-106"></span><span class="target" id="index-107"></span><p id="index-108">If support for Python is enabled, you can also manipulate those errors
that can be fixed for a given session.  To do so, first get a handle for
that section, as shown in the example below.  Then get the list of
fixable errors through the <code class="xref py py-func docutils literal"><span class="pre">errors()</span></code> command.</p>
<p>Each error is of the class <code class="xref py py-class docutils literal"><span class="pre">CodefixError</span></code>, which has one important
method, <code class="xref py py-func docutils literal"><span class="pre">fix()</span></code>, allowing you to perform an automatic correction of
that error. The list of possible fixes is retrieved through
<code class="xref py py-func docutils literal"><span class="pre">possible_fixes()</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">print</span> <span class="n">GPS</span><span class="o">.</span><span class="n">Codefix</span><span class="o">.</span><span class="n">sessions</span> <span class="p">()</span>
<span class="n">session</span> <span class="o">=</span> <span class="n">GPS</span><span class="o">.</span><span class="n">Codefix</span> <span class="p">(</span><span class="s2">&quot;category&quot;</span><span class="p">)</span>
<span class="n">errors</span>  <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">errors</span> <span class="p">()</span>
<span class="k">print</span> <span class="n">errors</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">possible_fixes</span> <span class="p">()</span>
<span class="n">errors</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fix</span> <span class="p">()</span>
</pre></div>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="section" id="customization-examples">
<span id="id40"></span><h2>15.7. Customization examples<a class="headerlink" href="#customization-examples" title="Permalink to this headline">¶</a></h2>
<div class="section" id="menu-example">
<span id="id41"></span><h3>15.7.1. Menu example<a class="headerlink" href="#menu-example" title="Permalink to this headline">¶</a></h3>
<p>This section provides a full example of a customization file.  It creates a
top-level menu named <span class="guilabel">custom menu</span>, that contains a menu item
named <span class="guilabel">item 1</span>, associated with the external command
<code class="file docutils literal"><span class="pre">external-command</span> <span class="pre">1</span></code> and a sub menu named <span class="guilabel">other menu</span>:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="nt">&lt;menu-example&gt;</span>
  <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&quot;action1&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;external&gt;</span>external-command 1<span class="nt">&lt;/external&gt;</span>
  <span class="nt">&lt;/action&gt;</span>

  <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&quot;action2&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;shell&gt;</span>edit %f<span class="nt">&lt;/shell&gt;</span>
  <span class="nt">&lt;/action&gt;</span>

  <span class="nt">&lt;submenu&gt;</span>
    <span class="nt">&lt;title&gt;</span>custom menu<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;menu</span> <span class="na">action=</span><span class="s">&quot;action1&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;title&gt;</span>item 1<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;/menu&gt;</span>

    <span class="nt">&lt;submenu&gt;</span>
      <span class="nt">&lt;title&gt;</span>other menu<span class="nt">&lt;/title&gt;</span>
      <span class="nt">&lt;menu</span> <span class="na">action=</span><span class="s">&quot;action2&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;title&gt;</span>item 2<span class="nt">&lt;/title&gt;</span>
      <span class="nt">&lt;/menu&gt;</span>
    <span class="nt">&lt;/submenu&gt;</span>
  <span class="nt">&lt;/submenu&gt;</span>
<span class="nt">&lt;/menu-example&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="tool-example">
<span id="id42"></span><h3>15.7.2. Tool example<a class="headerlink" href="#tool-example" title="Permalink to this headline">¶</a></h3>
<p>This section provides an example of how you can define a new tool. This is
only a short example, since Ada, C, and C++ support themselves are provided
through such a file, available in the GPS installation.</p>
<p>This example adds support for the <strong class="program">find</strong> Unix utility, with a few
switches. All the switches are editable through the project properties
editor.  It also adds a new action and menu. The action associated with
this menu gets the default switches from the currently selected project,
and asks the user interactively for the name of the file to search:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;toolexample&gt;</span>
  <span class="nt">&lt;tool</span> <span class="na">name=</span><span class="s">&quot;Find&quot;</span> <span class="nt">&gt;</span>
    <span class="nt">&lt;switches</span> <span class="na">columns=</span><span class="s">&quot;2&quot;</span> <span class="nt">&gt;</span>
      <span class="nt">&lt;title</span> <span class="na">column=</span><span class="s">&quot;1&quot;</span> <span class="nt">&gt;</span>Filters<span class="nt">&lt;/title&gt;</span>
      <span class="nt">&lt;title</span> <span class="na">column=</span><span class="s">&quot;2&quot;</span> <span class="nt">&gt;</span>Actions<span class="nt">&lt;/title&gt;</span>

      <span class="nt">&lt;spin</span> <span class="na">label=</span><span class="s">&quot;Modified less than n days ago&quot;</span> <span class="na">switch=</span><span class="s">&quot;-mtime-&quot;</span>
            <span class="na">min=</span><span class="s">&quot;0&quot;</span> <span class="na">max=</span><span class="s">&quot;365&quot;</span> <span class="na">default=</span><span class="s">&quot;0&quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;check</span> <span class="na">label=</span><span class="s">&quot;Follow symbolic links&quot;</span> <span class="na">switch=</span><span class="s">&quot;-follow&quot;</span> <span class="nt">/&gt;</span>

      <span class="nt">&lt;check</span> <span class="na">label=</span><span class="s">&quot;Print matching files&quot;</span> <span class="na">switch=</span><span class="s">&quot;-print&quot;</span> <span class="na">column=</span><span class="s">&quot;2&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/switches&gt;</span>
  <span class="nt">&lt;/tool&gt;</span>

  <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&quot;action find&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;shell&gt;</span>Project %p<span class="nt">&lt;/shell&gt;</span>
    <span class="nt">&lt;shell&gt;</span>Project.get_tool_switches_as_string %1 Find <span class="nt">&lt;/shell&gt;</span>
    <span class="nt">&lt;shell&gt;</span>MDI.input_dialog &quot;Name of file to search&quot; Filename<span class="nt">&lt;/shell&gt;</span>
    <span class="nt">&lt;external&gt;</span>find . -name %1 %2<span class="nt">&lt;/external&gt;</span>
  <span class="nt">&lt;/action&gt;</span>

  <span class="nt">&lt;Submenu&gt;</span>
    <span class="nt">&lt;Title&gt;</span>External<span class="nt">&lt;/Title&gt;</span>
     <span class="nt">&lt;menu</span> <span class="na">action=</span><span class="s">&quot;action find&quot;</span><span class="nt">&gt;</span>
       <span class="nt">&lt;Title&gt;</span>Launch find<span class="nt">&lt;/Title&gt;</span>
    <span class="nt">&lt;/menu&gt;</span>
  <span class="nt">&lt;/Submenu&gt;</span>
<span class="nt">&lt;/toolexample&gt;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="scripting-gps">
<span id="id43"></span><h2>15.8. Scripting GPS<a class="headerlink" href="#scripting-gps" title="Permalink to this headline">¶</a></h2>
<div class="section" id="scripts">
<span id="index-109"></span><span id="id44"></span><h3>15.8.1. Scripts<a class="headerlink" href="#scripts" title="Permalink to this headline">¶</a></h3>
<p>Scripts are small programs that interact with GPS and allow you to perform
complex tasks repetitively and easily. GPS currently includes support for
two scripting languages, although additional languages may be added in the
future. These two languages are described in the following section.</p>
<p>Support for scripting is currently a &#8220;work in progress&#8221; in GPS. As a
result, not many commands are currently exported by GPS, although their
number is increasing daily. These commands are similar to what is available
to those who extend GPS directly in Ada, but with major advantages: they
do not require recompilation of the GPS core and can be tested and executed
interactively.  The goal of such scripts is to help automate processes such
as builds and generation of graphs.</p>
<p>These languages all have a separate console associated with them, which you
can open from the <span class="guilabel">Tools</span> menu. In each of these console, GPS
displays a prompt, at which you can type interactive commands. These
consoles provide completion of the command names through the <code class="kbd docutils literal"><span class="pre">tab</span></code>
key.</p>
<p>For example, in the GPS shell console you can start typing:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span>GPS&gt; File
</pre></div>
</div>
<p>then press the <code class="kbd docutils literal"><span class="pre">tab</span></code> key, which lists all functions whose name starts
with <code class="file docutils literal"><span class="pre">File</span></code>.</p>
<p>A similar feature is available in the Python console, also providing
completion for all the standard Python commands and modules.</p>
<p>All the scripting languages share the same set of commands exported by GPS,
because of an abstract interface defined in the GPS core. As a result, GPS
modules do not have to be modified when new scripting languages are added.</p>
<p id="index-110">You can execute scripts immediately upon startup of GPS by using the
command line switch <strong class="command">--load</strong>. Specifying the following command
line:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span>gps --load=shell:mytest.gps
</pre></div>
</div>
<p>forces the GPS script <code class="file docutils literal"><span class="pre">mytest.gps</span></code> to be executed immediately, before
GPS starts responding to user&#8217;s requests. Do this if you want to preform
some initializations of the environment. It can also be used as a command
line interface to GPS, if your script&#8217;s last command is to exit GPS.</p>
<p>The name of the language is optional, and defaults to python:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span>gps --load=script.py
</pre></div>
</div>
<p id="index-111">You can also specify in-line commands directly on the command line through
<strong class="command">--eval</strong> command line switch.</p>
<p>For example, if you want to analyze an entity in the entity browser from
the command line, you would pass the following command switches:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span>gps --eval=shell:&#39;Entity entity_name file_name; Entity.show %1&#39;
</pre></div>
</div>
<p>The language defaults to python, as for <strong class="command">--load</strong>.</p>
<p>See the section <a class="reference internal" href="#customizing-through-xml-and-python-files"><span class="std std-ref">Customizing through XML and Python files</span></a> on how to
bind key shortcuts to shell commands.</p>
</div>
<div class="section" id="scripts-and-gps-actions">
<span id="id45"></span><h3>15.8.2. Scripts and GPS actions<a class="headerlink" href="#scripts-and-gps-actions" title="Permalink to this headline">¶</a></h3>
<p id="index-112">There is a strong relationship between GPS actions, as defined in the
customization files (<a class="reference internal" href="#defining-actions"><span class="std std-ref">Defining Actions</span></a>), and scripting languages.
You can bind actions to menus and keys through the customization files or
the <span class="menuselection">Edit ‣ Preferences...</span> dialog.  These actions can
execute any script command (see <a class="reference internal" href="#defining-actions"><span class="std std-ref">Defining Actions</span></a>) using the
<cite>&lt;shell&gt;</cite> XML tag.</p>
<p>But the opposite is also true. From a script, you can execute any action
registered in GPS.  For example, you can split windows or highlight lines
in the editor when no equivalent shell function exists. You can use this to
execute external commands if the scripting language does not support this
easily.  Such calls are made through a call to <code class="file docutils literal"><span class="pre">execute_action</span></code>, as
in the following example:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span>execute_action &quot;Split horizontally&quot;

GPS.execute_action (action=&quot;Split horizontally&quot;)
</pre></div>
</div>
<p>The list of actions known to GPS can be found through the
<span class="menuselection">Edit ‣ preferences...</span> dialog. Action names are case
sensitive.</p>
<p>Some shell commands take subprograms as parameters. If you are using the GPS
shell, you to pass the name of a GPS action. If you are using Python, you
pass a subprogram.  See <a class="reference internal" href="#subprogram-parameters"><span class="std std-ref">Subprogram parameters</span></a>.</p>
</div>
<div class="section" id="the-gps-shell">
<span id="id46"></span><h3>15.8.3. The GPS Shell<a class="headerlink" href="#the-gps-shell" title="Permalink to this headline">¶</a></h3>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The GPS Shell is deprecated, and only accessible through XML commands now, for
backward compatibility. Don&#8217;t try to use it for any new development, and use
the Python Shell instead.</p>
</div>
<p id="index-113">The GPS shell is a very simple-minded, line-oriented language. It is
not interactively accessible in GPS anymore.</p>
</div>
<div class="section" id="the-python-interpreter">
<span id="id47"></span><h3>15.8.4. The Python Interpreter<a class="headerlink" href="#the-python-interpreter" title="Permalink to this headline">¶</a></h3>
<p id="index-114">Python is an interpreted object-oriented language, created by Guido Van
Rossum.  It is similar in its capabilities to languages such as Perl, Tcl
or Lisp. This section is not a tutorial on python programming. See
<a class="reference external" href="http://docs.python.org/">http://docs.python.org/</a> for documentation on
the current version of python.</p>
<p>If Python support has been enabled, the Python shell is accessible through
the <span class="guilabel">Python</span> window at the bottom of the GPS window. You can also
display it by using the <span class="menuselection">View ‣ Python</span> menu.
The full documentation on what GPS makes visible through Python is available
from the <span class="menuselection">Help ‣ GPS ‣ Python extensions</span> menu.</p>
<p>The same example as shown for the GPS shell follows, now using Python.  As
you notice, the name of the commands is similar, although they are not run
exactly in the same way. Specifically, GPS uses the object-oriented aspects
of Python to create classes and instances of these classes.</p>
<p>In the first line, a new instance of the class Entity is created through
the <code class="xref py py-func docutils literal"><span class="pre">create_entity()</span></code> function. Various methods can then be applied to
that instance, including <code class="xref py py-func docutils literal"><span class="pre">find_all_refs()</span></code>, which lists all references
to that entity in the <span class="guilabel">Locations</span> view:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">=</span><span class="n">GPS</span><span class="o">.</span><span class="n">Entity</span> <span class="p">(</span><span class="s2">&quot;entity_name&quot;</span><span class="p">,</span> <span class="n">GPS</span><span class="o">.</span><span class="n">File</span> <span class="p">(</span><span class="s2">&quot;file_name.adb&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">.</span><span class="n">find_all_refs</span><span class="p">()</span>
</pre></div>
</div>
<p>The screen representation of the classes exported by GPS to Python has been
modified, so most GPS functions return an instance of a class but still
display their output in a user-readable manner.</p>
<p>Python has extensive introspection capabilities. Continuing the
previous example, you can find what class <code class="xref py py-class docutils literal"><span class="pre">e</span></code> is an instance of
with the following command:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">help</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="go">Help on instance of Entity:</span>

<span class="go">&lt;GPS.Entity instance&gt;</span>
</pre></div>
</div>
<p>You can also to find all attributes and methods that can be applied to
<code class="xref py py-class docutils literal"><span class="pre">e</span></code>, as in the following example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">dir</span> <span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="go">[&#39;__doc__&#39;, &#39;__gps_data__&#39;, &#39;__module__&#39;, &#39;called_by&#39;, &#39;calls&#39;,</span>
<span class="go">&#39;find_all_refs&#39;]</span>
</pre></div>
</div>
<p>The list of methods may vary depending on what modules were loaded in GPS,
since each module can add its own methods to any class.  In addition, the
list of all existing modules and objects currently known in the interpreter
can be found with the following command:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">dir</span> <span class="p">()</span>
<span class="go">[&#39;GPS&#39;, &#39;GPSStdout&#39;, &#39;__builtins__&#39;, &#39;__doc__&#39;, &#39;__name__&#39;, &#39;e&#39;, &#39;sys&#39;]</span>
</pre></div>
</div>
<p>You can also load and execute python scripts with the <code class="xref py py-func docutils literal"><span class="pre">execfile()</span></code>
command, as in the following example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">execfile</span> <span class="p">(</span><span class="s2">&quot;test.py&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Python supports named parameters. Most functions exported by GPS define
names for their parameters, so you can use this Python feature to make your
scripts more readable. (A notable exception are functions that allow a
variable number of parameters.)  Using named parameters, you can specify
the parameters in any order you wish, e.g:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">=</span><span class="n">GPS</span><span class="o">.</span><span class="n">Entity</span> <span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="nb">file</span><span class="o">=</span><span class="n">GPS</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="s2">&quot;file.adb&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="python-modules">
<h3>15.8.5. Python modules<a class="headerlink" href="#python-modules" title="Permalink to this headline">¶</a></h3>
<p>GPS automatically imports (with Python&#8217;s <strong class="command">import</strong> command) all
files with the extension <code class="file docutils literal"><span class="pre">.py</span></code> found in the directory
<code class="file docutils literal"><span class="pre">$HOME/.gps/plug-ins</span></code>, the directory
<code class="file docutils literal"><span class="pre">$prefix/share/gps/plugins</span></code> or in the directories pointed to by
<code class="file docutils literal"><span class="pre">GPS_CUSTOM_PATH</span></code> on startup. These files are loaded only after all
standard GPS modules have been loaded, as well as the custom files, and
before the script file or batch commands specified on the command lines
with the <strong class="command">--eval</strong> or <strong class="command">--load</strong> switches.</p>
<p>As a result, you can use the usual GPS functions exported to Python in
these startup scripts. Likewise, the script run from the command line can
use functions defined in the startup files.</p>
<p>Because GPS uses the <code class="xref py py-func docutils literal"><span class="pre">import()</span></code> command, functions defined in this
modules are only accessible by prefixing their name by the name of the file
in which they are defined. For example, if a file <code class="file docutils literal"><span class="pre">mystartup.py</span></code> is
copied to the startup directory and defines the function <code class="xref py py-func docutils literal"><span class="pre">func()</span></code>, the
latter is accessible in GPS as <code class="xref py py-func docutils literal"><span class="pre">mystartup.func()</span></code>.</p>
<p>Python&#8217;s own mechanism for loading files at startup (using environment
variable <code class="file docutils literal"><span class="pre">PYTHONSTARTUP</span></code>) is not suitable for use within the context
of GPS. When Python is loaded by GPS, the GPS module itself is not yet
available and thus any script that depends on that module will fail to load
correctly. Instead, copy your script to one of the plugin directories, as
documented above.</p>
<p>If you are writing a set of Python scripts for other people to use, you need
to provide the Python files themselves. This is a set of <code class="file docutils literal"><span class="pre">.py</span></code> files,
which the user should install in the <code class="file docutils literal"><span class="pre">plugins</span></code> directory.</p>
<p>To make the Python functions accessible through GPS, you can:</p>
<ul class="simple">
<li>Export the APIs directly through Python, under the form of Actions (the
<code class="xref py py-class docutils literal"><span class="pre">Action</span></code> class), Menus (the <code class="xref py py-class docutils literal"><span class="pre">Contextual</span></code> and <code class="xref py py-class docutils literal"><span class="pre">Menu</span></code>
classes) or toolbar buttons (the <code class="xref py py-class docutils literal"><span class="pre">ToolButton</span></code> and <code class="xref py py-class docutils literal"><span class="pre">Toolbar</span></code>
classes).</li>
<li>Write an XML that creates a set of actions using the
<code class="file docutils literal"><span class="pre">&lt;action&gt;</span></code> tag (see <a class="reference internal" href="#defining-actions"><span class="std std-ref">Defining Actions</span></a> and which is
exported to the user. This allows him to either create menus to
execute these commands or to bind them to special key shortcuts. The
menus can be created directly in Python, with the <a class="reference internal" href="GPS.html#GPS.Menu" title="GPS.Menu"><code class="xref py py-class docutils literal"><span class="pre">GPS.Menu</span></code></a>
class. The same XML can be directly embedded in the Python file
itself and executed through <code class="file docutils literal"><span class="pre">GPS.parse_xml</span></code>.</li>
</ul>
<p>The following example defines a Python command that inserts a line full of
dashes (&#8216;-&#8216;) at the current cursor location. This command is associated with
the key binding <code class="kbd docutils literal"><span class="pre">Ctrl-c</span> <span class="pre">n</span></code> and can be distributed as a single Python
file:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># This code can be stored in a file test.py in $HOME/.gps/plug-ins</span>
<span class="kn">from</span> <span class="nn">GPS</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">def</span> <span class="nf">add_dashes_line</span><span class="p">():</span>
   <span class="n">Editor</span><span class="o">.</span><span class="n">replace_text</span> <span class="p">(</span><span class="n">current_context</span><span class="p">()</span><span class="o">.</span><span class="n">file</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="p">(),</span>
                        <span class="n">current_context</span><span class="p">()</span><span class="o">.</span><span class="n">location</span><span class="p">()</span><span class="o">.</span><span class="n">line</span><span class="p">(),</span>
                        <span class="n">current_context</span><span class="p">()</span><span class="o">.</span><span class="n">location</span><span class="p">()</span><span class="o">.</span><span class="n">column</span><span class="p">(),</span>
                        <span class="s2">&quot;--------------------------------&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">GPS</span><span class="o">.</span><span class="n">parse_xml</span> <span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">   &lt;action name=&quot;dashes line&quot;&gt;</span>
<span class="s2">      &lt;shell lang=&quot;python&quot;&gt;test.add_dashes_line()&lt;/shell&gt;</span>
<span class="s2">      &lt;context&gt;Source editor&lt;/context&gt;</span>
<span class="s2">   &lt;/action&gt;</span>
<span class="s2">   &lt;key action=&quot;dashes line&quot;&gt;control-c n&lt;/key&gt;</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Several complex examples are provided in the GPS distribution, in the
directory <code class="file docutils literal"><span class="pre">examples/python</span></code>. These are modules you might want to use,
but more importantly that show how GPS can be extended from Python.</p>
<p>If your script does not do what you expect it to do, there are several ways
to debug it.  The easiest is probably to add some <strong class="command">print</strong>
statements.  Since some output of the scripts is sometimes hidden by GPS
(for example, for interactive commands), you might not see this output.  In
that case, you can reuse the tracing facility embedded in GPS itself.
Modify the file <code class="file docutils literal"><span class="pre">$HOME/.gps/traces.cfg</span></code>, and add the following line:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">PYTHON</span><span class="o">.</span><span class="n">OUT</span><span class="o">=</span><span class="n">yes</span>
</pre></div>
</div>
<p>This include the Python traces as part of the general traces available in
the file <code class="file docutils literal"><span class="pre">$HOME/.gps/log</span></code>. Note that this may slow down GPS if there is
a lot of output to process.</p>
</div>
<div class="section" id="subprogram-parameters">
<span id="id48"></span><h3>15.8.6. Subprogram parameters<a class="headerlink" href="#subprogram-parameters" title="Permalink to this headline">¶</a></h3>
<p id="index-115">Some functions exported by GPS in the GPS shell or in Python expect a
subprogram as a parameter.</p>
<p>This is handled in different ways depending on what language you are using:</p>
<ul>
<li><p class="first">GPS shell</p>
<p>You cannot define new functions in the GPS shell. However, this concept is
similar to the GPS actions (see <a class="reference internal" href="#defining-actions"><span class="std std-ref">Defining Actions</span></a>), which allow you
to execute a set of commands and launch external processes.  A subprogram
parameter in the GPS shell is a string, the name of the action to
execute.</p>
<p>For examle, the following code defines the action <code class="file docutils literal"><span class="pre">on_editing</span></code>,
which is called each time a new file is edited. The action is defined in
the shell itself, although this could be more conveniently done in a
separate customization file:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">parse_xml</span> <span class="s2">&quot;&quot;&quot;&lt;action name=&quot;on_editing&quot;&gt;</span>
<span class="s2">             &lt;shell&gt;echo &quot;File edited&quot;&lt;/shell&gt;&lt;/action&gt;&quot;&quot;&quot;</span>
<span class="n">Hook</span> <span class="s2">&quot;file_edited&quot;</span>
<span class="n">Hook</span><span class="o">.</span><span class="n">add</span> <span class="o">%</span><span class="mi">1</span> <span class="s2">&quot;on_editing&quot;</span>
</pre></div>
</div>
</li>
<li><p class="first">Python</p>
<p>Python, of course, has its own notion of subprogram, and GPS is fully
compatible with it. As a result, the syntax is much more natural than in
the GPS shell.  The following example has the same result as above:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">GPS</span>
<span class="k">def</span> <span class="nf">on_editing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">arg</span><span class="p">):</span>
    <span class="k">print</span> <span class="s2">&quot;File edited&quot;</span>
<span class="n">GPS</span><span class="o">.</span><span class="n">Hook</span><span class="p">(</span><span class="s2">&quot;file_edited&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">on_editing</span><span class="p">)</span>
</pre></div>
</div>
<p>The situation is slightly more complex if you want to pass methods as
arguments. Python has three notions of callable subprograms, detailed
below. The following examples all create a combo box in the toolbar that
calls a subprogram whenever its value is changed. The documentation for
the combo box indicates that the callback in this case takes two
parameters:</p>
<ul class="simple">
<li>The instance of the combo</li>
<li>The current selection in the combo box</li>
</ul>
<p>The first parameter is the instance of the combo box associated with the
toolbar widget and, as always in Python, you can store your own data in
the instance, as shown in the examples below.</p>
<p>here is the description of the various subprograms:</p>
<ul>
<li><p class="first">Global subprograms</p>
<p>These are standard subprograms, found outside class
definitions. there is no implicit parameter in this case. However, if
you need to pass data to such a subprogram, you need to use global
variables:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">GPS</span>

<span class="n">my_var</span> <span class="o">=</span> <span class="s2">&quot;global data&quot;</span>

<span class="k">def</span> <span class="nf">on_changed</span><span class="p">(</span><span class="n">combo</span><span class="p">,</span> <span class="n">choice</span><span class="p">):</span>
   <span class="k">global</span> <span class="n">my_var</span>
   <span class="k">print</span> <span class="p">(</span><span class="s2">&quot;on_changed called: &quot;</span> <span class="o">+</span>
       <span class="n">my_var</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">combo</span><span class="o">.</span><span class="n">data</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">choice</span><span class="p">)</span>

<span class="n">combo</span> <span class="o">=</span> <span class="n">GPS</span><span class="o">.</span><span class="n">Combo</span><span class="p">(</span>
   <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="n">on_changed</span><span class="o">=</span><span class="n">on_changed</span><span class="p">)</span>
<span class="n">GPS</span><span class="o">.</span><span class="n">Toolbar</span><span class="p">()</span><span class="o">.</span><span class="n">append</span> <span class="p">(</span><span class="n">combo</span><span class="p">)</span>
<span class="n">combo</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="s2">&quot;My own data&quot;</span>
</pre></div>
</div>
</li>
<li><p class="first">Unbound methods</p>
<p>These are methods of a class. You do not specify, when you pass the
method in parameter to the combo box, what instance should be passed as
its first parameter. Therefore, there is also no extra parameter.</p>
<p>However, whatever class the method is defined in, the first parameter
is always an instance of the class documented in the GPS documentation
(in this case a <code class="xref py py-class docutils literal"><span class="pre">GPS.Combo</span></code> instance), not an instance of the
current class.</p>
<p>In this first example, since we do not have access to the instance of
<code class="xref py py-class docutils literal"><span class="pre">MyClass</span></code>, we also need to store the global data as a class
component. This is a problem if multiple instances of the class can be
created:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">GPS</span>
<span class="k">class</span> <span class="nc">MyClass</span><span class="p">:</span>
   <span class="n">my_var</span> <span class="o">=</span> <span class="s2">&quot;global data&quot;</span>
   <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">combo</span> <span class="o">=</span> <span class="n">GPS</span><span class="o">.</span><span class="n">Combo</span><span class="p">(</span>
         <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="n">on_changed</span><span class="o">=</span><span class="n">MyClass</span><span class="o">.</span><span class="n">on_changed</span><span class="p">)</span>
      <span class="n">GPS</span><span class="o">.</span><span class="n">Toolbar</span><span class="p">()</span><span class="o">.</span><span class="n">append</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="s2">&quot;My own data&quot;</span>

   <span class="k">def</span> <span class="nf">on_changed</span><span class="p">(</span><span class="n">combo</span><span class="p">,</span> <span class="n">choice</span><span class="p">):</span>
      <span class="c1">## No direct access to the instance of MyClass.</span>
      <span class="k">print</span> <span class="p">(</span><span class="s2">&quot;on_changed called: &quot;</span> <span class="o">+</span>
         <span class="n">MyClass</span><span class="o">.</span><span class="n">my_var</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">combo</span><span class="o">.</span><span class="n">data</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">choice</span><span class="p">)</span>

<span class="n">MyClass</span><span class="p">()</span>
</pre></div>
</div>
<p>As the example above illustrates, there is no direct access to
<code class="xref py py-class docutils literal"><span class="pre">MyClass</span></code> when executing <code class="xref py py-func docutils literal"><span class="pre">on_changed()</span></code>. An easy workaround
is the following, in which the global data is stored in the instance of
<code class="xref py py-class docutils literal"><span class="pre">MyClass</span></code> and therefore be different for each instance of
<code class="xref py py-class docutils literal"><span class="pre">MyClass</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">GPS</span>
<span class="k">class</span> <span class="nc">MyClass</span><span class="p">:</span>
   <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">combo</span> <span class="o">=</span> <span class="n">GPS</span><span class="o">.</span><span class="n">Combo</span><span class="p">(</span>
          <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="n">on_changed</span><span class="o">=</span><span class="n">MyClass</span><span class="o">.</span><span class="n">on_changed</span><span class="p">)</span>
      <span class="n">GPS</span><span class="o">.</span><span class="n">Toolbar</span><span class="p">()</span><span class="o">.</span><span class="n">append</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="s2">&quot;My own data&quot;</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">.</span><span class="n">myclass</span> <span class="o">=</span> <span class="bp">self</span>   <span class="c1">## Save the instance</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">my_var</span> <span class="o">=</span> <span class="s2">&quot;global data&quot;</span>

   <span class="k">def</span> <span class="nf">on_changed</span><span class="p">(</span><span class="n">combo</span><span class="p">,</span> <span class="n">choice</span><span class="p">):</span>
      <span class="k">print</span> <span class="p">(</span><span class="s2">&quot;on_changed called: &quot;</span> <span class="o">+</span>
         <span class="n">combo</span><span class="o">.</span><span class="n">myclass</span><span class="o">.</span><span class="n">my_var</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">combo</span><span class="o">.</span><span class="n">data</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">choice</span><span class="p">)</span>

<span class="n">MyClass</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p class="first">Bound methods</p>
<p>The last example works as expected, but is not convenient to use. You can
make it more convenient by using a bound method, which is a method for
a specific instance of a class. Such a method always has an extra first
parameter, set implicitly by Python or GPS, which is the instance of
the class the method is defined in.</p>
<p>Note the way we pass the method in parameter to <code class="xref py py-func docutils literal"><span class="pre">append()</span></code>, and the
extra third argument to <code class="xref py py-func docutils literal"><span class="pre">on_changed()</span></code> in the example below:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">GPS</span>
<span class="k">class</span> <span class="nc">MyClass</span><span class="p">:</span>
   <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">combo</span> <span class="o">=</span> <span class="n">GPS</span><span class="o">.</span><span class="n">Combo</span><span class="p">(</span>
         <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="n">on_changed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">on_changed</span><span class="p">)</span>
      <span class="n">GPS</span><span class="o">.</span><span class="n">Toolbar</span><span class="p">()</span><span class="o">.</span><span class="n">append</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="s2">&quot;My own data&quot;</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">my_var</span> <span class="o">=</span> <span class="s2">&quot;global data&quot;</span>

   <span class="k">def</span> <span class="nf">on_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">combo</span><span class="p">,</span> <span class="n">choice</span><span class="p">):</span>
      <span class="c1"># self is the instance of MyClass specified in call to append()</span>
      <span class="k">print</span> <span class="p">(</span><span class="s2">&quot;on_changed called: &quot;</span> <span class="o">+</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">my_var</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">combo</span><span class="o">.</span><span class="n">data</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">choice</span><span class="p">)</span>

<span class="n">MyClass</span><span class="p">()</span>
</pre></div>
</div>
<p>You may find it convenient to use the object-oriented approach when
writing Python scripts. If, for example, you want to spawn an external
process, GPS provides the <a class="reference internal" href="GPS.html#GPS.Process" title="GPS.Process"><code class="xref py py-class docutils literal"><span class="pre">GPS.Process</span></code></a> class. When you create an
instance, you specify a callback to be called when some input is made
available by the process.  Matching the above example, the code looks
something like:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyClass</span><span class="p">:</span>
  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
     <span class="bp">self</span><span class="o">.</span><span class="n">process</span> <span class="o">=</span> <span class="n">GPS</span><span class="o">.</span><span class="n">Process</span><span class="p">(</span>
        <span class="s2">&quot;command_line&quot;</span><span class="p">,</span> <span class="n">on_match</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">on_match</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">on_match</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">process</span><span class="p">,</span> <span class="n">matched</span><span class="p">,</span> <span class="n">unmatched</span><span class="p">):</span>
     <span class="k">print</span> <span class="p">(</span><span class="s2">&quot;Process output: &quot;</span> <span class="o">+</span> <span class="n">unmatched</span> <span class="o">+</span> <span class="n">matched</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>A more natural approach, rather than having a class with a
<code class="xref py py-func docutils literal"><span class="pre">process()</span></code> field, is to directly extend the <a class="reference internal" href="GPS.html#GPS.Process" title="GPS.Process"><code class="xref py py-class docutils literal"><span class="pre">GPS.Process</span></code></a>
class, as in:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyClass</span><span class="p">(</span><span class="n">GPS</span><span class="o">.</span><span class="n">Process</span><span class="p">):</span>
  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
     <span class="n">GPS</span><span class="o">.</span><span class="n">Process</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;command_line&quot;</span><span class="p">,</span> <span class="n">on_match</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">on_match</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">on_match</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">matched</span><span class="p">,</span> <span class="n">unmatched</span><span class="p">):</span>
     <span class="k">print</span> <span class="p">(</span><span class="s2">&quot;Process output: &quot;</span> <span class="o">+</span> <span class="n">unmatched</span> <span class="o">+</span> <span class="n">matched</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Any command that can be used on a process (such as <code class="xref py py-func docutils literal"><span class="pre">send()</span></code>) can
then directly be used on instances of <code class="xref py py-class docutils literal"><span class="pre">MyClass</span></code>.</p>
<p>There is one non-obvious improvement possible in the code above: the
<code class="xref py py-func docutils literal"><span class="pre">on_match()</span></code> callback has one less parameter. What happens is the
following: as per the documentation of <a class="reference internal" href="GPS.html#GPS.Process.__init__" title="GPS.Process.__init__"><code class="xref py py-func docutils literal"><span class="pre">GPS.Process.__init__()</span></code></a>,
GPS gives three arguments to its <code class="xref py py-func docutils literal"><span class="pre">on_match()</span></code> callback: the
instance of the process (<code class="xref py py-func docutils literal"><span class="pre">process()</span></code> in the first example above),
the string that matched the regular expression, and the string before
that match.</p>
<p>In the first example above, we are passing <code class="xref py py-func docutils literal"><span class="pre">self.on_match()</span></code>, a
bound method, as a callback. That tells Python it should automatically
and transparently add an extra first parameter, <code class="xref py py-func docutils literal"><span class="pre">self()</span></code>, when
calling <code class="xref py py-func docutils literal"><span class="pre">MyClass.on_match()</span></code>. This is why the first example has
four parameters for <code class="xref py py-func docutils literal"><span class="pre">on_match()</span></code>.</p>
<p>However, the second example only has three parameters, because GPS
detected that <code class="xref py py-func docutils literal"><span class="pre">self()</span></code> (the instance of <code class="xref py py-class docutils literal"><span class="pre">MyClass</span></code>) and the
instance of <a class="reference internal" href="GPS.html#GPS.Process" title="GPS.Process"><code class="xref py py-func docutils literal"><span class="pre">GPS.Process()</span></code></a> are the same in this case. So it need
not ada an extra parameter (<code class="xref py py-func docutils literal"><span class="pre">self()</span></code> and <code class="xref py py-func docutils literal"><span class="pre">process()</span></code> would have
been the same).</p>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="python-faq">
<span id="id49"></span><h3>15.8.7. Python FAQ<a class="headerlink" href="#python-faq" title="Permalink to this headline">¶</a></h3>
<p id="index-116">This section lists some problems that have been encountered while using
Python inside GPS. This is not a general Python discussion.</p>
<div class="section" id="hello-world-in-python">
<span id="id50"></span><h4>15.8.7.1. Hello World! in python<a class="headerlink" href="#hello-world-in-python" title="Permalink to this headline">¶</a></h4>
<p>Writing a Python script to interact with GPS is very simple. Here we show how
to create a new menu in GPS that when clicked, displays a dialog saying the
famous &#8216;Hello World!&#8217;.</p>
<p>Here is the code that you need to put in <code class="file docutils literal"><span class="pre">hello_world.py</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">GPS</span>
<span class="kn">import</span> <span class="nn">gps_utils</span>

<span class="nd">@gps_utils.interactive</span><span class="p">(</span><span class="n">menu</span><span class="o">=</span><span class="s1">&#39;/Help/Hello World!&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">hello_world</span><span class="p">():</span>
   <span class="n">GPS</span><span class="o">.</span><span class="n">MDI</span><span class="o">.</span><span class="n">dialog</span><span class="p">(</span><span class="s2">&quot;Hello World!&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>To use this plugin, launch GPS with the following command line:</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span>$ gps --load<span class="o">=</span>python:hello_world.py
</pre></div>
</div>
<p>If want the plugin to be loaded every time you launch GPS without having
to specify it on the command line, copy <code class="file docutils literal"><span class="pre">hello_world.py</span></code> to your
<code class="file docutils literal"><span class="pre">$HOME/.gps/plug-ins/</span></code> directory (<code class="file docutils literal"><span class="pre">%USERPROFILE%\.gps\</span></code> on
Windows). Alternatively, you can add the directory containing your plugin
to your <code class="file docutils literal"><span class="pre">GPS_CUSTOM_PATH</span></code> environment variable.  For a description of
the various environment variables used by GPS, see
<a class="reference internal" href="environment.html#environment-variables"><span class="std std-ref">Environment Variables</span></a>.</p>
</div>
<div class="section" id="spawning-external-processes">
<span id="id51"></span><h4>15.8.7.2. Spawning external processes<a class="headerlink" href="#spawning-external-processes" title="Permalink to this headline">¶</a></h4>
<p>There are various mechanisms to spawn external processes from a script:</p>
<ul>
<li><p class="first">Use the functionalities provided by the <a class="reference internal" href="GPS.html#GPS.Process" title="GPS.Process"><code class="xref py py-class docutils literal"><span class="pre">GPS.Process</span></code></a> class.</p>
</li>
<li><p class="first">Execute a GPS action through <a class="reference internal" href="GPS.html#GPS.execute_action" title="GPS.execute_action"><code class="xref py py-func docutils literal"><span class="pre">GPS.execute_action()</span></code></a>.</p>
<p>The action should have an <code class="file docutils literal"><span class="pre">&lt;external&gt;</span></code> XML node indicating how to
launch the process.</p>
</li>
<li><p class="first">Create a pipe and execute the process with <code class="xref py py-func docutils literal"><span class="pre">os.popen()</span></code> calls.</p>
<p>This solution does not provide a full interaction with the process.</p>
</li>
<li><p class="first">Use a standard <strong class="program">expect</strong> library in Python</p>
<p>The use of an <strong class="program">expect</strong> library may be a good solution. There are
various Python <strong class="program">expect</strong> libraries that already exist.</p>
<p>These libraries generally try to copy the parameters of the standard
<code class="xref py py-class docutils literal"><span class="pre">file</span></code> class. They may fail doing so, since GPS&#8217;s consoles do not
fully emulate all the primitive functions of that class (there is no file
descriptor, for example).</p>
<p>When possible, we recommend using one of the methods above instead.</p>
</li>
</ul>
</div>
<div class="section" id="redirecting-the-output-of-spawned-processes">
<span id="id52"></span><h4>15.8.7.3. Redirecting the output of spawned processes<a class="headerlink" href="#redirecting-the-output-of-spawned-processes" title="Permalink to this headline">¶</a></h4>
<p>In general, you can redirect the output of any Python script to any GPS
window (either an already existing one or one GPS creates automatically)
using the <code class="file docutils literal"><span class="pre">output</span></code> attribute of XML configuration files.</p>
<p>However, there is a limitation in Python that the output of processes
spawned through <code class="xref py py-func docutils literal"><span class="pre">os.exec()</span></code> or <code class="xref py py-func docutils literal"><span class="pre">os.spawn()</span></code> is redirected to the
standard output instead of the usual Python output that GPS has overridden.</p>
<p>There are two solutions for this:</p>
<ul>
<li><p class="first">Execute the external process in through a pipe</p>
<p>The output of the pipe is then redirected to Python&#8217;s output, as in:</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span>import os, sys
def my_external<span class="o">()</span>:
   <span class="nv">f</span> <span class="o">=</span> os.popen <span class="o">(</span><span class="s1">&#39;ls&#39;</span><span class="o">)</span>
   <span class="nv">console</span> <span class="o">=</span> GPS.Console <span class="o">(</span><span class="s2">&quot;ls&quot;</span><span class="o">)</span>
   <span class="k">for</span> l in f.readlines<span class="o">()</span>:
      console.write <span class="o">(</span><span class="s1">&#39;   &#39;</span> + l<span class="o">)</span>
</pre></div>
</div>
<p>This solution allows you, at the same time, to modify the output, for
example to indent it as in the example above.</p>
</li>
<li><p class="first">Execute the process through GPS</p>
<p>You can go through the process of defining an XML customization string for
GPS and execute your process that way, like:</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span>GPS.parse_xml <span class="o">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">   &lt;action name=&quot;</span>ls<span class="s2">&quot;&gt;</span>
<span class="s2">     &lt;external output=&quot;</span>output of ls<span class="s2">&quot;&gt;ls&lt;/external&gt;</span>
<span class="s2">   &lt;/action&gt;&quot;&quot;&quot;</span><span class="o">)</span>

def my_external<span class="o">()</span>:
   GPS.execute_action <span class="o">(</span><span class="s2">&quot;ls&quot;</span><span class="o">)</span>
</pre></div>
</div>
<p>This solution also allows you to send the output to a different window
than the rest of your script. But you cannot filter or modify the output
as you can using the first solution.</p>
</li>
</ul>
</div>
<div class="section" id="contextual-menus-on-object-directories-only">
<span id="id53"></span><h4>15.8.7.4. Contextual menus on object directories only<a class="headerlink" href="#contextual-menus-on-object-directories-only" title="Permalink to this headline">¶</a></h4>
<p>The following filter can be used for actions that can only execute in the
<span class="guilabel">Project</span> view and only when the user clicks on an object
directory. The contextual menu entry is not visible in other contexts:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;root&gt;</span>
   <span class="nt">&lt;filter</span> <span class="na">name=</span><span class="s">&quot;object directory&quot;</span>
           <span class="na">shell_cmd=</span><span class="s">&quot;import os.path; os.path.samefile (GPS.current_context().project().object_dirs()[0],GPS.current_context().directory())&quot;</span>
           <span class="na">shell_lang=</span><span class="s">&quot;python&quot;</span>
           <span class="na">module=</span><span class="s">&quot;Explorer&quot;</span> <span class="nt">/&gt;</span>

   <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&quot;Test on object directory&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;filter</span> <span class="na">id=</span><span class="s">&quot;object directory&quot;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;shell&gt;</span>echo &quot;Success&quot;<span class="nt">&lt;/shell&gt;</span>
   <span class="nt">&lt;/action&gt;</span>

   <span class="nt">&lt;contextual</span> <span class="na">action=</span><span class="s">&quot;Test on object directory&quot;</span> <span class="nt">&gt;</span>
      <span class="nt">&lt;Title&gt;</span>Test on object directory<span class="nt">&lt;/Title&gt;</span>
   <span class="nt">&lt;/contextual&gt;</span>
<span class="nt">&lt;/root&gt;</span>
</pre></div>
</div>
<p>Another example is a filter so that the contextual menu only appears when
on a project node in the <span class="guilabel">Project</span> view. Using <strong class="command">%P</strong> in
your command is not enough since the current context when you click on a
file or directory also contains information about the project the file or
directory belongs to.  Thus this implicit filter is not sufficient to hide
your contextual menu.</p>
<p>As a result, you need to do a slightly more complex test, where you check
that the current context does not contains information on directories (which
will disable the contextual menu for directories, files and
entities). Since the command uses <strong class="command">%P</strong>, GPS guarantees that a
project is available.</p>
<p>We will implement this contextual menu in a Python file, called
<code class="file docutils literal"><span class="pre">filters.py</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">GPS</span>
<span class="k">def</span> <span class="nf">on_project</span><span class="p">():</span>
   <span class="k">try</span><span class="p">:</span>
      <span class="n">GPS</span><span class="o">.</span><span class="n">current_context</span><span class="p">()</span><span class="o">.</span><span class="n">directory</span><span class="p">()</span>
      <span class="k">return</span> <span class="bp">False</span>
   <span class="k">except</span><span class="p">:</span>
      <span class="k">return</span> <span class="bp">True</span>

<span class="n">GPS</span><span class="o">.</span><span class="n">parse_xml</span> <span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">&lt;action name=&quot;test_filter&quot;&gt;</span>
<span class="s2">&lt;filter module=&quot;Explorer&quot;</span>
<span class="s2">     shell_lang=&quot;python&quot;</span>
<span class="s2">     shell_cmd=&quot;filters.on_project()&quot; /&gt;</span>
<span class="s2">&lt;shell&gt;echo current project is %P&lt;/shell&gt;</span>
<span class="s2">&lt;/action&gt;</span>
<span class="s2">&lt;contextual action=&quot;test_filter&quot;&gt;</span>
<span class="s2">&lt;title&gt;Print current project&lt;/title&gt;</span>
<span class="s2">&lt;/contextual&gt;&quot;&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The example above shows the flexibility of filters since you can pretty
much do anything you wish through the shell commands. However, it is complex
to write the above for such a simple filter. GPS provides a predefined
filter for just that purpose, so you can write instead, in an XML file:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&quot;test_filter&quot;</span> <span class="nt">&gt;</span>
<span class="nt">&lt;filter</span> <span class="na">id=</span><span class="s">&quot;Explorer_Project_Node&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;shell&gt;</span>echo current project is %P<span class="nt">&lt;/shell&gt;</span>
<span class="nt">&lt;/action&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="redirecting-the-output-to-specific-windows">
<span id="id54"></span><h4>15.8.7.5. Redirecting the output to specific windows<a class="headerlink" href="#redirecting-the-output-to-specific-windows" title="Permalink to this headline">¶</a></h4>
<p>By default, GPS displays the output of all Python commands in the Python
console. However, you might, in some cases, want to create other windows in
GPS for this output. This can be done in one of two ways:</p>
<ul>
<li><p class="first">Define a new action</p>
<p>If the entire output of your script should be redirected to the same
window or if the script is used interactively through a menu or a key
binding, the easiest way is to create a new XML action and redirect its
output, as in:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;root&gt;</span>
  <span class="nt">&lt;action</span> <span class="na">name=</span><span class="s">&quot;redirect output&quot;</span> <span class="na">output=</span><span class="s">&quot;New Window&quot;</span><span class="nt">&gt;</span>
     <span class="nt">&lt;shell</span> <span class="na">lang=</span><span class="s">&quot;python&quot;</span><span class="nt">&gt;</span>print &quot;a&quot;<span class="nt">&lt;/shell&gt;</span>
  <span class="nt">&lt;/action&gt;</span>
<span class="nt">&lt;/root&gt;</span>
</pre></div>
</div>
<p>All the shell commands in your action can be output in a different window
and this also applies for the output of external commands.</p>
</li>
<li><p class="first">Explicit redirection</p>
<p>If, however, you want to control within your script where the output
should be sent (for example if you cannot know that statically when you
write your commands), you can use the following code:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">sys</span><span class="o">.</span><span class="n">stdin</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span> <span class="o">=</span> <span class="n">GPS</span><span class="o">.</span><span class="n">Console</span> <span class="p">(</span><span class="s2">&quot;New window&quot;</span><span class="p">)</span>
<span class="k">print</span> <span class="s2">&quot;foo&quot;</span>
<span class="k">print</span> <span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdin</span><span class="o">.</span><span class="n">read</span> <span class="p">())</span>
<span class="n">sys</span><span class="o">.</span><span class="n">stdin</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span> <span class="o">=</span> <span class="n">GPS</span><span class="o">.</span><span class="n">Console</span> <span class="p">(</span><span class="s2">&quot;Python&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The first line redirects all input and output to a new window, which is
created if it does not yet exist. Note however that the output of
<code class="xref py py-func docutils literal"><span class="pre">stderr()</span></code> is not redirected: you need to explicitly do it for
<code class="xref py py-func docutils literal"><span class="pre">sys.stderr()</span></code>.</p>
<p>The last line restore the default Python console. You must do this at the
end of your script or all scripts will continue to use the new console.</p>
<p>You can alternatively create separate objects for the output and use them
explicitly:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">my_out</span>  <span class="o">=</span> <span class="n">GPS</span><span class="o">.</span><span class="n">Console</span> <span class="p">(</span><span class="s2">&quot;New Window&quot;</span><span class="p">)</span>
<span class="n">my_out2</span> <span class="o">=</span> <span class="n">GPS</span><span class="o">.</span><span class="n">Console</span> <span class="p">(</span><span class="s2">&quot;New Window2&quot;</span><span class="p">)</span>

<span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">=</span><span class="n">my_out</span>
<span class="k">print</span> <span class="s2">&quot;a&quot;</span>
<span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">=</span><span class="n">my_out2</span>
<span class="k">print</span> <span class="s2">&quot;b&quot;</span>
<span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">=</span><span class="n">GPS</span><span class="o">.</span><span class="n">Console</span> <span class="p">(</span><span class="s2">&quot;Python&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The parameter to the constructor <a class="reference internal" href="GPS.html#GPS.Console" title="GPS.Console"><code class="xref py py-func docutils literal"><span class="pre">GPS.Console()</span></code></a> indicates whether
any output sent to that console should be saved by GPS and reused for the
<strong class="command">%N</strong> parameters if the command is executed in a GPS action. It
should normally be 1, except for <code class="xref py py-func docutils literal"><span class="pre">stderr()</span></code> when it should be 0.</p>
</li>
</ul>
</div>
<div class="section" id="reloading-a-python-file-in-gps">
<span id="id55"></span><h4>15.8.7.6. Reloading a Python file in GPS<a class="headerlink" href="#reloading-a-python-file-in-gps" title="Permalink to this headline">¶</a></h4>
<p>After you have made modification to a Python file, you may want to reload
it. This requires careful use of Python commands.  Let&#8217;s assume you have a
Python file (<code class="file docutils literal"><span class="pre">&quot;mymod.py&quot;</span></code>) containing the following:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">GPS</span><span class="o">.</span><span class="n">parse_xml</span> <span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">   &lt;action name=&quot;my_action&quot;&gt;</span>
<span class="s2">      &lt;shell lang=&quot;python&quot;&gt;mymod.myfunc()&lt;/shell&gt;</span>
<span class="s2">   &lt;/action&gt;&quot;&quot;&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">myfunc</span><span class="p">():</span>
   <span class="k">print</span> <span class="s2">&quot;In myfunc</span><span class="se">\\</span><span class="s2">n&quot;</span>
</pre></div>
</div>
<p>This file defines an action <code class="file docutils literal"><span class="pre">my_action</span></code>, that you can, for example,
associate with a key binding through the
<span class="menuselection">Edit ‣ Preferences...</span> menu.</p>
<p>If you copy this file into one of the <code class="file docutils literal"><span class="pre">plugins</span></code> directories, GPS
automatically loads it at startup.  The function <code class="xref py py-func docutils literal"><span class="pre">myfunc()</span></code> is in a
separate namespace, with the name <code class="file docutils literal"><span class="pre">mymod</span></code>, like the file.  If you
decide, during your GPS session, to edit this file, for example to have the
function print &#8220;In myfunc2&#8221; instead, you then to reload the file by typing
the following command in the Python console:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="nb">execfile</span> <span class="p">(</span><span class="s2">&quot;HOME/.gps/plug-ins/mymod.py&quot;</span><span class="p">,</span> <span class="n">mymod</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span>
</pre></div>
</div>
<p>The first parameter is the full path to the file that you want to reload.
The second argument is less obvious, but indicates the file should be
reloaded in the namespace <code class="file docutils literal"><span class="pre">mymod</span></code>.</p>
<p>If you omit the optional second parameter, Python loads the file, but the
function <code class="xref py py-func docutils literal"><span class="pre">myfunc()</span></code> is defined in the global namespace, so the new
definition is accessible through:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">myfunc</span><span class="p">()</span>
</pre></div>
</div>
<p>Therefore, the key shortcut you previously set, which still execute
<code class="xref py py-func docutils literal"><span class="pre">mymod.myfunc()</span></code>, will keep executing the old definition.</p>
<p>GPS provides a contextual menu, <span class="menuselection">Python ‣ Reload module</span>
when you are editing a Python file to deal with all the above details.</p>
</div>
<div class="section" id="printing-the-gps-python-documentation">
<span id="id56"></span><h4>15.8.7.7. Printing the GPS Python documentation<a class="headerlink" href="#printing-the-gps-python-documentation" title="Permalink to this headline">¶</a></h4>
<p>The Python extension provided by GPS is fully documented in this manual
and in a separate manual accessible through the <span class="guilabel">Help</span> menu in
GPS.  However, this documentation is provided in HTML, and might not be the
best format suitable for printing.  To generate your own documentation for
any Python module, including GPS, and print the result:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pydoc</span>
<span class="n">pydoc</span><span class="o">.</span><span class="n">writedoc</span> <span class="p">(</span><span class="n">GPS</span><span class="p">)</span>
</pre></div>
</div>
<p>In the last command, &#8220;GPS&#8221; is the name of the module whose documentation
you want to print.</p>
<p>These commands generate a <code class="file docutils literal"><span class="pre">.html</span></code> file in the current directory.</p>
<p>Alternatively, you can generate a simple text file with:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">e</span><span class="o">=</span><span class="nb">file</span><span class="p">(</span><span class="s2">&quot;./python_doc&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
<span class="n">e</span><span class="o">.</span><span class="n">write</span> <span class="p">(</span><span class="n">pydoc</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">document</span> <span class="p">(</span><span class="n">GPS</span><span class="p">))</span>
<span class="n">e</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</pre></div>
</div>
<p>This text file includes bold characters by default. Such bold characters
are correctly interpreted by tools such as <strong class="program">a2ps</strong> which you can
can use to convert the text file into a Postscript document.</p>
</div>
<div class="section" id="automatically-loading-python-files-at-startup">
<span id="id57"></span><h4>15.8.7.8. Automatically loading python files at startup<a class="headerlink" href="#automatically-loading-python-files-at-startup" title="Permalink to this headline">¶</a></h4>
<p>At startup, GPS automatically loads all Python files found in the
<code class="file docutils literal"><span class="pre">share/gps/plugins</span></code> and <code class="file docutils literal"><span class="pre">$HOME/.gps/plug-ins</span></code> directories.  In
addition, Python files located under <code class="file docutils literal"><span class="pre">&lt;prefix&gt;/share/gps/python</span></code> can
be imported (using the <cite>import</cite> command) by any Python script.  You can
also set the <code class="file docutils literal"><span class="pre">PYTHONPATH</span></code> environment variable to add other
directories to the Python search path.</p>
</div>
<div class="section" id="hiding-contextual-menus">
<span id="id58"></span><h4>15.8.7.9. Hiding contextual menus<a class="headerlink" href="#hiding-contextual-menus" title="Permalink to this headline">¶</a></h4>
<p id="index-117">GPS provides access to most of its functionality through contextual menus,
accessed by right clicking in various parts of GPS. Due to the number of
tools provided by GPS, these contextual menus can be large and you might
want to control what is displayed in them. There are several ways to do that:</p>
<ul>
<li><p class="first">Define appropriate filters for your actions.</p>
<p>If you are creating your own contextual menus through customization files
and XML, they are are usually associated with actions (<a class="reference internal" href="#defining-actions"><span class="std std-ref">&lt;action&gt;</span></a>) you have created. In that case, you need to define
filters appropriately, through the <a class="reference internal" href="#filtering-actions"><span class="std std-ref">&lt;filter&gt;</span></a>
tag to decide when the action is relevant and hence when the contextual
menu is displayed.</p>
</li>
<li><p class="first">Use shell commands to hide the menus</p>
<p>If you want to control the visibility of predefined contextual menus or
for menus where you cannot easily modify the associated filter, you can
use shell and Python commands to hide the menu entry.  To do this, you
need to find the name of the menu, which can be done by consulting the
list returned by <a class="reference internal" href="GPS.html#GPS.Contextual.list" title="GPS.Contextual.list"><code class="xref py py-func docutils literal"><span class="pre">GPS.Contextual.list()</span></code></a>. This name is also the
value of the <code class="file docutils literal"><span class="pre">&lt;title&gt;</span></code> tag for contextual menus you have
created. Using this name, you can disable the contextual menu by
executing:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">GPS</span><span class="o">.</span><span class="n">Contextual</span> <span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">hide</span><span class="p">()</span>
</pre></div>
</div>
<p>in the Python console.</p>
</li>
</ul>
</div>
<div class="section" id="creating-custom-graphical-interfaces">
<span id="id59"></span><h4>15.8.7.10. Creating custom graphical interfaces<a class="headerlink" href="#creating-custom-graphical-interfaces" title="Permalink to this headline">¶</a></h4>
<p id="index-118">GPS is based on the Gtk+ graphical toolkit, which is available under many
platforms and for many programming languages.</p>
<p>In particular, GPS comes with pygobject, a Python binding to Gtk+.  Using
pygobject, you can create your own dialogs and graphical windows using the
Python capabilities provided by GPS.</p>
<p>See the <span class="menuselection">Help ‣ GPS ‣ Python Extensions</span> menu, specifically
the documentation for <a class="reference internal" href="GPS.html#GPS.MDI" title="GPS.MDI"><code class="xref py py-class docutils literal"><span class="pre">GPS.MDI</span></code></a>, for a sample of code on how to create
your own graphical interfaces and integrate them with GPS.</p>
</div>
</div>
<div class="section" id="hooks">
<span id="id60"></span><h3>15.8.8. Hooks<a class="headerlink" href="#hooks" title="Permalink to this headline">¶</a></h3>
<p id="index-119">A <strong>hook</strong> is a named set of commands to be executed on particular
occasions as a result of user actions in GPS.</p>
<p>GPS and its various modules define a number of standard hooks, called, for
example, when a new project is loaded, or when a file is edited.  You can
define your own commands to be executed in such cases.</p>
<span class="target" id="index-120"></span><p id="index-121">You can find the list of hooks that GPS currently supports by calling the
<code class="xref py py-func docutils literal"><span class="pre">Hook.list()</span></code> function, which takes no argument and returns a list of
the names of all hooks.  You can get more advanced description for each
hook using the <span class="menuselection">Help ‣ GPS ‣ Python Extensions</span> menu:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">GPS</span><span class="o">&gt;</span> <span class="n">Hook</span><span class="o">.</span><span class="n">list</span>
<span class="n">project_changed</span>
<span class="n">open_file_action_hook</span>
<span class="n">preferences_changed</span>
<span class="p">[</span><span class="o">...</span><span class="p">]</span>

<span class="n">Python</span><span class="o">&gt;</span> <span class="n">GPS</span><span class="o">.</span><span class="n">Hook</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
</pre></div>
</div>
<p id="index-122">The description of each hook includes a pointer to the type of the hook,
which is what parameters the subprograms in this hook receive.</p>
<p id="index-123">You can find the list of all known hook types can be found using the
<code class="xref py py-func docutils literal"><span class="pre">Hook.list_types()</span></code> function, which takes no argument and returns a
list of all known types of hooks.  You can find more information for
each of these type by calling <code class="xref py py-func docutils literal"><span class="pre">Hook.describe_type()</span></code>.</p>
<div class="section" id="adding-commands-to-hooks">
<h4>15.8.8.1. Adding commands to hooks<a class="headerlink" href="#adding-commands-to-hooks" title="Permalink to this headline">¶</a></h4>
<p>Add your own command to existing hooks by calling the <code class="xref py py-func docutils literal"><span class="pre">Hook.add()</span></code>
function. Whenever the hook is executed by GPS or another script, your
command is also executed and is passed the parameters that were specified
when the hook is run. The first parameter is always the name of the hook
being executed.</p>
<p>This function applies to an instance of the hook class and takes one
parameter, the command to be executed. This is a subprogram parameter
(see <a class="reference internal" href="#subprogram-parameters"><span class="std std-ref">Subprogram parameters</span></a>).</p>
<ul>
<li><p class="first">GPS shell</p>
<p>The command can be any GPS action (see <a class="reference internal" href="#defining-actions"><span class="std std-ref">Defining Actions</span></a>). The
arguments for the hook will be passed to the action, and are available as
<strong class="command">%N</strong>. In the following example, the message &#8220;Just executed the
hook: project_changed&#8221; is printed in the <span class="guilabel">Shell</span> console.
We are defining the action to be executed inline, but it could be defined
in a separate XML customization file:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">GPS</span><span class="o">&gt;</span> <span class="n">parse_xml</span> <span class="s2">&quot;&quot;&quot;&lt;action name=&quot;my_action&quot;&gt;&lt;shell&gt;echo &quot;Just executed the hook&quot;&lt;/shell&gt;&lt;/action_name&gt;&quot;&quot;&quot;</span>
<span class="n">GPS</span><span class="o">&gt;</span> <span class="n">Hook</span> <span class="n">project_changed</span>
<span class="n">GPS</span><span class="o">&gt;</span> <span class="n">Hook</span><span class="o">.</span><span class="n">add</span> <span class="o">%</span><span class="mi">1</span> <span class="s2">&quot;my_action&quot;</span>
</pre></div>
</div>
</li>
<li><p class="first">Python</p>
<p>The command must be a subprogram to execute. The arguments for the hook
are passed to this subprogram. In the following example, the message &#8220;The
hook project_changed was executed by GPS&#8221; is displayed in the Python
console whenever the project changes:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">my_callback</span> <span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="k">print</span> <span class="s2">&quot;The hook &quot;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; was executed by GPS&quot;</span>
<span class="n">GPS</span><span class="o">.</span><span class="n">Hook</span> <span class="p">(</span><span class="s2">&quot;project_changed&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">add</span> <span class="p">(</span><span class="n">my_callback</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
<p>The example above illustrates the simplest type of hook, which does not have
any arguments. However, most hooks receive several parameters. For example,
the <code class="xref py py-func docutils literal"><span class="pre">file_edited()</span></code> hook receives the file name as a parameter.</p>
<ul>
<li><p class="first">GPS shell</p>
<p>The following code prints the name of the hook (&#8220;file_edited&#8221;) and the
name of the file in the shell console each time a file is opened in GPS:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">GPS</span><span class="o">&gt;</span> <span class="n">parse_xml</span> <span class="s2">&quot;&quot;&quot;&lt;action name=&quot;my_action&quot;&gt;&lt;shell&gt;echo name=$1 file=$2&lt;/shell&gt;&lt;/action&gt;&quot;&quot;&quot;</span>
<span class="n">GPS</span><span class="o">&gt;</span> <span class="n">Hook</span> <span class="s2">&quot;file_edited&quot;</span>
<span class="n">GPS</span><span class="o">&gt;</span> <span class="n">Hook</span><span class="o">.</span><span class="n">add</span> <span class="o">%</span><span class="mi">1</span> <span class="s2">&quot;my_action&quot;</span>
</pre></div>
</div>
</li>
<li><p class="first">Python</p>
<p>The following code prints the name of the file being edited by GPS in the
Python console whenever a new file is opened. The second argument is of
type <a class="reference internal" href="GPS.html#GPS.File" title="GPS.File"><code class="xref py py-class docutils literal"><span class="pre">GPS.File</span></code></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">my_file_callback</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">file</span><span class="p">):</span>
    <span class="k">print</span> <span class="s2">&quot;Editing &quot;</span> <span class="o">+</span> <span class="nb">file</span><span class="o">.</span><span class="n">name</span><span class="p">()</span>
<span class="n">GPS</span><span class="o">.</span><span class="n">Hook</span> <span class="p">(</span><span class="s2">&quot;file_edited&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">add</span> <span class="p">(</span><span class="n">my_file_callback</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="action-hooks">
<h4>15.8.8.2. Action hooks<a class="headerlink" href="#action-hooks" title="Permalink to this headline">¶</a></h4>
<span class="target" id="index-124"></span><p id="index-125">Hooks whose name ends with <strong class="command">_action_hook</strong> are handled specially by
GPS.  As opposed to the standard hooks described in the previous section,
the execution of the action hooks stops if one of the subprograms returns a
True value (<strong class="command">1</strong> or <strong class="command">true</strong>). The subprograms associated
with that hook are executed sequentially. If any such subprogram knows how
to do the action for that hook, it should do so and return &#8220;1&#8221;.</p>
<p>Other action hooks expect a string as a return value instead of a
boolean. Execution stops when a subprogram returns a non-empty string.</p>
<p>This mechanism is used extensively by GPS internally. For example, whenever
a file needs to be opened in an editor, GPS executes the
<code class="xref py py-func docutils literal"><span class="pre">open_file_action_hook()</span></code>. Several modules are connected to that hook.</p>
<p>One of the first modules to be executed is the external editor module. If
the user has chosen to use an external editor, this module spawn the editor
and returns 1. This immediately stops the execution of the
<code class="xref py py-func docutils literal"><span class="pre">open_file_action_hook()</span></code>.</p>
<p>However, if user is not using an external editor, this module returns 0,
which keep executing the hook, and in particular executes the source editor
module, which always takes an actions and open an editor internally in GPS.</p>
<p>This is a very flexible mechanism. In your own script, you could choose to
have some special handling for files with a <code class="file docutils literal"><span class="pre">.foo</span></code> extension, for
example. If the user wants to open such a file, you could, for example,
spawn an external command (say, <strong class="program">my_editor</strong>) to edit this file,
instead of opening it in GPS.</p>
<p>You can do this with code similar to the following:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">os.path</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="k">def</span> <span class="nf">my_foo_handler</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">file</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span>
                   <span class="n">column_end</span><span class="p">,</span> <span class="n">enable_nav</span><span class="p">,</span> <span class="n">new_file</span><span class="p">,</span> <span class="nb">reload</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">splitext</span><span class="p">(</span><span class="nb">file</span><span class="o">.</span><span class="n">name</span><span class="p">())[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;.foo&quot;</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">spawnv</span><span class="p">(</span>
           <span class="n">os</span><span class="o">.</span><span class="n">P_NOWAIT</span><span class="p">,</span> <span class="s2">&quot;/usr/bin/emacs&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;emacs&quot;</span><span class="p">,</span> <span class="nb">file</span><span class="o">.</span><span class="n">name</span><span class="p">()))</span>
        <span class="k">return</span> <span class="mi">1</span>   <span class="c1">## Prevent further execution of the hook</span>
    <span class="k">return</span> <span class="mi">0</span>  <span class="c1">## Let other subprograms in the hook do their job</span>

<span class="n">GPS</span><span class="o">.</span><span class="n">Hook</span><span class="p">(</span><span class="s2">&quot;open_file_action_hook&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">my_foo_handler</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="running-hooks">
<h4>15.8.8.3. Running hooks<a class="headerlink" href="#running-hooks" title="Permalink to this headline">¶</a></h4>
<p id="index-126">Each module in GPS is responsible for running hooks when appropriate.  Most
of the time the subprograms exported by GPS to the scripting languages
properly run the hook. But you might also need to run them in your own
scripts.</p>
<p>As usual, this results in the execution of all the functions bound to that
hook, whether they are defined in Ada or in any of the scripting languages.</p>
<p>This is done by the <code class="xref py py-func docutils literal"><span class="pre">Hook.run()</span></code> function. It applies to an instance of
the <code class="xref py py-class docutils literal"><span class="pre">Hook</span></code> class and has a variable number of arguments, which must
be in the right order and of the right type for that specific type of hook.
If you are running an action hook, the execution stops as usual as soon as
one of the subprograms return a <strong class="command">True</strong> value.</p>
<p>The following example shows how to run a simple hook with no parameter and
a more complex hook with several parameters. The latter requests the
opening of an editor for the file in GPS and has an immediately visible
effect on the interface. The file is opened at line 100. See the
description of the hook for more information on the other parameters:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">GPS</span><span class="o">.</span><span class="n">Hook</span> <span class="p">(</span><span class="s2">&quot;project_changed&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">GPS</span><span class="o">.</span><span class="n">Hook</span> <span class="p">(</span><span class="s2">&quot;open_file_action_hook&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
   <span class="n">GPS</span><span class="o">.</span><span class="n">File</span> <span class="p">(</span><span class="s2">&quot;test.adb&quot;</span><span class="p">),</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="creating-new-hooks">
<h4>15.8.8.4. Creating new hooks<a class="headerlink" href="#creating-new-hooks" title="Permalink to this headline">¶</a></h4>
<span class="target" id="index-127"></span><p id="index-128">The list of hooks known to GPS is fully dynamic. GPS itself declares a
number of hooks, mostly for its internal use, though you can also connect
to them. But you can also create your own hooks to report events happening
in your own modules and programs. In this way, any other script or GPS
module can react to these events.</p>
<p>Such hooks can either be of a type exported by GPS, which constraints the
list of parameters for the callbacks, but make such hooks more portable and
secure, or they can be of a general type, which allows almost any kind of
parameters. In the latter case, GPS checks at runtime to ensure that the
subprogram called as a result of running the hook has the right number of
parameters. If this is not the case, GPS complains and displays error
messages. Such general hooks do not pass their parameters to other scripting
languages.</p>
<p>You create a new hook by calling <code class="xref py py-func docutils literal"><span class="pre">Hook.register()</span></code>. This function takes
two arguments: the name of the hook you are creating and , optionally,
the type of the hook.
The name of the hook is left to you. Any character is allowed in that name,
although using only alphanumerical characters is recommended.</p>
<p>When the hook type is omitted, it indicates that the hook is of the general
type that allows any number of parameter, of any type.
Other scripts are able to connect to it but will not be executed when the hook
is run if they do not expect the same number of parameters passed to
<code class="xref py py-func docutils literal"><span class="pre">Hook.run()</span></code>. Other scripts in other languages only receive the hook name
as a parameter, not the full list of parameters.</p>
<p>When specified, the type of the hook must be one of the values returned by
<code class="xref py py-func docutils literal"><span class="pre">Hook.list_types()</span></code>: it indicates that the hook is of one of the types
exported by GPS itself.
The advantage of using such explicit types instead of <strong class="command">general</strong>
is that GPS is able to do more testing of the validity of the
parameters. Such hooks can also be connected to from other scripting
languages.</p>
<p>A small trick worth noting: if the command bound to a hook does not have the
correct number of parameters that this hook provides, the command will not be
executed and GPS reports an error. You can make sure that your command is
always executed by either giving default values for its parameter or by
using Python&#8217;s syntax to indicate a variable number of arguments.</p>
<p>This is especially useful if you are connecting to a <strong class="command">general</strong>
hook, since you do not know in advance how many parameters the call of
<code class="xref py py-func docutils literal"><span class="pre">Hook.run()</span></code> provides:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1">## This callback can be connected to any type of hook</span>
<span class="k">def</span> <span class="nf">trace</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
   <span class="k">print</span> <span class="s2">&quot;hook=&quot;</span> <span class="o">+</span> <span class="n">name</span>

<span class="c1">## This callback can be connected to hooks with one or two parameters</span>
<span class="k">def</span> <span class="nf">trace2</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
   <span class="k">print</span> <span class="s2">&quot;hook=&quot;</span> <span class="o">+</span> <span class="nb">str</span> <span class="p">(</span><span class="n">arg1</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span> <span class="p">(</span><span class="n">arg2</span><span class="p">)</span>

<span class="n">Hook</span><span class="o">.</span><span class="n">register</span> <span class="p">(</span><span class="s2">&quot;my_custom_hook&quot;</span><span class="p">,</span> <span class="s2">&quot;general&quot;</span><span class="p">)</span>
<span class="n">Hook</span> <span class="p">(</span><span class="s2">&quot;my_custom_hook&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">add</span> <span class="p">(</span><span class="n">trace2</span><span class="p">)</span>
<span class="n">Hook</span> <span class="p">(</span><span class="s2">&quot;my_custom_hook&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">run</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="c1">## Prints 1 2</span>
<span class="n">Hook</span> <span class="p">(</span><span class="s2">&quot;my_custom_hook&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">run</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span>    <span class="c1">## Prints 1 100</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="the-server-mode">
<span id="id61"></span><h2>15.9. The Server Mode<a class="headerlink" href="#the-server-mode" title="Permalink to this headline">¶</a></h2>
<p id="index-129">To give access to the GPS capabilities from external processes
(e.g. <strong class="program">emacs</strong>), you can launch GPS in <strong>server mode</strong>.</p>
<p>The relevant command line switches are <strong class="command">--server</strong> and
<strong class="command">--hide</strong>.  <strong class="command">--server</strong> opens a socket on the specified
port, allowing multiple clients to connect to a running GPS and send GPS
shell or Python commands.  <strong class="command">--hide</strong> tells GPS not to display its
main window when starting.  On Unix systems, you still need to have access
to the current screen (as determined by the <code class="file docutils literal"><span class="pre">DISPLAY</span></code> environment
variable) in this mode.  Using both switches provides a way to launch GPS
as a background process with no initial user interface.</p>
<p>Clients connecting through a standard socket have access to a simple shell
using <cite>GPS&gt;&gt;</cite> as the prompt between each command. This is needed in order
to determine when the output (result) of a command is completed.  All GPS
shell commands (as defined in <a class="reference internal" href="#the-gps-shell"><span class="std std-ref">The GPS Shell</span></a>) are available from this
shell, but their use is discouraged, in favor of the use of Python commands.
Those are available through the use of the <strong class="command">python</strong> prefix before a
Python command.</p>
<p>For example, sending <strong class="command">pwd</strong> through the socket sends the
<strong class="command">pwd</strong> command through the GPS shell and sends the result to the
socket; similarly, sending <strong class="command">python GPS.pwd()</strong> will send the
<strong class="command">GPS.help()</strong> command through the python interpreter (see
<a class="reference internal" href="#the-python-interpreter"><span class="std std-ref">The Python Interpreter</span></a> for more details).</p>
<p>The socket shell provides also additional commands:</p>
<ul>
<li><p class="first"><strong class="command">logout</strong></p>
<p>Inform the GPS server that the connection should be closed.</p>
</li>
<li><p class="first"><strong class="command">id &lt;string&gt;</strong></p>
<p>Register the current session with a given string.  This string can then
be used within GPS itself (for example via a <code class="file docutils literal"><span class="pre">.xml</span></code> or Python
plugin) to display extra information to the client via the socket, using
the function <code class="xref py py-func docutils literal"><span class="pre">GPS.Socket().send()</span></code>.</p>
</li>
</ul>
<p>For example, suppose we start GPS with the <strong class="command">--server=1234</strong>
command: this brings up GPS as usual.  Now, on a separate terminal, create
a simple client by typing the following:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">telnet</span> <span class="n">localhost</span> <span class="mi">1234</span>
<span class="n">Trying</span> <span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="o">...</span>
<span class="n">Connected</span> <span class="n">to</span> <span class="n">localhost</span><span class="o">.</span>
<span class="n">Escape</span> <span class="n">character</span> <span class="ow">is</span> <span class="s1">&#39;^]&#39;</span><span class="o">.</span>
<span class="n">GPS</span><span class="o">&gt;&gt;</span> <span class="nb">id</span> <span class="n">test</span><span class="o">-</span><span class="mi">1</span>
<span class="nb">id</span> <span class="nb">set</span> <span class="n">to</span> <span class="s1">&#39;test-1&#39;</span>
<span class="n">GPS</span><span class="o">&gt;&gt;</span> <span class="n">pwd</span>
<span class="n">c</span><span class="p">:</span>\\<span class="n">working</span><span class="o">-</span><span class="nb">dir</span>\\
<span class="n">GPS</span><span class="o">&gt;&gt;</span>
</pre></div>
</div>
<p>Then in the GPS Python Console:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">GPS</span><span class="o">.</span><span class="n">Socket</span> <span class="p">(</span><span class="s2">&quot;test-1&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">send</span> <span class="p">(</span><span class="s2">&quot;hello, it is time to logout</span><span class="se">\\</span><span class="s2">n&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>At this point, the following is received on the client (telnet) side:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">GPS</span><span class="o">&gt;&gt;</span> <span class="n">hello</span><span class="p">,</span> <span class="n">it</span> <span class="ow">is</span> <span class="n">time</span> <span class="n">to</span> <span class="n">logout</span>
</pre></div>
</div>
<p>We can then close the client:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">logout</span>
<span class="n">Connection</span> <span class="n">closed</span> <span class="n">by</span> <span class="n">foreign</span> <span class="n">host</span><span class="o">.</span>
</pre></div>
</div>
</div>
<div class="section" id="adding-project-templates">
<span id="id62"></span><h2>15.10. Adding project templates<a class="headerlink" href="#adding-project-templates" title="Permalink to this headline">¶</a></h2>
<p id="index-130">The <span class="guilabel">Project</span> template wizard lists a selection of templates.
GPS locates the default set in the <code class="file docutils literal"><span class="pre">share/gps/templates</span></code> directory of
your GPS installation.</p>
<p>You can register new directories in which GPS looks for templates by using
the Python function <code class="xref py py-func docutils literal"><span class="pre">GPS.ProjectTemplate.add_templates_{dir}()</span></code>.</p>
<p>To create a new project template, first create a subdirectory in the
<code class="file docutils literal"><span class="pre">share/gps/templates/</span></code> directory or in one of the directories you have
registered with <code class="xref py py-func docutils literal"><span class="pre">GPS.ProjectTemplate.add()</span></code>. Then, in this directory,
create one template description file, which is a text file with the
<code class="file docutils literal"><span class="pre">.gpt</span></code> extension and the following syntax:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">Name</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span>
<span class="n">Category</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">category</span><span class="o">&gt;</span>
<span class="n">Project</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">project</span> <span class="nb">file</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">optional_hook_line</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="n">variable_1</span><span class="o">&gt;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">variable_1_default_value</span><span class="o">&gt;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">variable_1_description</span><span class="o">&gt;</span><span class="p">[:</span><span class="o">&lt;</span><span class="n">optional_variable_1_choices</span><span class="o">&gt;</span><span class="p">]</span>
<span class="o">&lt;</span><span class="n">variable_2</span><span class="o">&gt;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">variable_2_default_value</span><span class="o">&gt;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">variable_3_description</span><span class="o">&gt;</span><span class="p">[:</span><span class="o">&lt;</span><span class="n">optional_variable_3_choices</span><span class="o">&gt;</span><span class="p">]</span>
<span class="o">&lt;</span><span class="n">etc</span><span class="o">&gt;</span>

<span class="p">[</span><span class="n">Description</span><span class="p">]</span>
<span class="o">&lt;</span><span class="n">the</span> <span class="n">description</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Where the following are specified:</p>
<ul>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;name&gt;</span></code></p>
<p>Name of the template as it appears in the template tree in the
<span class="guilabel">Project</span> template wizard.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;category&gt;</span></code></p>
<p>Category in which the template is inserted in the template tree. There
can be multiple levels of categories, separated with <code class="kbd docutils literal"><span class="pre">/</span></code>.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;variable_1&gt;</span></code></p>
<p>Name substituted in the template files when deploying the template; see
below.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;variable_1_default_value&gt;</span></code></p>
<p>Default value for variable 1, which appears in the project template
wizard.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;variable_1_description&gt;</span></code></p>
<p>Description of variable 1.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;optional_variable_1_choices&gt;</span></code></p>
<p>An optional semicolon-separated list of possible choices for the given
variable. The different choices will then be displayed in a combo box.
Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="p">:</span><span class="n">my_var</span><span class="p">:</span><span class="n">choice_1</span><span class="p">:</span> <span class="n">A</span> <span class="n">simple</span> <span class="n">variable</span><span class="p">:</span><span class="n">choice_1</span><span class="p">;</span><span class="n">choice_2</span><span class="o">.</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;optional_hook_line&gt;</span></code></p>
<p>Optional line of the form <strong class="command">post_hook: &lt;python_file&gt;</strong> where
<code class="file docutils literal"><span class="pre">&lt;python_file&gt;</span></code> is the name of a Python file present in the same
directory as the template description file. This Python file is run by
GPS once, immediately after it deploys the project template.</p>
</li>
<li><p class="first"><code class="file docutils literal"><span class="pre">&lt;description&gt;</span></code></p>
<p>Short paragraph describing the project template. This paragraph is
displayed in the <span class="guilabel">Project</span> template wizard when the user
selects the template in the tree.</p>
</li>
</ul>
<p>When deploying templates, GPS copies all files and directories present in
the directory containing the template description file (except the Python
file indicated as <code class="xref py py-func docutils literal"><span class="pre">post_hook()</span></code> and the template description file
itself) into the destination directory chosen by the user.</p>
<p>As it deploys templates, GPS replaces strings of the form
<strong class="command">&lt;variable_name&gt;</strong> with the value of the variable.  If
<strong class="command">&lt;variable_name&gt;</strong> is all lower case, the substitution is converted
to lower-case. If <strong class="command">&lt;variable_name&gt;</strong> is in mixed case, the
substitution is converted into mixed case as well. If it is in upper case, the
substitution contains the original value specified by the user.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="environment.html" title="16. Environment"
             >next</a> |</li>
        <li class="right" >
          <a href="remote.html" title="14. Using GPS for Remote Development"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">GPS 19.1 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2001-2019, AdaCore.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.2.
    </div>
  </body>
</html>